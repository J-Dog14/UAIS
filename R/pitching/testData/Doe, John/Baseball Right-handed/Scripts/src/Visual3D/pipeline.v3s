! +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
!  Copyright notice
!  This PAF and its content is copyright of Qualisys AB © 2012-2022. All rights reserved. 
!  The PAF script is only to be used in conjunction with a Qualisys Motion Capture System. 
!  Only legal PAF owners are entitled to use the script and only in relation with related PAF.
! +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Set_View_Processing_Results
/VIEW_PROCESSING_RESULTS=1
/VIEW_BUILDMODEL_RESULTS=1
;

!================================================================
! Side letters - to adapt script to different throwing sides
!================================================================

Set_Pipeline_Parameter
/PARAMETER_NAME=THROW_SIDE_LETTER
/PARAMETER_VALUE=R
! /PARAMETER_VALUE_SEARCH_FOR=
! /PARAMETER_VALUE_REPLACE_WITH=
! /PARAMETER_VALUE_PREFIX=
! /PARAMETER_VALUE_APPEND=
;

Set_Pipeline_Parameter
/PARAMETER_NAME=THROW_SIDE_NAME
/PARAMETER_VALUE=RIGHT
! /PARAMETER_VALUE_SEARCH_FOR=
! /PARAMETER_VALUE_REPLACE_WITH=
! /PARAMETER_VALUE_PREFIX=
! /PARAMETER_VALUE_APPEND=
;

Set_Pipeline_Parameter
/PARAMETER_NAME=OPP_SIDE_NAME
/PARAMETER_VALUE=LEFT
! /PARAMETER_VALUE_SEARCH_FOR=
! /PARAMETER_VALUE_REPLACE_WITH=
! /PARAMETER_VALUE_PREFIX=
! /PARAMETER_VALUE_APPEND=
;

Set_Pipeline_Parameter
/PARAMETER_NAME=OPP_SIDE_LETTER
/PARAMETER_VALUE=L
! /PARAMETER_VALUE_SEARCH_FOR=
! /PARAMETER_VALUE_REPLACE_WITH=
! /PARAMETER_VALUE_PREFIX=
! /PARAMETER_VALUE_APPEND=
;

Set_Pipeline_Parameter
/PARAMETER_NAME=trail_side
/PARAMETER_VALUE=Right
! /PARAMETER_VALUE_SEARCH_FOR=
! /PARAMETER_VALUE_REPLACE_WITH=
! /PARAMETER_VALUE_PREFIX=
! /PARAMETER_VALUE_APPEND=
;

Set_Pipeline_Parameter
/PARAMETER_NAME=lead_side
/PARAMETER_VALUE=Left
! /PARAMETER_VALUE_SEARCH_FOR=
! /PARAMETER_VALUE_REPLACE_WITH=
! /PARAMETER_VALUE_PREFIX=
! /PARAMETER_VALUE_APPEND=
;

Set_Pipeline_Parameter
/PARAMETER_NAME=NEGATE_SHOULDER_X
!TRUE for RH, FALSE for LH
/PARAMETER_VALUE=TRUE
! /PARAMETER_VALUE_SEARCH_FOR=
! /PARAMETER_VALUE_REPLACE_WITH=
! /PARAMETER_VALUE_PREFIX=
! /PARAMETER_VALUE_APPEND=
;

Set_Pipeline_Parameter
/PARAMETER_NAME=NEGATE_Y
!FALSE for RH, TRUE for LH
/PARAMETER_VALUE=FALSE
! /PARAMETER_VALUE_SEARCH_FOR=
! /PARAMETER_VALUE_REPLACE_WITH=
! /PARAMETER_VALUE_PREFIX=
! /PARAMETER_VALUE_APPEND=
;

Set_Pipeline_Parameter
/PARAMETER_NAME=NEGATE_Z
!FALSE for RH, TRUE for LH
/PARAMETER_VALUE=FALSE
! /PARAMETER_VALUE_SEARCH_FOR=
! /PARAMETER_VALUE_REPLACE_WITH=
! /PARAMETER_VALUE_PREFIX=
! /PARAMETER_VALUE_APPEND=
;

Set_Pipeline_Parameter
/PARAMETER_NAME=NEGATE_GRF_X
!FALSE for RH, TRUE for LH
/PARAMETER_VALUE=FALSE
! /PARAMETER_VALUE_SEARCH_FOR=
! /PARAMETER_VALUE_REPLACE_WITH=
! /PARAMETER_VALUE_PREFIX=
! /PARAMETER_VALUE_APPEND=
; 
 

! +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
!  Copyright notice
!  This PAF and its content is copyright of Qualisys AB © 2012-2024. All rights reserved. 
!  The PAF script is only to be used in conjunction with a Qualisys Motion Capture System. 
!  Only legal PAF owners are entitled to use the script and only in relation with related PAF.
! +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION="C3D" <> "C3D"
! /AS_INTEGER=TRUE
;

	Pipeline_Breakpoint
	/PAUSE_MESSAGE=Incompatible model in c3d file. Please halt the script, change $export_type in settings.php to "C3D" and start processing again.
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

!================================================================
! Baseball Visual 3D script
!================================================================

File_New
;

! Load movement files
! ----------------------------------
				File_Open
				/FILE_NAME=H:\Pitching\Data\Doe, John\Baseball Right-handed\Fastball RH 2.c3d 
				;

				Assign_Tags_To_Files
				/MOTION_FILE_NAMES=*Fast*
				! /QUERY=
				/TAGS=FastBall
				;
	 
			Select_Active_File
			/FILE_NAME=::FILE_NAME
			! /QUERY=
			;

			Metric_Explicit
			/RESULT_METRIC_FOLDER=BALLSPEED
			/RESULT_METRIC_NAME=BALL_RELEASE_SPEED
			/METRIC_VALUE=0.000000000 !m/s
			;
			
			Metric_Explicit
			/RESULT_METRIC_FOLDER=BALLSPEED
			/RESULT_METRIC_NAME=SPIN_RATE
			/METRIC_VALUE=0.000000000 * 360 !Hz to deg/s
			;
			
			Metric_Explicit
			/RESULT_METRIC_FOLDER=BALLSPEED
			/RESULT_METRIC_NAME=SPIN_AXIS
			/METRIC_VALUE=0.000000000 * 57.2957795 !rads to degs
			;
					File_Open
				/FILE_NAME=H:\Pitching\Data\Doe, John\Baseball Right-handed\Fastball RH 3.c3d 
				;

				Assign_Tags_To_Files
				/MOTION_FILE_NAMES=*Fast*
				! /QUERY=
				/TAGS=FastBall
				;
	 
			Select_Active_File
			/FILE_NAME=::FILE_NAME
			! /QUERY=
			;

			Metric_Explicit
			/RESULT_METRIC_FOLDER=BALLSPEED
			/RESULT_METRIC_NAME=BALL_RELEASE_SPEED
			/METRIC_VALUE=0.000000000 !m/s
			;
			
			Metric_Explicit
			/RESULT_METRIC_FOLDER=BALLSPEED
			/RESULT_METRIC_NAME=SPIN_RATE
			/METRIC_VALUE=0.000000000 * 360 !Hz to deg/s
			;
			
			Metric_Explicit
			/RESULT_METRIC_FOLDER=BALLSPEED
			/RESULT_METRIC_NAME=SPIN_AXIS
			/METRIC_VALUE=0.000000000 * 57.2957795 !rads to degs
			;
					File_Open
				/FILE_NAME=H:\Pitching\Data\Doe, John\Baseball Right-handed\Fastball RH 4.c3d 
				;

				Assign_Tags_To_Files
				/MOTION_FILE_NAMES=*Fast*
				! /QUERY=
				/TAGS=FastBall
				;
	 
			Select_Active_File
			/FILE_NAME=::FILE_NAME
			! /QUERY=
			;

			Metric_Explicit
			/RESULT_METRIC_FOLDER=BALLSPEED
			/RESULT_METRIC_NAME=BALL_RELEASE_SPEED
			/METRIC_VALUE=0.000000000 !m/s
			;
			
			Metric_Explicit
			/RESULT_METRIC_FOLDER=BALLSPEED
			/RESULT_METRIC_NAME=SPIN_RATE
			/METRIC_VALUE=0.000000000 * 360 !Hz to deg/s
			;
			
			Metric_Explicit
			/RESULT_METRIC_FOLDER=BALLSPEED
			/RESULT_METRIC_NAME=SPIN_AXIS
			/METRIC_VALUE=0.000000000 * 57.2957795 !rads to degs
			;
					File_Open
				/FILE_NAME=H:\Pitching\Data\Doe, John\Baseball Right-handed\Fastball RH 5.c3d 
				;

				Assign_Tags_To_Files
				/MOTION_FILE_NAMES=*Fast*
				! /QUERY=
				/TAGS=FastBall
				;
	 
			Select_Active_File
			/FILE_NAME=::FILE_NAME
			! /QUERY=
			;

			Metric_Explicit
			/RESULT_METRIC_FOLDER=BALLSPEED
			/RESULT_METRIC_NAME=BALL_RELEASE_SPEED
			/METRIC_VALUE=0.000000000 !m/s
			;
			
			Metric_Explicit
			/RESULT_METRIC_FOLDER=BALLSPEED
			/RESULT_METRIC_NAME=SPIN_RATE
			/METRIC_VALUE=0.000000000 * 360 !Hz to deg/s
			;
			
			Metric_Explicit
			/RESULT_METRIC_FOLDER=BALLSPEED
			/RESULT_METRIC_NAME=SPIN_AXIS
			/METRIC_VALUE=0.000000000 * 57.2957795 !rads to degs
			;
				File_Open
			/FILE_NAME=H:\Pitching\Data\Doe, John\Baseball Right-handed\Functional hip RH 1.c3d 
			;
			
			Assign_Tags_To_Files
			/MOTION_FILE_NAMES=*Functional*
			! /QUERY=
			/TAGS=Functional
			;
			
			! To speed up the processing, functional trial is downsampled
			! Select_Active_File
			! /FILE_NAME=Functional
			! ! /QUERY=
			! ;
			
			! Conditional_Statement
			! /ITERATION_PARAMETER_NAME=cond
			! /EXPRESSION=((PARAMETERS::POINT::RATE > 100) &::AMP& (fmod(PARAMETERS::POINT::RATE, 10) = 0))
			! ! /AS_INTEGER=TRUE
			! ;

				! Downsample_Data
				! /OLD_FILE_NAME=H:\Pitching\Data\Doe, John\Baseball Right-handed\Functional hip RH 1.c3d 
				! /SIGNAL_TYPES=TARGET
				! /NEW_POINT_RATE=(PARAMETERS::POINT::RATE / 10) * 2
				! /NEW_ANALOG_RATE=
				! ;

			! Conditional_Statement_End
			! /ITERATION_PARAMETER_NAME=cond
			! ;
 

!Also open static file so that it is available for plots.
File_Open 
/FILE_NAME=H:\Pitching\Data\Doe, John\Baseball Right-handed\Static*.c3d
/SET_PROMPT=Open static trial
;

!Rename to avoid name conflict with model.
File_Rename
/EXISTING_FILE_NAME=H:\Pitching\Data\Doe, John\Baseball Right-handed\Static*.c3d
/NEW_FILE_NAME=H:\Pitching\Data\Doe, John\Baseball Right-handed\Stand.c3d
! /USE_SEARCH_REPLACE=FALSE
! /SEARCH_FOR=
! /REPLACE_WITH=
! /REMOVE_FILE_PATH=FALSE
! /RENAME_STATIC_CALIBRATION_FILES=TRUE
;
			
Assign_Tags_To_Files
/MOTION_FILE_NAMES=H:\Pitching\Data\Doe, John\Baseball Right-handed\Stand.c3d
! /QUERY=
/TAGS=Static
;
 

Assign_Tags_To_Files
/MOTION_FILE_NAMES=ALL_FILES
/QUERY=NOT(Functional) &::AMP& NOT(Static)
/TAGS=Pitch
;

Select_Active_File
/FILE_NAME=Pitch+Static
;

! Remove prefix 'Q_' if Skeleton solver Sports marker set is used.
Remove_Prefix_From_Point_Labels
/PREFIX=Q_
! /INCLUDE_CAL_FILE=TRUE
! /OVERWRITE_C3D_FILE=FALSE
;

!================================================================
! Interpolate and filter the Data
!================================================================

Interpolate
/SIGNAL_TYPES=TARGET
! /SIGNAL_NAMES=
! /SIGNAL_FOLDER=ORIGINAL
! /RESULT_SUFFIX=
! /RESULT_FOLDER=PROCESSED
/MAXIMUM_GAP=24
! /NUM_FIT=3
! /POLYNOMIAL_ORDER=3
;

Lowpass_Filter
/SIGNAL_TYPES=TARGET
! /SIGNAL_NAMES=
/SIGNAL_FOLDER=PROCESSED
! /RESULT_SUFFIX=
! /RESULT_FOLDER=PROCESSED
! /FILTER_CLASS=BUTTERWORTH
/FREQUENCY_CUTOFF=20 
! /NUM_REFLECTED=6
! /TOTAL_BUFFER_SIZE=6
! /NUM_BIDIRECTIONAL_PASSES=1
;

Select_Active_File
/FILE_NAME=*Func*
!/QUERY=
;

Lowpass_Filter
/SIGNAL_TYPES=TARGET
! /SIGNAL_NAMES=
! /SIGNAL_FOLDER=ORIGINAL
! /RESULT_SUFFIX=
! /RESULT_FOLDER=PROCESSED
! /FILTER_CLASS=BUTTERWORTH
! /FREQUENCY_CUTOFF=6.0
! /NUM_REFLECTED=6
! /TOTAL_BUFFER_SIZE=6
! /NUM_BIDIRECTIONAL_PASSES=1
;

 
	Create_Hybrid_Model
	/CALIBRATION_FILE=H:\Pitching\Data\Doe, John\Baseball Right-handed\*Static*.c3d 
	! /SUFFIX=
	! /RANGE=ALL_FRAMES
	;
 

Select_Active_File
/FILE_NAME=Pitch+Static
! /QUERY=
;

!Make copies of PitchTrack events and name them according to our convention
Set_Pipeline_Parameter_To_List_Of_Signal_Names
/PARAMETER_NAME=ev
/SIGNAL_TYPES=EVENT_LABEL
/SIGNAL_FOLDER=ORIGINAL
;

For_Each
/ITERATION_PARAMETER_NAME=ev_name
! /ITERATION_PARAMETER_COUNT_NAME=
/ITEMS=::ev
;

	Conditional_Statement
	/ITERATION_PARAMETER_NAME=loop
	/EXPRESSION=(STRING_FIND("&::ev_name&","Ball",0) <> -1)
	! /AS_INTEGER=TRUE
	;

		Event_Copy
		/EVENT_NAME=&::ev_name
		/NEW_EVENT_NAME=Release
		! /EVENT_INSTANCE=0
		! /RANGE_INSTANCE=0
		! /EVENT_SEQUENCE=
		! /EXCLUDE_EVENTS=
		! /START_AT_EVENT=
		! /END_AT_EVENT=
		/FRAME_OFFSET=0
		! /TIME_OFFSET=
		! /PERCENT_OFFSET=
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=loop
	;

	Conditional_Statement
	/ITERATION_PARAMETER_NAME=loop
	/EXPRESSION=(STRING_FIND("&::ev_name&","Foot",0) <> -1)
	! /AS_INTEGER=TRUE
	;

		Event_Copy
		/EVENT_NAME=&::ev_name
		/NEW_EVENT_NAME=Footstrike
		! /EVENT_INSTANCE=0
		! /RANGE_INSTANCE=0
		! /EVENT_SEQUENCE=
		! /EXCLUDE_EVENTS=
		! /START_AT_EVENT=
		! /END_AT_EVENT=
		/FRAME_OFFSET=0
		! /TIME_OFFSET=
		! /PERCENT_OFFSET=
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=loop
	;

End_For_Each
/ITERATION_PARAMETER_NAME=ev_name
;

!Find out if legacy performance or standard or traditional or sports maker set is used
Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=(Data_Exists(TARGET::ORIGINAL::left_ankle_outer) = 1)
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=markerset_used
	/PARAMETER_VALUE=legacy_std
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=(Data_Exists(TARGET::ORIGINAL::left_ankle) = 1)
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=markerset_used
	/PARAMETER_VALUE=legacy_perf
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=(Data_Exists(TARGET::ORIGINAL::L_FLE) = 1)
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=markerset_used
	/PARAMETER_VALUE=legacy_perf_traditional
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=(Data_Exists(TARGET::ORIGINAL::LAnkleOut) = 1)
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=markerset_used
	/PARAMETER_VALUE=sports
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=(Data_Exists(TARGET::ORIGINAL::L.Ankle) = 1)
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=markerset_used
	/PARAMETER_VALUE=motion_analysis
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=(Data_Exists(TARGET::ORIGINAL::LLAMA) = 1)
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=markerset_used
	/PARAMETER_VALUE=usc
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=Data_Exists(TARGET::ORIGINAL::LANK)
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=markerset_used
	/PARAMETER_VALUE=driveline
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=0 * 1
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=markerset_used
	/PARAMETER_VALUE=theia
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

! Apply correct model
Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "legacy_std")
! /AS_INTEGER=TRUE
;

	Apply_Model_Template
	/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\BaseballStdModel.mdh
	/CALIBRATION_FILE=*Static*.c3d 
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "legacy_perf")
! /AS_INTEGER=TRUE
;

	Apply_Model_Template
	/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\BaseballPerfModel.mdh
	/CALIBRATION_FILE=*Static*.c3d 
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "legacy_perf_traditional")
! /AS_INTEGER=TRUE
;

	Apply_Model_Template
	/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\BaseballTraditionalModel.mdh
	/CALIBRATION_FILE=*Static*.c3d 
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "sports")
! /AS_INTEGER=TRUE
;

	!Apply pelvis model based on availability of illiac crest markers (if IC exists in dynamic trial, ASIS' are only static markes)
	Conditional_Statement
	/ITERATION_PARAMETER_NAME=do_not_use_IC
	/EXPRESSION=(Data_Exists(TARGET::ORIGINAL::WaistR) <> 1)
	! /AS_INTEGER=TRUE
	;

		Apply_Model_Template
		/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\BaseballSportsModelPelvis.mdh
		/CALIBRATION_FILE=*Static*.c3d 
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=do_not_use_IC
	;

	Conditional_Statement
	/ITERATION_PARAMETER_NAME=use_IC
	/EXPRESSION=Data_Exists(TARGET::ORIGINAL::WaistR)
	! /AS_INTEGER=TRUE
	;

		Apply_Model_Template
		/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\BaseballSportsModelPelvis_alt.mdh
		/CALIBRATION_FILE=*Static*.c3d 
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=use_IC
	;

	Append_Model_Template
	/CALIBRATION_FILE=*Static*.c3d 
	/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\BaseballSportsModelLowerBody.mdh
	;

	Conditional_Statement
	/ITERATION_PARAMETER_NAME=arm_tracking_marker
	/EXPRESSION=(Data_Exists(TARGET::ORIGINAL::LArm) &::AMP& Data_Exists(TARGET::ORIGINAL::LForeArm))
	! /AS_INTEGER=TRUE
	;

		Append_Model_Template
		/CALIBRATION_FILE=*Static*.c3d 
		/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\BaseballSportsModelUpperBody_inclExtraArmTrackingMarkers.mdh
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=arm_tracking_marker
	;
	
	Conditional_Statement
	/ITERATION_PARAMETER_NAME=no_arm_tracking_marker
	/EXPRESSION=((Data_Exists(TARGET::ORIGINAL::LArm) <> 1) | (Data_Exists(TARGET::ORIGINAL::LForeArm) <> 1))
	! /AS_INTEGER=TRUE
	;

		Append_Model_Template
		/CALIBRATION_FILE=*Static*.c3d 
		/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\BaseballSportsModelUpperBody.mdh
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=no_arm_tracking_marker
	;
	
Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "motion_analysis")
! /AS_INTEGER=TRUE
;

	Apply_Model_Template
	/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\BaseballMacModel.mdh
	/CALIBRATION_FILE=*Static*.c3d 
	;

	Conditional_Statement
	/ITERATION_PARAMETER_NAME=fp_exists
	/EXPRESSION=(Data_Exists(FORCE::ORIGINAL::FP1) &::AMP& ("" = "true")) !add $apply_FP_fix_WF_import = "true"; to settings.php if reprocessing data imported from Cortex (not needed with QTM 2020.1.5556 and later)
	! /AS_INTEGER=TRUE
	;

		!Apply correction to force vector for Wake Forest to negate
		Modify_Analog_Parameters
		! /ANALOG_LABELS=
		/ANALOG_GEN_SCALE=-1
		! /ANALOG_SCALE=
		! /ANALOG_OFFSET=
		! /ANALOG_BASELINES=
		! /ANALOG_UNITS=
		! /UPDATE_C3D_FILE=FALSE
		;
		
		! FPs wrongly identified as Type 2 by QTM 2019.2.4610 (fixed at QTM 2020.1.5556)
		! It is assumed 3 FPs exist
		Modify_Force_Platform_Parameters
		/FP_TYPE=4+4+4
		/UPDATE_C3D_FILE=TRUE
		! /MODIFY_CAL_FILE=FALSE
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=fp_exists
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "usc")
! /AS_INTEGER=TRUE
;

	Apply_Model_Template
	/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\BaseballUscModel.mdh
	/CALIBRATION_FILE=*Static*.c3d 
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "driveline")
! /AS_INTEGER=TRUE
;

	Apply_Model_Template
	/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\BaseballDrivelineModel.mdh
	/CALIBRATION_FILE=*Static*.c3d 
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "theia")
! /AS_INTEGER=TRUE
;
	! Theia model additions ---------------------

! +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
!  Copyright notice
!  This PAF and its content is copyright of Qualisys AB © 2012-2025. All rights reserved. 
!  The PAF script is only to be used in conjunction with a Qualisys Motion Capture System. 
!  Only legal PAF owners are entitled to use the script and only in relation with related PAF.
! +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Append_Model_Template
/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\Theia.mdh 
/CALIBRATION_FILE=*_static.c3d
/INCLUDE_POSE_ESTIMATION=FALSE
;

!Use the weight and height that the user has entered in QTM
Set_Subject_Weight
/CALIBRATION_FILE=H:\Pitching\Data\Doe, John\Baseball Right-handed\*_static.c3d
/WEIGHT=90.718002319 
;

 
	Set_Subject_Height
	/CALIBRATION_FILE=H:\Pitching\Data\Doe, John\Baseball Right-handed\*_static.c3d
	/HEIGHT=1.904999971 
	;

	 

Set_Segment_Properties
/CALIBRATION_FILE=*_static.c3d
/SEGMENT_NAME=RTX
/KINEMATIC_ONLY=TRUE
! /MASS=
! /CG_FROM_PROX_AXIAL=
! /CG_FROM_PROX_ML=
! /CG_FROM_PROX_AP=
! /INERTIA_XX=
! /INERTIA_YY=
! /INERTIA_ZZ=
! /AP_DIRECTION=
! /AXIAL_DIRECTION=
! /MODEL_FILE=thoraciccerviclet12toacromium.v3g
! /MATERIAL_FILE=
! /GRAPHICS_ROT_X=
! /GRAPHICS_ROT_Y=
! /GRAPHICS_ROT_Z=
/GRAPHICS_SCALE_X=0
/GRAPHICS_SCALE_Y=0
/GRAPHICS_SCALE_Z=0
/GRAPHICS_TRANSLATE_X=0
/GRAPHICS_TRANSLATE_Y=0
/GRAPHICS_TRANSLATE_Z=0
/INCLUDE_POSE_ESTIMATION=FALSE
;

Set_Segment_Properties
/CALIBRATION_FILE=*_static.c3d
/SEGMENT_NAME=RTA
/KINEMATIC_ONLY=FALSE
! /MASS=
! /CG_FROM_PROX_AXIAL=
! /CG_FROM_PROX_ML=
! /CG_FROM_PROX_AP=
! /INERTIA_XX=
! /INERTIA_YY=
! /INERTIA_ZZ=
! /AP_DIRECTION=
! /AXIAL_DIRECTION=
! /MODEL_FILE=thoraciccerviclet12toacromium.v3g
! /MATERIAL_FILE=
! /GRAPHICS_ROT_X=
! /GRAPHICS_ROT_Y=
! /GRAPHICS_ROT_Z=
/GRAPHICS_SCALE_X=0
/GRAPHICS_SCALE_Y=0
/GRAPHICS_SCALE_Z=0
/GRAPHICS_TRANSLATE_X=0
/GRAPHICS_TRANSLATE_Y=0
/GRAPHICS_TRANSLATE_Z=0
/INCLUDE_POSE_ESTIMATION=FALSE
;

Recalc
; 

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

!Add mound if mound markers exist
Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=Data_Exists(TARGET::ORIGINAL::Mound_Lt_Rear)
! /AS_INTEGER=TRUE
;

	Append_Model_Template
	/CALIBRATION_FILE=*Static*.c3d 
	/MODEL_TEMPLATE=H:\Pitching\Data\Doe, John\Baseball Right-handed\BaseballMound.mdh
	! /VIEW_BUILDMODEL_RESULTS=2
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

 

Set_Subject_Height
/CALIBRATION_FILE=*Static*.c3d 
/Height=1.904999971 
;

Set_Subject_Weight
/CALIBRATION_FILE=*Static*.c3d 
/Weight=90.718002319 
;

! Add ball weight to pitching hand
Set_Segment_Properties
/CALIBRATION_FILE=*Static*.c3d 
/SEGMENT_NAME=&::THROW_SIDE_LETTER&HA
! /KINEMATIC_ONLY=
/MASS=0.0056*Mass+0.14275 !5 ounce ball
! /CG_FROM_PROX_AXIAL=
! /CG_FROM_PROX_ML=
! /CG_FROM_PROX_AP=
! /INERTIA_XX=
! /INERTIA_YY=
! /INERTIA_ZZ=
! /AP_DIRECTION=
! /AXIAL_DIRECTION=
! /MODEL_FILE=
! /MATERIAL_FILE=
;

Assign_Model_File
/CALIBRATION_FILE=*Static*.c3d 
/MOTION_FILE_NAMES=Pitch+Static
;

!================================================================
!   Open the Report Template
!================================================================
Recalc
;

 
	Open_Report_Template
	/REPORT_TEMPLATE=H:\Pitching\Templates\Assets/Reports/BaseballReport 8 Cylinders &::THROW_SIDE_NAME&.rgt
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=title_page_picture
	/PARAMETER_VALUE=8-Cylinders_web.png
	;
	
	Set_Pipeline_Parameter
	/PARAMETER_NAME=delivery_at_glance_page_number
	/PARAMETER_VALUE=3
	;
 

!===================================
! Release event
!===================================

!Find out if Release event was set manually in all dynamic files
Set_Pipeline_Parameter_To_List_Of_Tagged_Files
/PARAMETER_NAME=files
/TAG_NAME=Pitch
! /GET_CURRENT_SELECTED_FILES=false
! /USE_SHORT_FILENAMES=false
;

For_Each
/ITERATION_PARAMETER_NAME=filename
! /ITERATION_PARAMETER_COUNT_NAME=
/ITEMS=::files
;

	Select_Active_File
	/FILE_NAME=::filename
	! /QUERY=
	;
	
	Set_Pipeline_Parameter
	/PARAMETER_NAME=filename_wo_path
	/PARAMETER_VALUE=::filename
	/PARAMETER_VALUE_SEARCH_FOR=H:\Pitching\Data\Doe, John\Baseball Right-handed\ 
	/PARAMETER_VALUE_REPLACE_WITH=..\
	! /PARAMETER_VALUE_PREFIX=
	! /PARAMETER_VALUE_APPEND=
	;

	! Set Release event from hand angular velocity if it was not set manually
	Conditional_Statement
	/ITERATION_PARAMETER_NAME=cond
	/EXPRESSION=(Data_Exists(EVENT_LABEL::ORIGINAL::Release) <> 1)
	! /AS_INTEGER=TRUE
	;

		Set_Pipeline_Parameter
		/PARAMETER_NAME=message
		/PARAMETER_VALUE=&::message& &::filename_wo_path&
		;
		
		Event_Global_Maximum
		/RESULT_EVENT_NAME=Release
		/SIGNAL_TYPES=LINK_MODEL_BASED
		! /SIGNAL_FOLDER=ORIGINAL
		/SIGNAL_NAMES=Pitching_Hand_Ang_Vel
		/SIGNAL_COMPONENTS=X
		! /FRAME_OFFSET=0
		! /TIME_OFFSET=
		! /EVENT_SEQUENCE=
		! /EXCLUDE_EVENTS=
		! /EVENT_SEQUENCE_INSTANCE=0
		! /EVENT_SUBSEQUENCE=
		! /SUBSEQUENCE_EXCLUDE_EVENTS=
		! /EVENT_SUBSEQUENCE_INSTANCE=0
		! /THRESHOLD=
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=cond
	;

End_For_Each
/ITERATION_PARAMETER_NAME=filename
;

Select_Active_File
/FILE_NAME=Pitch
! /QUERY=
;

! Halt the script if Release event is still missing
Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=(Data_Exists(EVENT_LABEL::ORIGINAL::Release) <> 1)
! /AS_INTEGER=TRUE
;

	Pipeline_Breakpoint
	/PAUSE_MESSAGE= 'Release' event is missing in &::message&. Please halt the script, and set the event in QTM.
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

!===========================================
! Define throwing direction
!===========================================
! Add TARGET Lab_orientation (used to set orientation of Virtual lab)
! ==================================

! Find L/R_MID_FOOT landmarks position at Release
Metric_Signal_Value_At_Event
/SIGNAL_TYPES=LANDMARK
! /SIGNAL_FOLDER=ORIGINAL
/SIGNAL_NAMES=L_MID_FOOT+R_MID_FOOT
/RESULT_METRIC_FOLDER=VIRTUAL_LAB
/RESULT_METRIC_NAME=@Release
/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
! /SIGNAL_COMPONENTS=
/COMPONENT_SEQUENCE=ALL
/EVENT_NAME=Release
! /EVENT_INSTANCE=0
! /GENERATE_MEAN_AND_STDDEV=TRUE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

! A unit vector is defined between the right and left foot landmarks, then rounded to yield 4 possible solutions ( +/- X-axis and +/- y-axis)
! A target is created that contains that unit_vector at every frame of data.
! The virtual_lab will be tracked by the new TARGET.

 ! Create a unit vector between left and right foot 
Evaluate_Expression
/EXPRESSION=UNIT_VECTOR(
	(METRIC::VIRTUAL_LAB::&::THROW_SIDE_LETTER&_MID_FOOT@Release::X - METRIC::VIRTUAL_LAB::&::OPP_SIDE_LETTER&_MID_FOOT@Release::X), 
	(METRIC::VIRTUAL_LAB::&::THROW_SIDE_LETTER&_MID_FOOT@Release::Y - METRIC::VIRTUAL_LAB::&::OPP_SIDE_LETTER&_MID_FOOT@Release::Y), 
	0) 
! /SIGNAL_TYPES= 
! /SIGNAL_FOLDER=ORIGINAL 
! /SIGNAL_NAMES= 
/RESULT_TYPES=METRIC 
/RESULT_FOLDERS=VIRTUAL_LAB 
/RESULT_NAME=FEET_VECTOR 
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE 
; 

! round the floats to an integer 
Evaluate_Expression 
/EXPRESSION=ROUND(METRIC::VIRTUAL_LAB::FEET_VECTOR) 
! /SIGNAL_TYPES= 
! /SIGNAL_FOLDER=ORIGINAL 
! /SIGNAL_NAMES= 
/RESULT_TYPES=METRIC 
/RESULT_FOLDERS=VIRTUAL_LAB 
/RESULT_NAME=LAB_LATERAL 
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE 
; 

! create a new TARGET that has the rounded unit vector at every frame. 
Create_Target 
/SIGNAL_NAMES=Lab_orientation
! /SIGNAL_DESCRIPTION= 
/EXPRESSION=METRIC::VIRTUAL_LAB::LAB_LATERAL 
; 

! Copy Lab_orientation to PROCESSED folder as for markerless 3d viewer fails if there is no target
Evaluate_Expression
/EXPRESSION=TARGET::ORIGINAL::Lab_orientation
/RESULT_TYPES=TARGET
! /RESULT_FOLDERS=PROCESSED
/RESULT_NAME=Lab_orientation
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
;

! Modify LANDMARK Lab_orientation (used if TARGET Lab_orientation does not exists)
! ==================================
Set_Pipeline_Parameter_To_List_Of_Tagged_Files
/PARAMETER_NAME=filenames
/TAG_NAME=Pitch
! /GET_CURRENT_SELECTED_FILES=false
! /USE_SHORT_FILENAMES=false
;

For_Each
/ITERATION_PARAMETER_NAME=file
/ITEMS=::filenames
;

	Select_Active_File
	/FILE_NAME=::file
	;

	Set_Pipeline_Parameter_To_Data_Value
	/SIGNAL_TYPES=METRIC
	/SIGNAL_FOLDER=VIRTUAL_LAB
	/SIGNAL_NAMES=LAB_LATERAL
	/SIGNAL_COMPONENTS=X
	/PARAMETER_NAME=offset_x
	;

	Set_Pipeline_Parameter_To_Data_Value
	/SIGNAL_TYPES=METRIC
	/SIGNAL_FOLDER=VIRTUAL_LAB
	/SIGNAL_NAMES=LAB_LATERAL
	/SIGNAL_COMPONENTS=Y
	/PARAMETER_NAME=offset_y
	;

	! Create vector to define walking direction and store it at GLOBAL::TREADMILL folder (will be used for Temporal_Distance calculations)
	Evaluate_Expression
	/EXPRESSION=vector(-&::offset_y&,&::offset_x&,0)
	/RESULT_NAME=WALKING_DIRECTION
	/RESULT_TYPE=METRIC
	/RESULT_FOLDER=TREADMILL
	;

	! make copy of WALKING_DIRECTION to GLOBAL and back to All_files
	Evaluate_Expression
	/EXPRESSION=METRIC::TREADMILL::WALKING_DIRECTION
	/RESULT_NAME=GLOBAL::WALKING_DIRECTION
	/RESULT_TYPE=METRIC
	/RESULT_FOLDER=TREADMILL
	;

End_For_Each
/ITERATION_PARAMETER_NAME=file
;

Select_Active_File
/FILE_NAME=Pitch
;

! Modify position of Lab_orientation landmark to rotate Virtual Lab according to walking direction (only X and Y is considered)
! walking at x direction -> offset_x = 0, offset_y =-1, walking at y direction -> offset_x = 1, offset_y = 0
Modify_Landmark
/LANDMARK_NAME=Lab_orientation
/CALIBRATION_FILE=*Static*.c3d 
! /USER_GENERATED=TRUE
! /USE_PERCENTAGE=FALSE
! /CALIBRATION_ONLY=FALSE
! /USE_TARGETS=FALSE
/SEGMENT_NAME=LAB
! /TARGET_TYPES=
! /TARGET_NAMES=
/MCSX=&::offset_x
/MCSY=&::offset_y
! /MCSZ=0.0
! /LANDMARK_LOCATION=
! /REFERENCE_LOCATION_NAME=
! /REFERENCE_LOCATION_TYPE=
! /USE_REFERENCE_LOCATION=FALSE
;

Build_Model
/CALIBRATION_FILE=*Static*.c3d 
! /REBUILD_ALL_MODELS=FALSE
! /DISPLAY_RESULTS=TRUE
;

Event_Explicit
/EVENT_NAME=START
/FRAME=1
! /TIME=
;

Event_Explicit
/EVENT_NAME=END
/FRAME=EOF
! /TIME=
;

! ------------------------------------------------------------------------------------------------
! Functional Joints for the Hips or Knees
! ------------------------------------------------------------------------------------------------

Recalc
;

! Set end frame to 5 sec.
Set_Pipeline_Parameter_From_Expression
/PARAMETER_NAME=frames_used
/EXPRESSION=PARAMETERS::POINT::RATE  * 5
! /AS_INTEGER=TRUE
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=(("&::markerset_used&" = "legacy_std") | ("&::markerset_used&" = "legacy_perf") | ("&::markerset_used&" = "legacy_perf_traditional"))
! /AS_INTEGER=TRUE
;

	Associate_Functional_Joints_With_Files
	/CALIBRATION_FILE=H:\Pitching\Data\Doe, John\Baseball Right-handed\Static*.c3d
	/FILE_NAME=*Func*
	/LANDMARKS=F_RHIP+F_LHIP
	/START_FRAME=1+1
	/END_FRAME=&::frames_used&+&::frames_used
	/COMPUTE_LANDMARK=TRUE
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "sports")
! /AS_INTEGER=TRUE
;

	Associate_Functional_Joints_With_Files
	/CALIBRATION_FILE=H:\Pitching\Data\Doe, John\Baseball Right-handed\Static*.c3d
	/FILE_NAME=*Func*
	/LANDMARKS=F_RKNEE+F_LKNEE
	/START_FRAME=1+1
	/END_FRAME=&::frames_used&+&::frames_used
	/COMPUTE_LANDMARK=TRUE
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

!Close the Functional trial to speed up the IK processing in the next step
Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" <> "motion_analysis") &::AMP& ("&::markerset_used&" <> "theia")
! /AS_INTEGER=TRUE
;

	File_Close
	/FILE_NAME=*Func*
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

! Set name for FM5 based on marker set used. Perf > Toe_5met, Std > toe, traditional > FM5, sports > Forefoot5
Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "legacy_std")
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=toe_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_NAME&_&toe
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=heel_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_NAME&_&heel
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHand2
	/PARAMETER_VALUE=&::OPP_SIDE_NAME&_hand
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadForefoot2
	/PARAMETER_VALUE=&::OPP_SIDE_NAME&_toe
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHeelBack
	/PARAMETER_VALUE=&::OPP_SIDE_NAME&_heel
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailForefoot2
	/PARAMETER_VALUE=&::THROW_SIDE_NAME&_toe
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailHeelBack
	/PARAMETER_VALUE=&::THROW_SIDE_NAME&_heel
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Forefoot2
	/PARAMETER_VALUE=_toe
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=HeelBack
	/PARAMETER_VALUE=_heel
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Left_side_target_name
	/PARAMETER_VALUE=Left
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Right_side_target_name
	/PARAMETER_VALUE=Right
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "legacy_perf")
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=toe_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_NAME&_&Toe_5met
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=heel_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_NAME&_&heel
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHand2
	/PARAMETER_VALUE=&::OPP_SIDE_NAME&_hand
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadForefoot2
	/PARAMETER_VALUE=&::OPP_SIDE_NAME&_Toe_2nd3rdmet
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHeelBack
	/PARAMETER_VALUE=&::OPP_SIDE_NAME&_heel
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailForefoot2
	/PARAMETER_VALUE=&::THROW_SIDE_NAME&_toe
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailHeelBack
	/PARAMETER_VALUE=&::THROW_SIDE_NAME&_heel
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Forefoot2
	/PARAMETER_VALUE=_Toe_2nd3rdmet
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=HeelBack
	/PARAMETER_VALUE=_heel
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Left_side_target_name
	/PARAMETER_VALUE=Left
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Right_side_target_name
	/PARAMETER_VALUE=Right
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "legacy_perf_traditional")
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=toe_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&_&FM5
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=heel_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&_&FCC
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHand2
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&_HL5
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadForefoot2
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&_FM2
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHeelBack
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&_FCC
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailForefoot2
	/PARAMETER_VALUE=&::THROW_SIDE_LETTER&_FM2
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailHeelBack
	/PARAMETER_VALUE=&::THROW_SIDE_LETTER&_FCC
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Forefoot2
	/PARAMETER_VALUE=_FM2
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=HeelBack
	/PARAMETER_VALUE=_FCC
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Left_side_target_name
	/PARAMETER_VALUE=L
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Right_side_target_name
	/PARAMETER_VALUE=R
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "sports")
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=toe_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&&Forefoot5
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=heel_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&&HeelBack
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHand2
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&Hand2
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadForefoot2
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&Forefoot2
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHeelBack
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&HeelBack
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailForefoot2
	/PARAMETER_VALUE=&::THROW_SIDE_LETTER&Forefoot2
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailHeelBack
	/PARAMETER_VALUE=&::THROW_SIDE_LETTER&HeelBack
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Forefoot2
	/PARAMETER_VALUE=Forefoot2
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=HeelBack
	/PARAMETER_VALUE=HeelBack
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Left_side_target_name
	/PARAMETER_VALUE=L
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Right_side_target_name
	/PARAMETER_VALUE=R
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "motion_analysis")
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=toe_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&.Toe
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=heel_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&.Heel
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHand2
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&.Hand
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadForefoot2
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&.Toe
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHeelBack
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&.Heel
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailForefoot2
	/PARAMETER_VALUE=&::THROW_SIDE_LETTER&.Toe
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailHeelBack
	/PARAMETER_VALUE=&::THROW_SIDE_LETTER&.Heel
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Forefoot2
	/PARAMETER_VALUE=.Toe
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=HeelBack
	/PARAMETER_VALUE=.Heel
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Left_side_target_name
	/PARAMETER_VALUE=L
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Right_side_target_name
	/PARAMETER_VALUE=R
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "driveline")
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=toe_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&Toe
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=heel_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&Hee
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHand2
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&FIN
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadForefoot2
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&TOE
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHeelBack
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&HEE
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailForefoot2
	/PARAMETER_VALUE=&::THROW_SIDE_LETTER&TOE
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailHeelBack
	/PARAMETER_VALUE=&::THROW_SIDE_LETTER&HEE
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Forefoot2
	/PARAMETER_VALUE=TOE
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=HeelBack
	/PARAMETER_VALUE=HEE
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Left_side_target_name
	/PARAMETER_VALUE=L
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Right_side_target_name
	/PARAMETER_VALUE=R
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

Conditional_Statement
/ITERATION_PARAMETER_NAME=cond
/EXPRESSION=("&::markerset_used&" = "theia")
! /AS_INTEGER=TRUE
;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=toe_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&TOES_DISTAL
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=heel_marker_name
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&_HEEL
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHand2
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&HA_DISTAL
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadForefoot2
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&TOES_DISTAL
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=LeadHeelBack
	/PARAMETER_VALUE=&::OPP_SIDE_LETTER&_FCC
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailForefoot2
	/PARAMETER_VALUE=&::THROW_SIDE_LETTER&TOES_DISTAL
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=TrailHeelBack
	/PARAMETER_VALUE=&::THROW_SIDE_LETTER&_FCC
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Forefoot2
	/PARAMETER_VALUE=TOES_DISTAL
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=HeelBack
	/PARAMETER_VALUE=_FCC
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Left_side_target_name
	/PARAMETER_VALUE=L
	;

	Set_Pipeline_Parameter
	/PARAMETER_NAME=Right_side_target_name
	/PARAMETER_VALUE=R
	;

Conditional_Statement_End
/ITERATION_PARAMETER_NAME=cond
;

! !============================================
! !Add landmarks to get the distance between the lead toe and heel markers and the ground
! !============================================
! Set_Model_Metric
! ! /CALIBRATION_FILE=
! /METRIC_NAME=OPP_TOE_MKR_HEIGHT
! /METRIC_VALUE=abs((Mound_Bottom::y-Mound_Front::y)*(Mound_Front::z-&::toe_marker_name&:&:z)-(Mound_Front::y-&::toe_marker_name&:&:y)*(Mound_Bottom::z-Mound_Front::z))/sqrt((Mound_Bottom::y-Mound_Front::y)^2+(Mound_Bottom::z-Mound_Front::z)^2)
! ;

! Set_Model_Metric
! ! /CALIBRATION_FILE=
! /METRIC_NAME=OPP_HEEL_MKR_HEIGHT
! /METRIC_VALUE=abs((Mound_Bottom::y-Mound_Front::y)*(Mound_Front::z-&::heel_marker_name&:&:z)-(Mound_Front::y-&::heel_marker_name&:&:y)*(Mound_Bottom::z-Mound_Front::z))/sqrt((Mound_Bottom::y-Mound_Front::y)^2+(Mound_Bottom::z-Mound_Front::z)^2)
! ;

!================================================================
! Set Method For Computing Model Pose to IK and build model
!================================================================
! Conditional_Statement
! /ITERATION_PARAMETER_NAME=cond
! /EXPRESSION=("&::markerset_used&" <> "motion_analysis") &::AMP& ("&::markerset_used&" <> "theia")
! ! /AS_INTEGER=TRUE
! ;

	! Set_Model_Pose_Algorithm
	! /CALIBRATION_FILE=H:\Pitching\Data\Doe, John\Baseball Right-handed\Static*.c3d
	! /ALGORITHM=Inverse Kinematics
	! /OPTIMIZER=LEVENBERG_MARQUARDT
	! ;

	! Build_Model
	! /CALIBRATION_FILE=*Static*.c3d 
	! ! /REBUILD_ALL_MODELS=FALSE
	! ! /DISPLAY_RESULTS=TRUE
	! ;

! Conditional_Statement_End
! /ITERATION_PARAMETER_NAME=cond
! ;

!===================================================================
! Segment lengths - arms, legs spine
!===================================================================

Select_Active_File
/FILE_NAME=Pitch
;

For_Each
/ITERATION_PARAMETER_NAME=signame
! /ITERATION_PARAMETER_COUNT_NAME=
 /ITEMS=LAR_Seg_Length+RAR_Seg_Length+LTH_Seg_Length+RTH_Seg_Length+RTA_Seg_Length
;

	! Copy to each trial (exported for web report)
	Evaluate_Expression
	/EXPRESSION=MODEL::METRIC::&::signame
	/RESULT_NAME=::signame
	/RESULT_TYPE=METRIC
	/RESULT_FOLDER=MODEL
	;

	! Copy a model metric signal named into the Global Workspace
	Evaluate_Expression
	/EXPRESSION=MODEL::METRIC::&::signame& * 39.37
	/RESULT_NAME=GLOBAL::&::signame&_in
	/RESULT_TYPE=METRIC
	/RESULT_FOLDER=MODEL
	;

End_For_Each
/ITERATION_PARAMETER_NAME=signame
;

!================================================================
! NORMALIZATION - for Moments
!================================================================
! Set a parameter value for body mass
Set_Pipeline_Parameter_To_Data_Value
/PARAMETER_NAME=Body_Mass
/SIGNAL_TYPES=METRIC
/SIGNAL_NAMES=MASS
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_COMPONENTS=0
;

! Convert Mass to BW in Newtons
Evaluate_Expression
/EXPRESSION=9.81*&::Body_Mass
/RESULT_NAME=MASS_N
/RESULT_TYPE=METRIC
/RESULT_FOLDER=PROCESSED
;

! Create a metric BW_Height for body weight in Newtons times Height - used to normalized Moments (Torques) - Option 1
Multiply_Signals
/SIGNAL_TYPES=METRIC+METRIC
/SIGNAL_NAMES=MASS_N+Height
/SIGNAL_FOLDER=PROCESSED+PROCESSED
/RESULT_NAME=BW_Height
! /RESULT_FOLDER=PROCESSED
;

! Create a metric Mass_Height for Mass in kg times Height - used to normalized Moments (Torques) - Option 2
Multiply_Signals
/SIGNAL_TYPES=METRIC+METRIC
/SIGNAL_NAMES=MASS+Height
/SIGNAL_FOLDER=PROCESSED+PROCESSED
/RESULT_NAME=Mass_Height
! /RESULT_FOLDER=PROCESSED
;

! No normalization coeficient
Metric_Explicit
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=NonNormalized
/METRIC_VALUE=1
;

 

! Copy normalization coefficient to Global
Evaluate_Expression
/Expression=METRIC::Processed::BW_Height 
/Result_Name=GLOBAL::NORM_COEF
/Result_Type=METRIC
/Result_Folder=PROCESSED
;

! Copy Mass_Height to Global
Evaluate_Expression
/Expression=METRIC::Processed::Mass_Height
/Result_Name=GLOBAL::Mass_Height
/Result_Type=METRIC
/Result_Folder=PROCESSED
;

! Copy BW_Height to Global
Evaluate_Expression
/Expression=METRIC::Processed::BW_Height
/Result_Name=GLOBAL::BW_Height
/Result_Type=METRIC
/Result_Folder=PROCESSED
;

! Copy Mass_N to Global
Evaluate_Expression
/Expression=METRIC::Processed::Mass_N
/Result_Name=GLOBAL::Mass_N
/Result_Type=METRIC
/Result_Folder=PROCESSED
;

! Adjust y axes for moments in extended report based on normalization method used
 

Recalc
;

!================================================================
! Select all throws
!================================================================

! Avoid discontinuity if int/ext rotation exceeds 180 degrees
! Shoulder angles discontinuity is part of recalc pipeline of all report templates

! Horizontal Shoulder Abduction angular velocity - Used derivative of the shoulder angle (humerus wrt trunk with ZYZ) rather than the V3D Joint velocity command. 
First_Derivative
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Pitching_Shoulder_Angle
/RESULT_TYPES=DERIVED
/RESULT_FOLDERS=PROCESSED
/RESULT_NAME=Pitching_Shoulder_AngVel_HzShldAbd
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=
;

 

	!Filter Pelvis data (there can be artefacts from hip marker dropouts)
	!Filter Ang vel data for lead and back leg
	!  Filter thorax and arm ang vel as it might be noisy if IK filter is not applied
	Lowpass_Filter
	/SIGNAL_TYPES=LINK_MODEL_BASED
	/SIGNAL_FOLDER=ORIGINAL
	/SIGNAL_NAMES=Pelvis_Ang_Vel+Back_Ankle_Ang_Vel+Back_Hip_Ang_Vel+Back_Knee_Ang_Vel+Lead_Ankle_Ang_Vel+Lead_Hip_Ang_Vel+Lead_Knee_Ang_Vel+Glove_Shoulder_Ang_Vel+Pitching_Elbow_Ang_Vel+Pitching_Hand_Ang_Vel+Pitching_Humerus_Ang_Vel+Pitching_Shoulder_Ang_Vel+Thorax_Ang_Vel+Trunk_COG_Vel
	! /RESULT_FOLDER=PROCESSED
	! /RESULT_SUFFIX=
	! /FILTER_CLASS=BUTTERWORTH
	/FREQUENCY_CUTOFF=20 
	! /NUM_REFLECTED=6
	! /NUM_EXTRAPOLATED=0
	! /TOTAL_BUFFER_SIZE=6
	! /NUM_BIDIRECTIONAL_PASSES=1
	;

	Lowpass_Filter
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=PROCESSED
	/SIGNAL_NAMES=Pitching_Shoulder_AngVel_HzShldAbd
	! /RESULT_FOLDER=PROCESSED
	! /RESULT_SUFFIX=
	! /FILTER_CLASS=BUTTERWORTH
	/FREQUENCY_CUTOFF=20 
	! /NUM_REFLECTED=6
	! /NUM_EXTRAPOLATED=0
	! /TOTAL_BUFFER_SIZE=6
	! /NUM_BIDIRECTIONAL_PASSES=1
	;

 

 
	!just copy signals if no magnutude is applied (need specific component as magnutude is single component signal, Pelvis_Ang_Vel is Z
	Evaluate_Expression
	/EXPRESSION=LINK_MODEL_BASED::PROCESSED::Pitching_Hand_Ang_Vel::X
	! /RESULT_TYPES=DERIVED
	! /RESULT_FOLDERS=PROCESSED
	/RESULT_NAME=Pitching_Hand_Ang_Vel_plot
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;
	
	Evaluate_Expression
	/EXPRESSION=LINK_MODEL_BASED::PROCESSED::Pitching_Humerus_Ang_Vel::Z
	! /RESULT_TYPES=DERIVED
	! /RESULT_FOLDERS=PROCESSED
	/RESULT_NAME=Pitching_Humerus_Ang_Vel_plot
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;
	
	Evaluate_Expression
	/EXPRESSION=LINK_MODEL_BASED::PROCESSED::Thorax_Ang_Vel::Z
	! /RESULT_TYPES=DERIVED
	! /RESULT_FOLDERS=PROCESSED
	/RESULT_NAME=Thorax_Ang_Vel_plot
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;
	
	Evaluate_Expression
	/EXPRESSION=LINK_MODEL_BASED::PROCESSED::Pelvis_Ang_Vel::Z
	! /RESULT_TYPES=DERIVED
	! /RESULT_FOLDERS=PROCESSED
	/RESULT_NAME=Pelvis_Ang_Vel_plot
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;
	
	Evaluate_Expression
	/EXPRESSION=LINK_MODEL_BASED::PROCESSED::Pitching_Elbow_Ang_Vel::Y
	! /RESULT_TYPES=DERIVED
	! /RESULT_FOLDERS=PROCESSED
	/RESULT_NAME=Pitching_Elbow_Ang_Vel_plot
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;
	
	Evaluate_Expression
	/EXPRESSION=LINK_MODEL_BASED::PROCESSED::Pitching_Shoulder_Ang_Vel::Z
	! /RESULT_TYPES=DERIVED
	! /RESULT_FOLDERS=PROCESSED
	/RESULT_NAME=Pitching_Shoulder_Ang_Vel_plot
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;
 

! Used by kinetics sequence graph where we want all peaks to be positive
Multiply_Signals_By_Constant
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Pitching_Elbow_Ang_Vel_plot+Pitching_Shoulder_Ang_Vel_plot
/SIGNAL_COMPONENTS=X
/RESULT_TYPES=DERIVED
! /RESULT_FOLDERS=PROCESSED
/RESULT_NAME=_neg
/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
/CONSTANT=-1
;

! Convert Meters to Feet
For_Each
/ITERATION_PARAMETER_NAME=signame
! /ITERATION_PARAMETER_COUNT_NAME=
/ITEMS=Trunk_COG+Pelvis_COG+Back_Foot_COG+Pelvis_COG_Vel
;

	Evaluate_Expression
	/EXPRESSION=3.28 * LINK_MODEL_BASED::ORIGINAL::&::signame
	/RESULT_NAME=&::signame&_Feet
	!/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=PROCESSED
	;

End_For_Each
/ITERATION_PARAMETER_NAME=signame
;

Evaluate_Expression
/EXPRESSION=3.28 * LINK_MODEL_BASED::PROCESSED::Trunk_COG_Vel
/RESULT_NAME=Trunk_COG_Vel_Feet
!/RESULT_TYPE=DERIVED
/RESULT_FOLDER=PROCESSED
;


! Convert Feet to Inches
Evaluate_Expression
/EXPRESSION=12*DERIVED::PROCESSED::Pelvis_COG_Feet
/RESULT_NAME=Pelvis_COG_In
!/RESULT_TYPE=DERIVED
/RESULT_FOLDER=PROCESSED
;

!Filter Pelvis_COG_Vel_Feet
Lowpass_Filter
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Pelvis_COG_Vel_Feet
! /RESULT_FOLDER=PROCESSED
! /RESULT_SUFFIX=
! /FILTER_CLASS=BUTTERWORTH
/FREQUENCY_CUTOFF=10
! /NUM_REFLECTED=6
! /NUM_EXTRAPOLATED=0
! /TOTAL_BUFFER_SIZE=6
! /NUM_BIDIRECTIONAL_PASSES=1
;

!Trunk_COG_Vel_Feet convert to MPH - linear velocity in MPH
Evaluate_Expression
/EXPRESSION=0.6818*DERIVED::PROCESSED::Trunk_COG_Vel_Feet
/RESULT_NAME=Trunk_COG_Vel_MPH
!/RESULT_TYPE=DERIVED
/RESULT_FOLDER=PROCESSED
;

!Pelvis_COG_Vel_Feet convert to MPH - linear velocity in MPH
Evaluate_Expression
/EXPRESSION=0.6818*DERIVED::PROCESSED::Pelvis_COG_Vel_Feet
/RESULT_NAME=Pelvis_COG_Vel_MPH
!/RESULT_TYPE=DERIVED
/RESULT_FOLDER=PROCESSED
;

Transform_Data_Coordinate_System
/SIGNAL_TYPES=LANDMARK
! /SIGNAL_FOLDER=ORIGINAL
/SIGNAL_NAMES=&::OPP_SIDE_LETTER&KNEE_dyn+&::THROW_SIDE_LETTER&KNEE_dyn
! /FROM_SEGMENT_CS=LAB
/TO_SEGMENT_CS=Virtual Lab
/RESULT_TYPES=DERIVED
/RESULT_FOLDERS=PROCESSED
/RESULT_NAME=_VLab
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
! /ORIENTATION_ONLY=FALSE
! /USE_DATA_RATE=FALSE
;

!Lead KNEE_dyn convert Meters to Feet
Evaluate_Expression
/EXPRESSION=3.28*DERIVED::PROCESSED::&::OPP_SIDE_LETTER&KNEE_dyn_VLab
/RESULT_NAME=Lead_KNEE_dyn_Feet
!/RESULT_TYPE=DERIVED
/RESULT_FOLDER=PROCESSED
;

!Back KNEE_dyn convert Meters to Feet
Evaluate_Expression
/EXPRESSION=3.28*DERIVED::PROCESSED::&::THROW_SIDE_LETTER&KNEE_dyn_VLab
/RESULT_NAME=Back_KNEE_dyn_Feet
!/RESULT_TYPE=DERIVED
/RESULT_FOLDER=PROCESSED
;

! Convert back to meters and store in derived folder (used by web report)
Evaluate_Expression
/EXPRESSION=DERIVED::PROCESSED::Lead_KNEE_dyn_Feet / 3.28
/RESULT_NAME=Lead_KNEE_dyn
!/RESULT_TYPE=DERIVED
/RESULT_FOLDER=PROCESSED
;

Evaluate_Expression
/EXPRESSION=DERIVED::PROCESSED::Back_KNEE_dyn_Feet / 3.28
/RESULT_NAME=Back_Knee_dyn
!/RESULT_TYPE=DERIVED
/RESULT_FOLDER=PROCESSED
;

!================================================================
! Events
!================================================================
! Max lift of lead leg
Event_Global_Maximum
/SIGNAL_TYPES=KINETIC_KINEMATIC
/SIGNAL_NAMES=DistEndPos
/SIGNAL_FOLDER=::OPP_SIDE_LETTER&TH
/EVENT_NAME=MaxKneeHeight
! /SELECT_X=FALSE
! /SELECT_Y=FALSE
/SELECT_Z=TRUE
!/START_AT_EVENT=
/END_AT_EVENT=Release
;

First_Derivative
/SIGNAL_TYPES=TARGET 
/SIGNAL_FOLDER=PROCESSED 
/SIGNAL_NAMES=&::heel_marker_name&+&::toe_marker_name
/RESULT_TYPES=DERIVED
/RESULT_FOLDER=EVENTS
/RESULT_NAMES=OPP_HEEL_VEL+OPP_TOE_VEL
! /RESULT_SUFFIX=
;

Signal_Magnitude
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=EVENTS
/SIGNAL_NAMES=OPP_HEEL_VEL+OPP_TOE_VEL
/RESULT_TYPES=DERIVED
/RESULT_FOLDER=EVENTS
/RESULT_NAMES=OPP_HEEL_VEL_MAG+OPP_TOE_VEL_MAG
! /RESULT_SUFFIX=
;

For_Each
/ITERATION_PARAMETER_NAME=filename
! /ITERATION_PARAMETER_COUNT_NAME=
/ITEMS=::files
;

	Select_Active_File
	/FILE_NAME=::filename
	! /QUERY=
	;

	! Setup ------------------
	Conditional_Statement
	/ITERATION_PARAMETER_NAME=check
	/EXPRESSION=isnan(EVENT_LABEL::ORIGINAL::SETUP)
	/AS_INTEGER=FALSE
	;

		Event_Threshold
		/SIGNAL_TYPES=DERIVED
		/SIGNAL_NAMES=OPP_HEEL_VEL
		/SIGNAL_FOLDER=EVENTS
		/EVENT_NAME=SETUP
		! /SELECT_X=FALSE
		! /SELECT_Y=FALSE
		/SELECT_Z=TRUE
		! /SELECT_RESIDUAL=FALSE
		/THRESHOLD=0.02
		/FRAME_WINDOW=2
		/FRAME_OFFSET=-1
		/ASCENDING=TRUE
		! /DESCENDING=FALSE
		/ENSURE_RANGE_FRAMES_BEFORE_THRESHOLD_CROSSING=TRUE
		/ENSURE_RANGE_FRAMES_AFTER_THRESHOLD_CROSSING=TRUE
		! /START_AT_EVENT=
		/END_AT_EVENT=MaxKneeHeight
		/EVENT_INSTANCE=-1
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=check
	;

	! Foot Strike -------------------
	Conditional_Statement
	/ITERATION_PARAMETER_NAME=check
	/EXPRESSION=isnan(EVENT_LABEL::ORIGINAL::Footstrike)
	/AS_INTEGER=FALSE
	;

		! Force plate based
		Conditional_Statement
		/ITERATION_PARAMETER_NAME=fp
		/EXPRESSION=Data_Exists(FORCE::ORIGINAL::FP1) !it is assumed that if any FP exists it is used for lead foot
		/AS_INTEGER=FALSE
		;
			
			Automatic_Gait_Events
			! /FRAME_WINDOW=8
			/USE_TPR=FALSE
			;		

			Event_Copy
			/EVENT_NAME=&::OPP_SIDE_LETTER&ON
			/NEW_EVENT_NAME=Footstrike
			/EVENT_INSTANCE=1
			! /EVENT_INSTANCE_AS_LIST=FALSE
			! /RANGE_INSTANCE=0
			! /EVENT_SEQUENCE=
			! /EXCLUDE_EVENTS=
			/START_AT_EVENT=MaxKneeHeight
			/END_AT_EVENT=Release
			/FRAME_OFFSET=-1
			! /TIME_OFFSET=
			! /PERCENT_OFFSET=
			;

		Conditional_Statement_End
		/ITERATION_PARAMETER_NAME=fp
		;

		Conditional_Statement
		/ITERATION_PARAMETER_NAME=no_fp
		/EXPRESSION=(Data_Exists(FORCE::ORIGINAL::FP1) <> 1) !no FP found
		/AS_INTEGER=FALSE
		;

			! Definition based on marker speeds
			Conditional_Statement
			/ITERATION_PARAMETER_NAME=no_mound
			/EXPRESSION=(Data_Exists(LANDMARK::ORIGINAL::Mound_Bottom) <> 1)
			/AS_INTEGER=FALSE
			;
				!heel
				Event_Threshold
				/SIGNAL_TYPES=DERIVED
				/SIGNAL_NAMES=OPP_HEEL_VEL_MAG
				/SIGNAL_FOLDER=EVENTS
				/EVENT_NAME=Alt_Footstrike_Heel
				/SELECT_X=TRUE
				! /SELECT_Y=FALSE
				! /SELECT_Z=FALSE
				! /SELECT_RESIDUAL=FALSE
				/THRESHOLD=0.4
				! /FRAME_WINDOW=8
				! /FRAME_OFFSET=0
				! /ASCENDING=FALSE
				/DESCENDING=TRUE
				/ENSURE_RANGE_FRAMES_BEFORE_THRESHOLD_CROSSING=TRUE
				! /ENSURE_RANGE_FRAMES_AFTER_THRESHOLD_CROSSING=FALSE
				/START_AT_EVENT=MaxKneeHeight
				/END_AT_EVENT=Release
				/EVENT_INSTANCE=-1
				;

				!toe
				Event_Threshold
				/SIGNAL_TYPES=DERIVED
				/SIGNAL_NAMES=OPP_TOE_VEL_MAG
				/SIGNAL_FOLDER=EVENTS
				/EVENT_NAME=Alt_Footstrike_Toe
				/SELECT_X=TRUE
				! /SELECT_Y=FALSE
				! /SELECT_Z=FALSE
				! /SELECT_RESIDUAL=FALSE
				/THRESHOLD=0.4
				! /FRAME_WINDOW=8
				! /FRAME_OFFSET=0
				! /ASCENDING=FALSE
				/DESCENDING=TRUE
				/ENSURE_RANGE_FRAMES_BEFORE_THRESHOLD_CROSSING=TRUE
				! /ENSURE_RANGE_FRAMES_AFTER_THRESHOLD_CROSSING=FALSE
				/START_AT_EVENT=MaxKneeHeight
				/END_AT_EVENT=Release
				/EVENT_INSTANCE=-1
				;

			Conditional_Statement_End
			/ITERATION_PARAMETER_NAME=no_mound
			;

			!Mound based definition
			Conditional_Statement
			/ITERATION_PARAMETER_NAME=mound_exists
			/EXPRESSION=Data_Exists(LANDMARK::ORIGINAL::Mound_Bottom)
			/AS_INTEGER=FALSE
			;
			
				! Distance of toe and heel to mound plane
				Evaluate_Expression
				/EXPRESSION=Best_Fit_Plane(LANDMARK::ORIGINAL::MOUND_FRONT, LANDMARK::ORIGINAL::MOUND_LT_BOTTOM, LANDMARK::ORIGINAL::MOUND_RT_BOTTOM)
				/RESULT_TYPES=DERIVED
				/RESULT_FOLDERS=PROCESSED
				/RESULT_NAME=MOUND_PLANE
				/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
				;

				Evaluate_Expression
				/EXPRESSION=Point_Distance_To_Plane(DERIVED::PROCESSED::MOUND_PLANE, TARGET::PROCESSED::&::toe_marker_name&)
				/RESULT_TYPES=DERIVED
				/RESULT_FOLDERS=EVENTS
				/RESULT_NAME=Opp_Toe_Height
				/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
				;

				Evaluate_Expression
				/EXPRESSION=Point_Distance_To_Plane(DERIVED::PROCESSED::MOUND_PLANE, TARGET::PROCESSED::&::heel_marker_name&)
				/RESULT_TYPES=DERIVED
				/RESULT_FOLDERS=EVENTS
				/RESULT_NAME=Opp_Heel_Height
				/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
				;

				Metric_Signal_Value_At_Event
				/RESULT_METRIC_NAME=Heel_Height@Setup+Toe_Height@Setup
				/RESULT_METRIC_FOLDER=EVENTS
				/SIGNAL_TYPES=DERIVED
				/SIGNAL_NAMES=Opp_Heel_Height+Opp_Toe_Height
				/SIGNAL_FOLDER=EVENTS
				/EVENT_NAME=SETUP
				/GENERATE_MEAN_AND_STDDEV=FALSE
				! /APPEND_TO_EXISTING_VALUES=FALSE
				! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
				! /RETAIN_NO_DATA_VALUES=FALSE
				;

				! (before 4.1.2 - use zero threshold for toe strike as metric value from setup can cause event to be too late (better for mound)
				! using zero can cause event not to be found at all, using Toe_Height@Setup instead
				Event_Threshold
				/SIGNAL_TYPES=DERIVED
				/SIGNAL_NAMES=Opp_Toe_Height
				/SIGNAL_FOLDER=EVENTS
				/EVENT_NAME=Alt_Footstrike_TOE
				/SELECT_X=TRUE
				! /SELECT_Y=FALSE
				! /SELECT_Z=FALSE
				! /SELECT_RESIDUAL=FALSE
				/THRESHOLD=METRIC::EVENTS::Toe_Height@Setup+0.05
				! /FRAME_WINDOW=8
				! /FRAME_OFFSET=0
				/EVENT_SEQUENCE=MaxKneeHeight+Release
				! /ASCENDING=FALSE
				/DESCENDING=TRUE
				/ENSURE_RANGE_FRAMES_BEFORE_THRESHOLD_CROSSING=TRUE
				! /ENSURE_RANGE_FRAMES_AFTER_THRESHOLD_CROSSING=FALSE
				!/START_AT_EVENT=MaxKneeHeight
				!/END_AT_EVENT=Release
				/EVENT_INSTANCE=-1
				;

				Event_Threshold
				/SIGNAL_TYPES=DERIVED
				/SIGNAL_NAMES=Opp_Heel_Height
				/SIGNAL_FOLDER=EVENTS
				/EVENT_NAME=Alt_Footstrike_HEEL
				/SELECT_X=TRUE
				! /SELECT_Y=FALSE
				! /SELECT_Z=FALSE
				! /SELECT_RESIDUAL=FALSE
				/THRESHOLD=METRIC::EVENTS::Heel_Height@Setup+0.05
				! /FRAME_WINDOW=8
				! /FRAME_OFFSET=0
				/EVENT_SEQUENCE=MaxKneeHeight+Release
				! /ASCENDING=FALSE
				/DESCENDING=TRUE
				/ENSURE_RANGE_FRAMES_BEFORE_THRESHOLD_CROSSING=TRUE
				! /ENSURE_RANGE_FRAMES_AFTER_THRESHOLD_CROSSING=FALSE
				!/START_AT_EVENT=MaxKneeHeight
				!/END_AT_EVENT=Release
				/EVENT_INSTANCE=-1
				;

			Conditional_Statement_End
			/ITERATION_PARAMETER_NAME=mound_exists
			;

			!delete whichever event occurs second
			Event_Delete
			/EVENT_NAME=Alt_Footstrike_HEEL
			/EVENT_SEQUENCE=Alt_Footstrike_TOE+Release
			! /EXCLUDE_EVENTS=
			! /TIME=
			;

			Event_Delete
			/EVENT_NAME=Alt_Footstrike_TOE
			/EVENT_SEQUENCE=Alt_Footstrike_HEEL+Release
			! /EXCLUDE_EVENTS=
			! /TIME=
			;

			!rename the remaining event into Footstrike
			Event_Copy
			/EVENT_NAME=Alt_Footstrike_HEEL
			/NEW_EVENT_NAME=Footstrike
			/FRAME_OFFSET=0
			! /TIME_OFFSET=
			! /PERCENT_OFFSET=
			! /EVENT_INSTANCE=0
			! /RANGE_INSTANCE=0
			! /EVENT_SEQUENCE=
			! /EXCLUDE_EVENTS=
			! /START_AT_EVENT=
			! /END_AT_EVENT=
			;

			Event_Copy
			/EVENT_NAME=Alt_Footstrike_TOE
			/NEW_EVENT_NAME=Footstrike
			/FRAME_OFFSET=0
			! /TIME_OFFSET=
			! /PERCENT_OFFSET=
			! /EVENT_INSTANCE=0
			! /RANGE_INSTANCE=0
			! /EVENT_SEQUENCE=
			! /EXCLUDE_EVENTS=
			! /START_AT_EVENT=
			! /END_AT_EVENT=
			;

		Conditional_Statement_End
		/ITERATION_PARAMETER_NAME=no_fp
		;
		
	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=check
	;

End_For_Each
/ITERATION_PARAMETER_NAME=filename
;

Select_Active_File
/FILE_NAME=Pitch
! /QUERY=
;

!Ball release
Event_Copy
/EVENT_NAME=Release
/NEW_EVENT_NAME=Release100msAfter
! /FRAME_OFFSET=
/TIME_OFFSET=0.1
! /PERCENT_OFFSET=
! /EVENT_INSTANCE=0
! /RANGE_INSTANCE=0
! /EVENT_SEQUENCE=
! /EXCLUDE_EVENTS=
! /START_AT_EVENT=
! /END_AT_EVENT=
;

Event_Copy
/EVENT_NAME=Release
/NEW_EVENT_NAME=Release100msBefore
! /FRAME_OFFSET=
/TIME_OFFSET=-0.1
! /PERCENT_OFFSET=
! /EVENT_INSTANCE=0
! /RANGE_INSTANCE=0
! /EVENT_SEQUENCE=
! /EXCLUDE_EVENTS=
! /START_AT_EVENT=
! /END_AT_EVENT=
;

!Max shoulder external rotation - required for screenshots
Event_Global_Maximum
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_NAMES=Pitching_Shoulder_Angle
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=Max_Shoulder_Rot
! /SELECT_X=FALSE
! /SELECT_Y=FALSE
/SELECT_Z=TRUE
/START_AT_EVENT=SETUP
/END_AT_EVENT=Release
;

!Max shoulder Internal rotation - between setup and release
Event_Global_Minimum
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_NAMES=Pitching_Shoulder_Angle
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=Max_Shoulder_Int_Rot
! /SELECT_X=FALSE
! /SELECT_Y=FALSE
/SELECT_Z=TRUE
/START_AT_EVENT=SETUP
/END_AT_EVENT=Release
;

!Max shoulder Internal rotation follow through - after release
Event_Global_Minimum
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_NAMES=Pitching_Shoulder_Angle
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=Max_Shoulder_Int_Rot_FollowThru
! /SELECT_X=FALSE
! /SELECT_Y=FALSE
/SELECT_Z=TRUE
/START_AT_EVENT=Release
/END_AT_EVENT=EOF
;

!Add events at peak angular velocities so that markers can be added to plots
Event_Global_Maximum
/SIGNAL_TYPES=DERIVED
/SIGNAL_NAMES=Pelvis_Ang_Vel_plot
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=MaxPelvisVel
/SELECT_X=TRUE
! /SELECT_Y=FALSE
!/SELECT_Z=FALSE
/START_AT_EVENT=SETUP
/END_AT_EVENT=Release100msAfter
;

Event_Global_Maximum
/SIGNAL_TYPES=DERIVED
/SIGNAL_NAMES=Thorax_Ang_Vel_plot
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=MaxThoraxVel
/SELECT_X=TRUE
! /SELECT_Y=FALSE
!/SELECT_Z=FALSE
/START_AT_EVENT=SETUP
/END_AT_EVENT=Release100msAfter
;

Event_Global_Maximum
/SIGNAL_TYPES=DERIVED
/SIGNAL_NAMES=Pitching_Humerus_Ang_Vel_plot
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=MaxHumerusVel
/SELECT_X=TRUE
! /SELECT_Y=FALSE
!/SELECT_Z=FALSE
/START_AT_EVENT=SETUP
/END_AT_EVENT=Release100msAfter
;

Event_Global_Maximum
/SIGNAL_TYPES=DERIVED
/SIGNAL_NAMES=Pitching_Hand_Ang_Vel_plot
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=MaxHandVel
/SELECT_X=TRUE
! /SELECT_Y=FALSE
!/SELECT_Z=FALSE
/START_AT_EVENT=SETUP
/END_AT_EVENT=Release100msAfter
;

Event_Global_Maximum
/SIGNAL_TYPES=DERIVED
/SIGNAL_NAMES=Pitching_Elbow_Ang_Vel_plot_neg
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=MaxElbowVel
/SELECT_X=TRUE
! /SELECT_Y=FALSE
!/SELECT_Z=FALSE
/START_AT_EVENT=SETUP
/END_AT_EVENT=Release100msAfter
;

Event_Global_Maximum
/SIGNAL_TYPES=DERIVED
/SIGNAL_NAMES=Pitching_Shoulder_Ang_Vel_plot_neg
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=MaxShoulderVel
/SELECT_X=TRUE
! /SELECT_Y=FALSE
!/SELECT_Z=FALSE
/START_AT_EVENT=SETUP
/END_AT_EVENT=Release100msAfter
;

! Time from Peak Pelvis angular velocity to Peak Torso angular velocity
Evaluate_Expression
/EXPRESSION=EVENT_LABEL::ORIGINAL::MaxThoraxVel - EVENT_LABEL::ORIGINAL::MaxPelvisVel
! /SIGNAL_TYPES=
! /SIGNAL_FOLDER=ORIGINAL
! /SIGNAL_NAMES=
/RESULT_TYPES=METRIC
! /RESULT_FOLDERS=PROCESSED
/RESULT_NAME=time_MaxPelvisVel_MaxThoraxVel
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
;

! Filter Pelvis_AngAcc and Thorax_Ang_Acc and Pitching_Humerus_Ang_Acc
Lowpass_Filter
/SIGNAL_TYPES=LINK_MODEL_BASED
! /SIGNAL_FOLDER=ORIGINAL
/SIGNAL_NAMES=Pelvis_Ang_Acc+Thorax_Ang_Acc+Pitching_Humerus_Ang_Acc
! /RESULT_FOLDER=PROCESSED
! /RESULT_SUFFIX=
! /FILTER_CLASS=BUTTERWORTH
/FREQUENCY_CUTOFF=10
! /NUM_REFLECTED=6
! /NUM_EXTRAPOLATED=0
! /TOTAL_BUFFER_SIZE=6
! /NUM_BIDIRECTIONAL_PASSES=1
;

! Calculate pelvis rotation stop
! This is tricky since most pitchers will not completely stop. Ang velocity may not be estimated correctly. The zero crossing may be after release.
! Tried Pelvis angular acceleration peak minimum acceleration (which occurs after peak angular velocity) but that is too early.
! Using the unfiltered Pelvis_Ang_Vel to make sure the zero crossing is not eliminated
Event_Threshold
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_NAMES=Pelvis_Ang_Vel
/SIGNAL_FOLDER=ORIGINAL
/EVENT_NAME=PelvisRot_Stop
! /SELECT_X=FALSE
!/SELECT_Y=FALSE
/SELECT_Z=TRUE
! /SELECT_RESIDUAL=FALSE
/THRESHOLD=0
! /FRAME_WINDOW=8
! /FRAME_OFFSET=0
!/ASCENDING=FALSE
/DESCENDING=TRUE
! /ENSURE_RANGE_FRAMES_BEFORE_THRESHOLD_CROSSING=FALSE
!/ENSURE_RANGE_FRAMES_AFTER_THRESHOLD_CROSSING=FALSE
/START_AT_EVENT=MaxPelvisVel
!/END_AT_EVENT=
/EVENT_INSTANCE=1
;

Event_Global_Maximum
/RESULT_EVENT_NAME=Max_Elbow_Flex
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=ORIGINAL
/SIGNAL_NAMES=Pitching_Elbow_Angle
/SIGNAL_COMPONENTS=X
! /FRAME_OFFSET=0
! /TIME_OFFSET=
/EVENT_SEQUENCE=Footstrike+Release100msAfter
! /EXCLUDE_EVENTS=
! /EVENT_SEQUENCE_INSTANCE=0
! /EVENT_SUBSEQUENCE=
! /SUBSEQUENCE_EXCLUDE_EVENTS=
! /EVENT_SUBSEQUENCE_INSTANCE=0
! /THRESHOLD=
;

Event_Global_Maximum
/RESULT_EVENT_NAME=Max_Elbow_Flex_Ang_Vel
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Pitching_Elbow_Ang_Vel
/SIGNAL_COMPONENTS=X
! /FRAME_OFFSET=0
! /TIME_OFFSET=
/EVENT_SEQUENCE=Footstrike+Release100msAfter
! /EXCLUDE_EVENTS=
! /EVENT_SEQUENCE_INSTANCE=0
! /EVENT_SUBSEQUENCE=
! /SUBSEQUENCE_EXCLUDE_EVENTS=
! /EVENT_SUBSEQUENCE_INSTANCE=0
! /THRESHOLD=
;

Event_Global_Maximum
/RESULT_EVENT_NAME=Max_Forearm_PronSup
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=ORIGINAL
/SIGNAL_NAMES=Pitching_Elbow_Angle
/SIGNAL_COMPONENTS=Z
! /FRAME_OFFSET=0
! /TIME_OFFSET=
/EVENT_SEQUENCE=Footstrike+Release100msAfter
! /EXCLUDE_EVENTS=
! /EVENT_SEQUENCE_INSTANCE=0
! /EVENT_SUBSEQUENCE=
! /SUBSEQUENCE_EXCLUDE_EVENTS=
! /EVENT_SUBSEQUENCE_INSTANCE=0
! /THRESHOLD=
;

Event_Global_Maximum
/RESULT_EVENT_NAME=Max_Forearm_PronSup_Ang_Vel
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Pitching_Elbow_Ang_Vel
/SIGNAL_COMPONENTS=Z
! /FRAME_OFFSET=0
! /TIME_OFFSET=
/EVENT_SEQUENCE=Footstrike+Release100msAfter
! /EXCLUDE_EVENTS=
! /EVENT_SEQUENCE_INSTANCE=0
! /EVENT_SUBSEQUENCE=
! /SUBSEQUENCE_EXCLUDE_EVENTS=
! /EVENT_SUBSEQUENCE_INSTANCE=0
! /THRESHOLD=
;

! Generate event at max/min values so that tick can be added to graphs
Event_Global_Minimum
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_NAMES=Pitching_Shoulder_Angle
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=MIN_HORIZ_SHOULDER_ABD
/SELECT_X=TRUE
! /SELECT_Y=FALSE
! /SELECT_Z=FALSE
/START_AT_EVENT=SETUP
/END_AT_EVENT=Release
;

! Pelvis and Trunk max linear velocity
Event_Global_Maximum
/RESULT_EVENT_NAME=MaxTrunkLinearVel
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Trunk_COG_Vel
/SIGNAL_COMPONENTS=Y
! /FRAME_OFFSET=0
! /TIME_OFFSET=
! /EVENT_SEQUENCE=
! /EXCLUDE_EVENTS=
! /EVENT_SEQUENCE_INSTANCE=0
! /EVENT_SUBSEQUENCE=
! /SUBSEQUENCE_EXCLUDE_EVENTS=
! /EVENT_SUBSEQUENCE_INSTANCE=0
/END_AT_EVENT=Release
! /THRESHOLD=
;

Event_Global_Maximum
/RESULT_EVENT_NAME=MaxPelvisLinearVel
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=ORIGINAL
/SIGNAL_NAMES=Pelvis_COG_Vel
! /SIGNAL_COMPONENTS=
! /FRAME_OFFSET=0
! /TIME_OFFSET=
! /EVENT_SEQUENCE=
! /EXCLUDE_EVENTS=
! /EVENT_SEQUENCE_INSTANCE=0
! /EVENT_SUBSEQUENCE=
! /SUBSEQUENCE_EXCLUDE_EVENTS=
! /EVENT_SUBSEQUENCE_INSTANCE=0
/SELECT_Y=TRUE
/END_AT_EVENT=Release
! /THRESHOLD=
;

! Add event at max horizontal arm adduction
Event_Global_Maximum
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_NAMES=Pitching_Shoulder_Angle
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=MaxShoulderHorAngle
/SELECT_X=TRUE
! /SELECT_Y=FALSE
! /SELECT_Z=FALSE
/START_AT_EVENT=SETUP
/END_AT_EVENT=Release100msAfter
;

! Create incremental events and get metrics in those events
Set_Pipeline_Parameter_To_List_Of_Tagged_Files
/PARAMETER_NAME=files
/TAG_NAME=Pitch
! /GET_CURRENT_SELECTED_FILES=false
! /USE_SHORT_FILENAMES=false
;

For_Each
/ITERATION_PARAMETER_NAME=file
!/ITERATION_PARAMETER_COUNT_NAME=
/ITEMS=::files
;

	Select_Active_File
	/FILE_NAME=::file
	! /QUERY=
	;

	! Create events between footstrike and release at 10 ms increments and get metrics in those events
	Conditional_Statement
	/ITERATION_PARAMETER_NAME=cond
	/EXPRESSION=(Data_Exists(EVENT_LABEL::ORIGINAL::Footstrike) &::AMP& Data_Exists(EVENT_LABEL::ORIGINAL::Release))
	! /AS_INTEGER=TRUE
	;

		Set_Pipeline_Parameter_From_For_Loop
		/PARAMETER_NAME=ev_increments
		/PARAMETER_INDEX_START=EVENT_LABEL::ORIGINAL::Footstrike + 0.01
		/PARAMETER_INDEX_END=EVENT_LABEL::ORIGINAL::Release
		/PARAMETER_INDEX_STEP=0.01
		/PARAMETER_INDEX_TYPE=FLOAT
		;

		For_Each
		/ITERATION_PARAMETER_NAME=ev
		/ITERATION_PARAMETER_COUNT_NAME=inc
		/ITEMS=::ev_increments
		;

			Get_Pipeline_Parameter_Index_Value
			/PARAMETER_NAME=my_event
			/PARAMETER_VALUE=::ev_increments
			/INDEX=::inc
			;

			Event_Explicit
			/EVENT_NAME=Footstrike_&::inc&0ms
			! /FRAME=
			/TIME=::my_event
			;

			Metric_Signal_Value_At_Event
			/SIGNAL_TYPES=LINK_MODEL_BASED+LINK_MODEL_BASED+LINK_MODEL_BASED
			/SIGNAL_FOLDER=ORIGINAL+PROCESSED+ORIGINAL
			/SIGNAL_NAMES=Hip Shoulders Sep+Pitching_Shoulder_Angle+Pitching_Humerus_Ang_Vel
			/RESULT_METRIC_FOLDER=INCREMENT
			/RESULT_METRIC_NAME=@Footstrike_&::inc&0ms
			/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
			! /SIGNAL_COMPONENTS=
			! /COMPONENT_SEQUENCE=
			/EVENT_NAME=Footstrike_&::inc&0ms
			! /EVENT_INSTANCE=0
			/GENERATE_MEAN_AND_STDDEV=FALSE
			! /APPEND_TO_EXISTING_VALUES=FALSE
			! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
			! /RETAIN_NO_DATA_VALUES=FALSE
			;

		End_For_Each
		/ITERATION_PARAMETER_NAME=ev
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=cond
	;

	! Create events between max knee height and release + 100 ms at 100 ms increments and get metrics in those events for Velocities and Accelerations of the Pelvis (z axis), Trunk (z axis), and Arm (z and y) 
	! Note metric@Release nad Release+100ms already exist
	Conditional_Statement
	/ITERATION_PARAMETER_NAME=cond
	/EXPRESSION=(Data_Exists(EVENT_LABEL::ORIGINAL::MaxKneeHeight) &::AMP& Data_Exists(EVENT_LABEL::ORIGINAL::Release100msBefore))
	! /AS_INTEGER=TRUE
	;

		Set_Pipeline_Parameter_From_For_Loop
		/PARAMETER_NAME=ev_increments
		/PARAMETER_INDEX_START=EVENT_LABEL::ORIGINAL::MaxKneeHeight + 0.1
		/PARAMETER_INDEX_END=EVENT_LABEL::ORIGINAL::Release - 0.1
		/PARAMETER_INDEX_STEP=0.1
		/PARAMETER_INDEX_TYPE=FLOAT
		;

		For_Each
		/ITERATION_PARAMETER_NAME=ev
		/ITERATION_PARAMETER_COUNT_NAME=inc
		/ITEMS=::ev_increments
		;

			Get_Pipeline_Parameter_Index_Value
			/PARAMETER_NAME=my_event
			/PARAMETER_VALUE=::ev_increments
			/INDEX=::inc
			;

			Event_Explicit
			/EVENT_NAME=MaxKneeHeight_&::inc&00ms
			! /FRAME=
			/TIME=::my_event
			;

			Metric_Signal_Value_At_Event
			/SIGNAL_TYPES=LINK_MODEL_BASED
			/SIGNAL_FOLDER=PROCESSED
			/SIGNAL_NAMES=Pelvis_Ang_Acc+Pelvis_Ang_Vel+Pitching_Humerus_Ang_Vel+Pitching_Humerus_Ang_Acc+Thorax_Ang_Vel+Thorax_Ang_Acc
			/RESULT_METRIC_FOLDER=INCREMENT
			/RESULT_METRIC_NAME=@MaxKneeHeight_&::inc&00ms
			/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
			! /SIGNAL_COMPONENTS=
			! /COMPONENT_SEQUENCE=
			/EVENT_NAME=MaxKneeHeight_&::inc&00ms
			! /EVENT_INSTANCE=0
			/GENERATE_MEAN_AND_STDDEV=FALSE
			! /APPEND_TO_EXISTING_VALUES=FALSE
			! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
			! /RETAIN_NO_DATA_VALUES=FALSE
			;

		End_For_Each
		/ITERATION_PARAMETER_NAME=ev
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=cond
	;

	! Create events between max knee height and footstrike at 75 ms increments and get metrics in those events
	Conditional_Statement
	/ITERATION_PARAMETER_NAME=cond
	/EXPRESSION=(Data_Exists(EVENT_LABEL::ORIGINAL::MaxKneeHeight) &::AMP& Data_Exists(EVENT_LABEL::ORIGINAL::Footstrike))
	! /AS_INTEGER=TRUE
	;

		Set_Pipeline_Parameter_To_List_Of_Tagged_Files
		/PARAMETER_NAME=files
		/TAG_NAME=Pitch
		! /GET_CURRENT_SELECTED_FILES=false
		! /USE_SHORT_FILENAMES=false
		;
	
		Set_Pipeline_Parameter_From_For_Loop
		/PARAMETER_NAME=ev_increments
		/PARAMETER_INDEX_START=EVENT_LABEL::ORIGINAL::MaxKneeHeight + 0.075
		/PARAMETER_INDEX_END=EVENT_LABEL::ORIGINAL::Footstrike
		/PARAMETER_INDEX_STEP=0.075
		/PARAMETER_INDEX_TYPE=FLOAT
		;

		Get_Pipeline_Parameter_Count
		/PARAMETER_NAME=ev_count
		/PARAMETER_VALUE=::ev_increments
		;
		
		Set_Pipeline_Parameter_From_For_Loop
		/PARAMETER_NAME=time_increments
		/PARAMETER_INDEX_START=0.075
		/PARAMETER_INDEX_END=&::ev_count& * 0.075
		/PARAMETER_INDEX_STEP=0.075
		/PARAMETER_INDEX_TYPE=FLOAT
		;

		Set_Pipeline_Parameter
		/PARAMETER_NAME=time_increments
		/PARAMETER_VALUE=::time_increments
		/PARAMETER_VALUE_SEARCH_FOR=000+
		/PARAMETER_VALUE_REPLACE_WITH=+
		! /PARAMETER_VALUE_PREFIX=
		! /PARAMETER_VALUE_APPEND=
		! /MULTI_PASS=FALSE
		;

		For_Each
		/ITERATION_PARAMETER_NAME=ev
		/ITERATION_PARAMETER_COUNT_NAME=inc
		/ITEMS=::ev_increments
		;

			Get_Pipeline_Parameter_Index_Value
			/PARAMETER_NAME=my_event
			/PARAMETER_VALUE=::ev_increments
			/INDEX=::inc
			;
			
			Get_Pipeline_Parameter_Index_Value
			/PARAMETER_NAME=my_time
			/PARAMETER_VALUE=::time_increments
			/INDEX=::inc
			;

			Event_Explicit
			/EVENT_NAME=MaxKneeHeight_&::my_time&ms
			! /FRAME=
			/TIME=::my_event
			;

			Metric_Signal_Value_At_Event
			/SIGNAL_TYPES=LINK_MODEL_BASED
			/SIGNAL_FOLDER=ORIGINAL
			/SIGNAL_NAMES=Pelvis_Angle+Trunk_Angle+Hip Shoulders Sep
			/RESULT_METRIC_FOLDER=INCREMENT
			/RESULT_METRIC_NAME=@MaxKneeHeight_&::my_time&ms
			/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
			! /SIGNAL_COMPONENTS=
			! /COMPONENT_SEQUENCE=
			/EVENT_NAME=MaxKneeHeight_&::my_time&ms
			! /EVENT_INSTANCE=0
			/GENERATE_MEAN_AND_STDDEV=FALSE
			! /APPEND_TO_EXISTING_VALUES=FALSE
			! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
			! /RETAIN_NO_DATA_VALUES=FALSE
			;

		End_For_Each
		/ITERATION_PARAMETER_NAME=ev
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=cond
	;

End_For_Each
/ITERATION_PARAMETER_NAME=file
;

Select_Active_File
/FILE_NAME=Pitch
! /QUERY=
;

! Generate Plotstart events to ensure correct alignment of the trials based on mean event times (used by 8 cylinder web report)
For_Each
/ITERATION_PARAMETER_NAME=eventName
! /ITERATION_PARAMETER_COUNT_NAME=
/ITEMS=SETUP+MaxKneeHeight+Footstrike
;

	Evaluate_Expression
	/EXPRESSION=EVENT_LABEL::ORIGINAL::Release100msAfter - EVENT_LABEL::ORIGINAL::&::eventName
	/RESULT_NAME=PLOTSTART_&::eventName&_OFFSET
	/RESULT_TYPE=METRIC
	/RESULT_FOLDER=EVENTS
	;

	Metric_Mean
	/RESULT_METRIC_FOLDER=EVENTS
	/RESULT_METRIC_NAME=PLOTSTART_&::eventName&_OFFSET_MEAN
	!/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	/SIGNAL_TYPES=METRIC
	/SIGNAL_FOLDER=EVENTS
	/SIGNAL_NAMES=PLOTSTART_&::eventName&_OFFSET
	! /COMPONENT_SEQUENCE=
	/EVENT_SEQUENCE=
	/EXCLUDE_EVENTS=
	/GENERATE_MEAN_AND_STDDEV=TRUE
	! /APPEND_TO_EXISTING_VALUES=FALSE
	;

	! In case subtracting average plotstart would result in negative value (can happen if trials have very different length), we place plotstart at first frame and trials are not plotted in synch if x axis is set to time
	Event_Explicit
	/EVENT_NAME=PLOTSTART_&::eventName
	! /FRAME=
	/TIME=((EVENT_LABEL::ORIGINAL::Release100msAfter - GLOBAL::METRIC::EVENTS::PLOTSTART_&::eventName&_OFFSET_MEAN_MEAN) < 0) * (1/PARAMETERS::POINT::RATE) + ((EVENT_LABEL::ORIGINAL::Release100msAfter - GLOBAL::METRIC::EVENTS::PLOTSTART_&::eventName&_OFFSET_MEAN_MEAN) => 0) * (EVENT_LABEL::ORIGINAL::Release100msAfter - GLOBAL::METRIC::EVENTS::PLOTSTART_&::eventName&_OFFSET_MEAN_MEAN)
	;

End_For_Each
/ITERATION_PARAMETER_NAME=eventName
;

Select_Active_File
/FILE_NAME=Static
! /QUERY=
;

Event_Explicit
/EVENT_NAME=PLOTSTART_SETUP
/FRAME=1
! /TIME=
;

Event_Explicit
/EVENT_NAME=Release100msAfter
/FRAME=EOF
! /TIME=
;

Select_Active_File
/FILE_NAME=Pitch
! /QUERY=
;

! Create plotstart and plotend events based on settings.php
 

Event_Copy
/EVENT_NAME=PLOTSTART_SETUP 
/NEW_EVENT_NAME=PLOTSTART
! /EVENT_INSTANCE=0
! /RANGE_INSTANCE=0
! /EVENT_SEQUENCE=
! /EXCLUDE_EVENTS=
! /START_AT_EVENT=
! /END_AT_EVENT=
 /FRAME_OFFSET=0
! /TIME_OFFSET=
! /PERCENT_OFFSET=
;

Event_Copy
/EVENT_NAME=Release100msAfter 
/NEW_EVENT_NAME=PLOTEND
! /EVENT_INSTANCE=0
! /RANGE_INSTANCE=0
! /EVENT_SEQUENCE=
! /EXCLUDE_EVENTS=
! /START_AT_EVENT=
! /END_AT_EVENT=
 /FRAME_OFFSET=0
! /TIME_OFFSET=
! /PERCENT_OFFSET=
;

!Modify x-axis based on event used
Modify_All_Graphs
! /PAGE_NO=
/Y_MODIFY_RANGE=FALSE
! /Y_USE_AUTO_RANGE=TRUE
! /Y_MIN_BUFFER=
! /Y_MAX_BUFFER=
! /Y_MIN=
! /Y_MAX=
! /Y_SCALE_INCREMENT=
! /Y_AXIS_LABEL=
/X_AXIS_LABEL=Time (%, Setup to Release+100ms)
;

 

!Add logo to title page
Make_Image_Item
/IMAGE_FILE=H:\Pitching\Templates\Assets/Pictures/&::title_page_picture
/PAGE_NUMBER=1
/COLUMN_NUMBER=1
/ROW_NUMBER=1
! /COLUMN_SPAN=1
! /ROW_SPAN=1
;

!================================================================
! Add reference values from settings.php to report
!================================================================
Select_Active_File
/FILE_NAME=GLOBAL
;

 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Stride_length_normal
	/TEXT_DATA=68 - 74 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Shoulder_horizontal_abduction_normal
	/TEXT_DATA=-10 - -23 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Shoulder_external_rotation_normal
	/TEXT_DATA=150 - 166 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Shoulder_internal_rotation_ang_vel_normal
	/TEXT_DATA=4806 - 5834 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Elbow_angle_footstrike_normal
	/TEXT_DATA=81 - 116 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Elbow_angle_release_normal
	/TEXT_DATA=37 - 63 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Lead_knee_angle_footstrike_normal
	/TEXT_DATA=39 - 69 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Lead_knee_angle_release_normal
	/TEXT_DATA=37 - 63 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Stride_length_MLB
	/TEXT_DATA=69 - 79 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Shoulder_horizontal_abduction_MLB
	/TEXT_DATA=5 - 29 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Shoulder_external_rotation_MLB
	/TEXT_DATA=163 - 183 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Shoulder_internal_rotation_ang_vel_MLB
	/TEXT_DATA=6190 - 8910 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Elbow_angle_footstrike_MLB
	/TEXT_DATA=62 - 100 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Elbow_angle_release_MLB
	/TEXT_DATA=16 - 28 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Lead_knee_angle_footstrike_MLB
	/TEXT_DATA=40 - 62 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 
	Create_Text_Data
	/SIGNAL_FOLDER=Norms
	/SIGNAL_NAMES=Lead_knee_angle_release_MLB
	/TEXT_DATA=16 - 28 
	! /TEXT_FILE_NAME=
	! /PROMPT_ON_EMPTY=TRUE
	;
 

Set_Text_Item
/SIGNAL_NAME=Name
/SIGNAL_FOLDER=META
/SIGNAL_DATA_VALUE=Doe, John 
;

Set_Text_Item
/SIGNAL_NAME=Age
/SIGNAL_FOLDER=META
/SIGNAL_DATA_VALUE=25 
;

Set_Text_Item
/SIGNAL_NAME=Weight
/SIGNAL_FOLDER=META
/SIGNAL_DATA_VALUE=200 
;

Set_Text_Item
/SIGNAL_NAME=Date
/SIGNAL_FOLDER=META
/SIGNAL_DATA_VALUE=11/04/2025 
;

Set_Text_Item
/SIGNAL_NAME=Height
/SIGNAL_FOLDER=META
/SIGNAL_DATA_VALUE=75 
;

Set_Text_Item
/SIGNAL_NAME=ThrowingArm
/SIGNAL_FOLDER=META
/SIGNAL_DATA_VALUE=::THROW_SIDE_NAME
;

Set_Text_Item
/SIGNAL_NAME=Injuryhistory
/SIGNAL_FOLDER=META
 
	/SIGNAL_DATA_VALUE=.
 
;

Set_Text_Item
/SIGNAL_NAME=breaking_ball_heading
/SIGNAL_FOLDER=META
/SIGNAL_DATA_VALUE=Breaking Ball 
;

Set_Text_Item
/SIGNAL_NAME=off_speed_heading
/SIGNAL_FOLDER=META
/SIGNAL_DATA_VALUE=Off Speed 
;

! Timming table
!-------------------------
! Zero for timming is set as an option in settings.php. All other time diferences are calculated relative to it
For_Each
/ITERATION_PARAMETER_NAME=FILE_TAG
/ITEMS=FastBall+Pitch 
;

	Select_Active_File
	 /FILE_NAME=::FILE_TAG
	 ! /QUERY=
	;
		
	For_Each
	/ITERATION_PARAMETER_NAME=signame
	! /ITERATION_PARAMETER_COUNT_NAME=
	/ITEMS=Setup+MaxKneeHeight+Footstrike+Max_Shoulder_Rot+Max_Shoulder_Int_Rot+Release+MaxPelvisLinearVel+MaxTrunkLinearVel+MaxShoulderHorAngle+MaxPelvisVel+MaxThoraxVel+MaxHumerusVel+MaxHandVel+PelvisRot_Stop+Max_Elbow_Flex+Max_Elbow_Flex_Ang_Vel+Max_Forearm_PronSup+Max_Forearm_PronSup_Ang_Vel+MaxElbowVel+MaxShoulderVel
	;

		Evaluate_Expression
		/EXPRESSION=EVENT_LABEL::ORIGINAL::&::signame& - EVENT_LABEL::ORIGINAL::Setup 
		/RESULT_NAME=&::signame&Time
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=TIMING
		;

		Evaluate_Expression
		/EXPRESSION=1000 * (EVENT_LABEL::ORIGINAL::&::signame& - EVENT_LABEL::ORIGINAL::Setup)
		/RESULT_NAME=&::signame&Time_ms
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=TIMING
		;

		!Calculate mean and copy to GLOBAL
		Metric_Mean
		 /RESULT_METRIC_NAME=GLOBAL::&::signame&Time_ms
		 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
		 /RESULT_METRIC_FOLDER=::FILE_TAG
		 /SIGNAL_TYPES=METRIC
		 /SIGNAL_NAMES=&::signame&Time_ms
		 /SIGNAL_FOLDER=Timing
		 /SIGNAL_COMPONENTS=0
		 /EVENT_SEQUENCE=
		 /EXCLUDE_EVENTS=
		 /GENERATE_MEAN_AND_STDDEV=FALSE
		 /APPEND_TO_EXISTING_VALUES=TRUE
		;
	
	End_For_Each
	/ITERATION_PARAMETER_NAME=signame
	;
	
End_For_Each
/ITERATION_PARAMETER_NAME=FILE_TAG
;

!================================================================
! Page 3 delivery at glance
!================================================================

! Create screenshots
Select_Active_File
/FILE_NAME=Pitch
!/QUERY=
;

Transform_Data_Coordinate_System
/SIGNAL_TYPES=KINETIC_KINEMATIC
/SIGNAL_FOLDER=RTA
/SIGNAL_NAMES=CGPos
! /FROM_SEGMENT_CS=LAB
/TO_SEGMENT_CS=Virtual Lab
/RESULT_TYPES=DERIVED
/RESULT_FOLDERS=PROCESSED
/RESULT_NAME=_RTA_VLab
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
! /ORIENTATION_ONLY=FALSE
! /USE_DATA_RATE=FALSE
;

Evaluate_Expression
/EXPRESSION=-1.0*DERIVED::PROCESSED::CGPos_RTA_VLab::X
/RESULT_NAME=CAMX
! /RESULT_TYPE=DERIVED
! /RESULT_FOLDER=PROCESSED
;

Evaluate_Expression
/EXPRESSION=-1.0*DERIVED::PROCESSED::CGPos_RTA_VLab::Y
/RESULT_NAME=CAMY
! /RESULT_TYPE=DERIVED
! /RESULT_FOLDER=PROCESSED
;

Evaluate_Expression
/EXPRESSION=-1.0*DERIVED::PROCESSED::CGPos_RTA_VLab::Z
/RESULT_NAME=CAMZ
! /RESULT_TYPE=DERIVED
! /RESULT_FOLDER=PROCESSED
;

!Loop through events
For_Each
/ITERATION_PARAMETER_NAME=EVENT
/ITEMS=Setup+MaxKneeHeight+Footstrike+Max_Shoulder_Rot+Release
;

	Metric_Signal_Value_At_Event
	 /RESULT_METRIC_NAME=CAMERA_AT_&::event&_X
	 ! /RESULT_METRIC_FOLDER=PROCESSED
	 /SIGNAL_TYPES=DERIVED
	 /SIGNAL_NAMES=CAMX
	 /SIGNAL_FOLDER=PROCESSED
	 /EVENT_NAME=::event
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 ! /APPEND_TO_EXISTING_VALUES=FALSE
	 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
	 ! /RETAIN_NO_DATA_VALUES=FALSE
	;

	Metric_Signal_Value_At_Event
	 /RESULT_METRIC_NAME=CAMERA_AT_&::event&_Y
	 ! /RESULT_METRIC_FOLDER=PROCESSED
	 /SIGNAL_TYPES=DERIVED
	 /SIGNAL_NAMES=CAMY
	 /SIGNAL_FOLDER=PROCESSED
	 /EVENT_NAME=::event
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 ! /APPEND_TO_EXISTING_VALUES=FALSE
	 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
	 ! /RETAIN_NO_DATA_VALUES=FALSE
	;

	Metric_Signal_Value_At_Event
	 /RESULT_METRIC_NAME=CAMERA_AT_&::event&_Z
	 ! /RESULT_METRIC_FOLDER=PROCESSED
	 /SIGNAL_TYPES=DERIVED
	 /SIGNAL_NAMES=CAMZ
	 /SIGNAL_FOLDER=PROCESSED
	 /EVENT_NAME=::event
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 ! /APPEND_TO_EXISTING_VALUES=FALSE
	 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
	 ! /RETAIN_NO_DATA_VALUES=FALSE
	;

End_For_Each
/ITERATION_PARAMETER_NAME=EVENT
;

Set_View_Options
! /VIEW_GRAPH_ANIMATION_FRAME_LINE=
/VIEW_FORCE_PLATFORMS=FALSE
! /VIEW_GRF_BUTTERFLY=
/VIEW_GRF=FALSE
/VIEW_GRF_COFP=FALSE
/VIEW_CUSTOM_FORCES=FALSE
! /VIEW_JOINTS=
/VIEW_LAB=FALSE
/VIEW_LAB_AXES=FALSE
/VIEW_LANDMARKS=FALSE
/VIEW_MODEL_COM=FALSE
! /VIEW_MUSCLES=
! /VIEW_MUSCLES_AS_LINES=
! /VIEW_MUSCLES_AS_CYLINDERS=
/VIEW_SCS_AXES=FALSE
! /VIEW_SCS_AXES_COM=
/VIEW_SEGMENTS=TRUE
/VIEW_KINEMATIC_ONLY_SEGMENTS=TRUE
! /VIEW_SEGMENT_COLORIZATION=
/VIEW_SEGMENT_GEOMETRY=FALSE
/VIEW_SEGMENT_LINES=FALSE
/VIEW_TARGETS=FALSE
! /VIEW_TARGETS_WITH_RESIDUAL_COLORMAP=
/VIEW_COM_TRAIL=FALSE
! /VIEW_LANDMARK_TRAIL=
! /VIEW_SEGMENT_TRAIL=
! /VIEW_TARGET_TRAIL=
/VIEW_WHITE_BACKGROUND=TRUE
/SET_BACKGROUND_COLOR=1+1+1
;

! Switch_to_Report_Mode
! ! /SHOW_ANIMATION=FALSE
! ! /PAGE_NUMBER=
! ;

!Define a counter that will be used to loop through rows
Metric_Explicit
/RESULT_METRIC_NAME=GLOBAL::ROW_COUNTER
! /RESULT_METRIC_FOLDER=PROCESSED
/METRIC_VALUE=2
;

Select_Active_File
 /FILE_NAME=GLOBAL
 ! /QUERY=
;

Set_Pipeline_Parameter_To_Data_Value
 /PARAMETER_NAME=ROW
 /SIGNAL_TYPES=METRIC
 /SIGNAL_NAMES=ROW_COUNTER
 /SIGNAL_FOLDER=PROCESSED
 ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
;

!Define a counter that will be used to loop through columns
Metric_Explicit
 /RESULT_METRIC_NAME=GLOBAL::COLUMN_COUNTER
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /METRIC_VALUE=1
;

!Loop through events
For_Each
 /ITERATION_PARAMETER_NAME=EVENT
 /ITEMS=Setup+MaxKneeHeight+Footstrike+Max_Shoulder_Rot+Release
;

	!Loop through files
	For_Each
	  /ITERATION_PARAMETER_NAME=CurFile
	  /ITEMS=::files
	;

		Set_Pipeline_Parameter
		   /PARAMETER_NAME=imageFile
		   /PARAMETER_VALUE=::CurFile
		   /PARAMETER_VALUE_SEARCH_FOR=.c3d
		   /PARAMETER_VALUE_REPLACE_WITH=_
		   ! /PARAMETER_VALUE_PREFIX=
		   ! /PARAMETER_VALUE_APPEND=
		;

		Select_Active_File
		   /FILE_NAME=GLOBAL
		   ! /QUERY=
		;

		Set_Pipeline_Parameter_To_Data_Value
		   /PARAMETER_NAME=COLUMN
		   /SIGNAL_TYPES=METRIC
		   /SIGNAL_NAMES=COLUMN_COUNTER
		   /SIGNAL_FOLDER=PROCESSED
		   ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
		;

		Select_Active_File
		   /FILE_NAME=::CurFile
		   ! /QUERY=
		;

		Set_Pipeline_Parameter_To_Data_Value
		   /PARAMETER_NAME=CAMERA_X
		   /SIGNAL_TYPES=METRIC
		   /SIGNAL_NAMES=CAMERA_AT_&::EVENT&_X
		   /SIGNAL_FOLDER=PROCESSED
		   ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
		;

		Set_Pipeline_Parameter_To_Data_Value
		   /PARAMETER_NAME=CAMERA_Y
		   /SIGNAL_TYPES=METRIC
		   /SIGNAL_NAMES=CAMERA_AT_&::EVENT&_Y
		   /SIGNAL_FOLDER=PROCESSED
		   ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
		;

		Set_Pipeline_Parameter_To_Data_Value
		   /PARAMETER_NAME=CAMERA_Z
		   /SIGNAL_TYPES=METRIC
		   /SIGNAL_NAMES=CAMERA_AT_&::EVENT&_Z
		   /SIGNAL_FOLDER=PROCESSED
		   ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
		;
		
		!Flip camera view based on L frame orientation
		Conditional_Statement
		/ITERATION_PARAMETER_NAME=cond
		/EXPRESSION=("&::THROW_SIDE_NAME&" = "LEFT")
		! /AS_INTEGER=TRUE
		;

			Set_Pipeline_Parameter_From_Expression
			/PARAMETER_NAME=CAMERA_SAGITTAL
			/EXPRESSION=((METRIC::VIRTUAL_LAB::LAB_LATERAL::Y = 1) * 180 + (METRIC::VIRTUAL_LAB::LAB_LATERAL::X = 1) * 270 + (METRIC::VIRTUAL_LAB::LAB_LATERAL::Y = -1) * 0 + (METRIC::VIRTUAL_LAB::LAB_LATERAL::X = -1) * 90)
			! /AS_INTEGER=TRUE
			;

		Conditional_Statement_End
		/ITERATION_PARAMETER_NAME=cond
		;

		Conditional_Statement
		/ITERATION_PARAMETER_NAME=cond
		/EXPRESSION=("&::THROW_SIDE_NAME&" = "RIGHT")
		! /AS_INTEGER=TRUE
		;

			Set_Pipeline_Parameter_From_Expression
			/PARAMETER_NAME=CAMERA_SAGITTAL
			/EXPRESSION=((METRIC::VIRTUAL_LAB::LAB_LATERAL::Y = 1) * 180 + (METRIC::VIRTUAL_LAB::LAB_LATERAL::X = 1) * 90 + (METRIC::VIRTUAL_LAB::LAB_LATERAL::Y = -1) * 0 + (METRIC::VIRTUAL_LAB::LAB_LATERAL::X = -1) * 270)
			! /AS_INTEGER=TRUE
			;

		Conditional_Statement_End
		/ITERATION_PARAMETER_NAME=cond
		;

		Set_Camera_Perspective
		   /USE_STATIONARY_CAMERA=FALSE
		   /TRACK_CAMERA_USING_SEGMENT_COM=TRUE
		   /SEGMENT=RPV
		   /CAMERA_X_CENTER=::CAMERA_X
		   /CAMERA_Y_CENTER=::CAMERA_Y
		   /CAMERA_Z_CENTER=::CAMERA_Z
		   /CAMERA_ZOOM=2.0
		   /CAMERA_PAN=::CAMERA_SAGITTAL
		   /CAMERA_TILT=0.0
		;

		Export_3D_Animation_To_Image
		   /FILE_NAME=::CurFile
		   /IMAGE_FILE_NAME=::imageFile&::EVENT&.png
		   ! /APPEND_FRAME_TO_FILENAME=FALSE
		   ! /APPEND_C3DNAME_TO_FILENAME=FALSE
		   ! /IMAGE_FORMAT=png
		   /START_FRAME=::EVENT
		   ! /END_FRAME=
		   ! /EVENT_SEQUENCE=
		   ! /EXCLUDE_EVENTS=
		   ! /OUTPUT_WIDTH=640
		   ! /OUTPUT_HEIGHT=480
		;

		Make_Image_Item
		   /IMAGE_FILE=::imageFile&::EVENT&.png
		   /PAGE_NUMBER=::delivery_at_glance_page_number
		   /COLUMN_NUMBER=::COLUMN
		   /ROW_NUMBER=::ROW
		   ! /COLUMN_SPAN=1
		   ! /ROW_SPAN=1
		;

		Select_Active_File
		  /FILE_NAME=GLOBAL
		  ! /QUERY=
		;

		!increase the row counter by 1
		Add_Constant_To_Signals
		 /SIGNAL_TYPES=METRIC
		 /SIGNAL_NAMES=ROW_COUNTER
		 /SIGNAL_FOLDER=PROCESSED
		 ! /RESULT_NAMES=
		 ! /RESULT_TYPES=
		 ! /RESULT_FOLDER=PROCESSED
		 ! /RESULT_SUFFIX=
		 ! /SIGNAL_COMPONENTS=
		 /CONSTANT=1
		;

		Set_Pipeline_Parameter_To_Data_Value
		 /PARAMETER_NAME=ROW
		 /SIGNAL_TYPES=METRIC
		 /SIGNAL_NAMES=ROW_COUNTER
		 /SIGNAL_FOLDER=PROCESSED
		 ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
		;

	End_For_Each
	  /ITERATION_PARAMETER_NAME=CurFile
	;

	Select_Active_File
	  /FILE_NAME=GLOBAL
	  ! /QUERY=
	;

	!Reset a counter that will be used to loop through rows
	Metric_Explicit
	 /RESULT_METRIC_NAME=GLOBAL::ROW_COUNTER
	 ! /RESULT_METRIC_FOLDER=PROCESSED
	 /METRIC_VALUE=2
	;

	Set_Pipeline_Parameter_To_Data_Value
	 /PARAMETER_NAME=ROW
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=ROW_COUNTER
	 /SIGNAL_FOLDER=PROCESSED
	 ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
	;

	!increase the column counter by 1
	Add_Constant_To_Signals
	  /SIGNAL_TYPES=METRIC
	  /SIGNAL_NAMES=COLUMN_COUNTER
	  /SIGNAL_FOLDER=PROCESSED
	  ! /RESULT_NAMES=
	  ! /RESULT_TYPES=
	  ! /RESULT_FOLDER=PROCESSED
	  ! /RESULT_SUFFIX=
	  ! /SIGNAL_COMPONENTS=
	  /CONSTANT=1
	;

End_For_Each
 /ITERATION_PARAMETER_NAME=EVENT
;

Set_Camera_Perspective
/USE_STATIONARY_CAMERA=TRUE
! /TRACK_CAMERA_USING_SEGMENT=FALSE
! /TRACK_CAMERA_USING_SEGMENT_COM=FALSE
! /SEGMENT=
! /CAMERA_X_CENTER=0.0
! /CAMERA_Y_CENTER=0.0
! /CAMERA_Z_CENTER=0.0
! /CAMERA_ZOOM=2.0
! /CAMERA_PAN=0.0
! /CAMERA_TILT=0.0
;

! Show trial names in report to better identify screenshots
 

Set_Text_Item
/SIGNAL_NAME=ImageList
/SIGNAL_FOLDER=META
/SIGNAL_DATA_VALUE=Trials shown in following order: Fastball 2, Fastball 3, Fastball 4, Fastball 5 
;

Set_Report_Options
! /PAGE_LAYOUT=LANDSCAPE
! /PAPER_SIZE=-
! /COLLECTOR=-
! /FACILITY_LINE_2=-
! /ADDRESS_LINE_1=-
! /ADDRESS_LINE_2=-
! /ADDRESS_LINE_3=-
! /PHONE=-
! /FAX=-
! /NOTES_LINE_1=-
! /NOTES_LINE_2=-
! /NOTES_LINE_3=-
! /LOGO=-
! /MARGIN_TOP=-
! /MARGIN_BOTTOM=-
! /MARGIN_LEFT=-
! /MARGIN_RIGHT=-
! /PAGE_NUMBER_POSITION=-
! /PAGE_NUMBER_ALIGNMENT=-
/PAGE_TAG_LINE_1=Fastball (Unspecified),  (),  () 
! /PAGE_TAG_LINE_2=-
! /PAGE_TAG_LINE_3=-
! /PAGE_TAG_LINE_4=-
;

!================================================================
! Page 4 - Cylinder 1 -
!================================================================

For_Each
/ITERATION_PARAMETER_NAME=FILE_TAG
/ITEMS=FastBall+Pitch 
;

	Select_Active_File
	 /FILE_NAME=::FILE_TAG
	 ! /QUERY=
	;
	
	! loop for ORIGNAL signals
	For_Each
	/ITERATION_PARAMETER_NAME=sigName
	! /ITERATION_PARAMETER_COUNT_NAME=
	/ITEMS=Pelvis_Angle+Lead_Hip_Angle+Lead_Knee_Angle+Lead_Ankle_Angle+Back_Hip_Angle+Back_Knee_Angle+Back_Ankle_Angle+Back_Foot_wrt_Lab+Trunk_Angle+Pitching_Hand_Angle+Pitching_Elbow_Angle+Glove_Elbow_Angle+Glove_Shoulder_Angle+Head_Angle+Pelvis_COG+Trunk_COG+Hip Shoulders Sep+Pelvis_COG_Vel
	;

		For_Each
		/ITERATION_PARAMETER_NAME=eventName
		! /ITERATION_PARAMETER_COUNT_NAME=
		/ITEMS=Setup+MaxKneeHeight+Footstrike+Release+Release100msAfter+Max_Shoulder_Rot+PelvisRot_Stop+Max_Shoulder_Int_Rot_FollowThru
		;

			Metric_Signal_Value_At_Event
			 /RESULT_METRIC_NAME=&::sigName&@&::eventName
			 ! /RESULT_METRIC_FOLDER=PROCESSED
			 /SIGNAL_TYPES=LINK_MODEL_BASED
			 /SIGNAL_NAMES=::sigName
			 /SIGNAL_FOLDER=ORIGINAL
			 /EVENT_NAME=::eventName
			 /GENERATE_MEAN_AND_STDDEV=FALSE
			 ! /APPEND_TO_EXISTING_VALUES=FALSE
			 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
			 ! /RETAIN_NO_DATA_VALUES=FALSE
			;

			Metric_Mean
			 /RESULT_METRIC_NAME=GLOBAL::&::sigName&@&::eventName
			 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
			 /RESULT_METRIC_FOLDER=::FILE_TAG
			 /SIGNAL_TYPES=METRIC
			 /SIGNAL_NAMES=&::sigName&@&::eventName
			 /SIGNAL_FOLDER=PROCESSED
			 ! /SIGNAL_COMPONENTS=
			 /EVENT_SEQUENCE=
			 /EXCLUDE_EVENTS=
			 /GENERATE_MEAN_AND_STDDEV=TRUE
			 /APPEND_TO_EXISTING_VALUES=TRUE
			;

		End_For_Each
		/ITERATION_PARAMETER_NAME=eventName
		;

	End_For_Each
	/ITERATION_PARAMETER_NAME=sigName
	;
	
	! Loop for Link_Model_Based::PROCESSED signals - loop above is for ORIGNAL signals
	For_Each
	/ITERATION_PARAMETER_NAME=sigName
	! /ITERATION_PARAMETER_COUNT_NAME=
	/ITEMS=Pitching_Shoulder_Angle+Pitching_Shoulder_Angle_XYZ+Pitching_Elbow_Ang_Vel+Trunk_COG_Vel+Pitching_Shoulder_Ang_Vel+Lead_Knee_Ang_Vel+Back_Knee_Ang_Vel
	;

		For_Each
		/ITERATION_PARAMETER_NAME=eventName
		! /ITERATION_PARAMETER_COUNT_NAME=
		/ITEMS=Setup+MaxKneeHeight+Footstrike+Release+Release100msAfter+Max_Shoulder_Rot+PelvisRot_Stop+Max_Shoulder_Int_Rot_FollowThru
		;

			Metric_Signal_Value_At_Event
			 /RESULT_METRIC_NAME=&::sigName&@&::eventName
			 ! /RESULT_METRIC_FOLDER=PROCESSED
			 /SIGNAL_TYPES=LINK_MODEL_BASED
			 /SIGNAL_NAMES=::sigName
			 /SIGNAL_FOLDER=PROCESSED
			 /EVENT_NAME=::eventName
			 /GENERATE_MEAN_AND_STDDEV=FALSE
			 ! /APPEND_TO_EXISTING_VALUES=FALSE
			 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
			 ! /RETAIN_NO_DATA_VALUES=FALSE
			;

			Metric_Mean
			 /RESULT_METRIC_NAME=GLOBAL::&::sigName&@&::eventName
			 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
			 /RESULT_METRIC_FOLDER=::FILE_TAG
			 /SIGNAL_TYPES=METRIC
			 /SIGNAL_NAMES=&::sigName&@&::eventName
			 /SIGNAL_FOLDER=PROCESSED
			 ! /SIGNAL_COMPONENTS=
			 /EVENT_SEQUENCE=
			 /EXCLUDE_EVENTS=
			 /GENERATE_MEAN_AND_STDDEV=TRUE
			 /APPEND_TO_EXISTING_VALUES=TRUE
			;

		End_For_Each
		/ITERATION_PARAMETER_NAME=eventName
		;

	End_For_Each
	/ITERATION_PARAMETER_NAME=sigName
	;
	
End_For_Each
/ITERATION_PARAMETER_NAME=FILE_TAG
;

! Block event (must be manualy set by user in QTM)
Set_Pipeline_Parameter_To_List_Of_Tagged_Files
/PARAMETER_NAME=files
/TAG_NAME=Pitch
! /GET_CURRENT_SELECTED_FILES=false
! /USE_SHORT_FILENAMES=false
;

For_Each
/ITERATION_PARAMETER_NAME=file
! /ITERATION_PARAMETER_COUNT_NAME=
/ITEMS=::files
;

	Select_Active_File
	/FILE_NAME=::file
	! /QUERY=
	;

	Conditional_Statement
	/ITERATION_PARAMETER_NAME=block_exists
	/EXPRESSION=Data_Exists(EVENT_LABEL::ORIGINAL::Block)
	! /AS_INTEGER=TRUE
	;
		
		Metric_Time_Between_Events
		/RESULT_METRIC_NAME=Footstrike_Block_Time
		/RESULT_METRIC_FOLDER=EVENTS
		/EVENT_SEQUENCE=Footstrike+Block
		/EXCLUDE_EVENTS=
		/GENERATE_MEAN_AND_STDDEV=FALSE
		! /APPEND_TO_EXISTING_VALUES=FALSE
		;

		Metric_Signal_Value_At_Event
		/SIGNAL_TYPES=LINK_MODEL_BASED
		/SIGNAL_NAMES=Pelvis_Angle+Trunk_Angle+Pitching_Shoulder_Angle
		/SIGNAL_FOLDER=ORIGINAL+ORIGINAL+PROCESSED
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=@Block
		/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
		! /SIGNAL_COMPONENTS=
		! /COMPONENT_SEQUENCE=
		/EVENT_NAME=Block
		! /EVENT_INSTANCE=0
		/GENERATE_MEAN_AND_STDDEV=FALSE
		! /APPEND_TO_EXISTING_VALUES=FALSE
		! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
		! /RETAIN_NO_DATA_VALUES=FALSE
		;

		Metric_Mean
		 /RESULT_METRIC_NAME=GLOBAL::Pelvis_Angle@Block
		 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
		 /RESULT_METRIC_FOLDER=::FILE_TAG
		 /SIGNAL_TYPES=METRIC
		 /SIGNAL_NAMES=Pelvis_Angle@Block
		 /SIGNAL_FOLDER=PROCESSED
		 ! /SIGNAL_COMPONENTS=
		 /EVENT_SEQUENCE=
		 /EXCLUDE_EVENTS=
		 /GENERATE_MEAN_AND_STDDEV=TRUE
		 /APPEND_TO_EXISTING_VALUES=TRUE
		;

		Metric_Mean
		 /RESULT_METRIC_NAME=GLOBAL::Trunk_Angle@Block
		 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
		 /RESULT_METRIC_FOLDER=::FILE_TAG
		 /SIGNAL_TYPES=METRIC
		 /SIGNAL_NAMES=Trunk_Angle@Block
		 /SIGNAL_FOLDER=PROCESSED
		 ! /SIGNAL_COMPONENTS=
		 /EVENT_SEQUENCE=
		 /EXCLUDE_EVENTS=
		 /GENERATE_MEAN_AND_STDDEV=TRUE
		 /APPEND_TO_EXISTING_VALUES=TRUE
		;

		Metric_Mean
		 /RESULT_METRIC_NAME=GLOBAL::Pitching_Shoulder_Angle@Block
		 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
		 /RESULT_METRIC_FOLDER=::FILE_TAG
		 /SIGNAL_TYPES=METRIC
		 /SIGNAL_NAMES=Pitching_Shoulder_Angle@Block
		 /SIGNAL_FOLDER=PROCESSED
		 ! /SIGNAL_COMPONENTS=
		 /EVENT_SEQUENCE=
		 /EXCLUDE_EVENTS=
		 /GENERATE_MEAN_AND_STDDEV=TRUE
		 /APPEND_TO_EXISTING_VALUES=TRUE
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=block_exists
	;

End_For_Each
/ITERATION_PARAMETER_NAME=file
;

Select_Active_File
/FILE_NAME=Pitch
! /QUERY=
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=MaxTrunkLinearVel
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Trunk_COG_Vel
 /SIGNAL_FOLDER=PROCESSED
 /EVENT_NAME=MaxTrunkLinearVel
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=MaxPelvisLinearVel
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pelvis_COG_Vel
 /SIGNAL_FOLDER=ORIGINAL
 /EVENT_NAME=MaxPelvisLinearVel
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

!Convert to mph for v3d report
For_Each
/ITERATION_PARAMETER_NAME=signame
! /ITERATION_PARAMETER_COUNT_NAME=
/ITEMS=MaxTrunkLinearVel+MaxPelvisLinearVel+Trunk_COG_Vel@Footstrike+Pelvis_COG_Vel@Footstrike+Trunk_COG_Vel@Max_Shoulder_Rot+Pelvis_COG_Vel@Max_Shoulder_Rot+Trunk_COG_Vel@Max_Shoulder_Rot+Pelvis_COG_Vel@Max_Shoulder_Rot+Trunk_COG_Vel@Release+Pelvis_COG_Vel@Release+Pelvis_COG_Vel@PelvisRot_Stop+Pelvis_COG_Vel@Release100msAfter
;

	Evaluate_Expression
	/EXPRESSION=METRIC::PROCESSED::&::signame& * 2.2369
	/RESULT_NAME=&::signame&_MPH
	/RESULT_TYPE=METRIC
	/RESULT_FOLDER=PROCESSED
	;

End_For_Each
/ITERATION_PARAMETER_NAME=signame
;

!Convert to inches for v3d report
For_Each
/ITERATION_PARAMETER_NAME=signame
! /ITERATION_PARAMETER_COUNT_NAME=
/ITEMS=Pelvis_COG@Footstrike+Pelvis_COG@Max_Shoulder_Rot+Pelvis_COG@Release+Pelvis_COG@PelvisRot_Stop+Pelvis_COG@Release100msAfter
;

	Evaluate_Expression
	/EXPRESSION=METRIC::PROCESSED::&::signame& * 39.37
	/RESULT_NAME=&::signame&_in
	/RESULT_TYPE=METRIC
	/RESULT_FOLDER=PROCESSED
	;

End_For_Each
/ITERATION_PARAMETER_NAME=signame
;

!================================================================
! Page 5 - Cylinder 2 - Stride Length (in, %)
!================================================================

!Calculate stride length for each trial
Select_Active_File
/FILE_NAME=Pitch
!/QUERY=
;

!Copy height into global workspace
Metric_Mean
/RESULT_METRIC_NAME=GLOBAL::SubjectHeight
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
! /RESULT_METRIC_FOLDER=PROCESSED
/SIGNAL_TYPES=METRIC
/SIGNAL_NAMES=HEIGHT
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_COMPONENTS=X
/EVENT_SEQUENCE=
/EXCLUDE_EVENTS=
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/RESULT_METRIC_NAME=THROW_ANKLE@SETUP
/RESULT_METRIC_FOLDER=STRIDE_LENGTH
/SIGNAL_TYPES=KINETIC_KINEMATIC
/SIGNAL_NAMES=DistEndPos
/SIGNAL_FOLDER=::THROW_SIDE_LETTER&SK
/EVENT_NAME=SETUP
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/RESULT_METRIC_NAME=OPP_ANKLE@Footstrike
/RESULT_METRIC_FOLDER=STRIDE_LENGTH
/SIGNAL_TYPES=KINETIC_KINEMATIC
/SIGNAL_NAMES=DistEndPos
/SIGNAL_FOLDER=::OPP_SIDE_LETTER&SK
/EVENT_NAME=Footstrike
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

!Transform to virtual lab to calculate step length correctly independent of L frame orientation
Transform_Data_Coordinate_System
/SIGNAL_TYPES=METRIC
/SIGNAL_FOLDER=STRIDE_LENGTH
/SIGNAL_NAMES=OPP_ANKLE@Footstrike+THROW_ANKLE@SETUP
! /FROM_SEGMENT_CS=LAB
/TO_SEGMENT_CS=Virtual Lab
/RESULT_TYPES=METRIC
/RESULT_FOLDERS=STRIDE_LENGTH
/RESULT_NAME=_trans
/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
/ORIENTATION_ONLY=TRUE
! /USE_DATA_RATE=FALSE
;

Evaluate_Expression
/EXPRESSION=abs(METRIC::STRIDE_LENGTH::THROW_ANKLE@SETUP_trans::Y[1] - METRIC::STRIDE_LENGTH::OPP_ANKLE@Footstrike_trans::Y[1])
/RESULT_NAME=STRIDE_LENGTH
/RESULT_TYPE=METRIC
/RESULT_FOLDER=STRIDE_LENGTH
;

Metric_Mean
/RESULT_METRIC_NAME=_MEAN
/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
/RESULT_METRIC_FOLDER=STRIDE_LENGTH
/SIGNAL_TYPES=METRIC
/SIGNAL_NAMES=STRIDE_LENGTH
/SIGNAL_FOLDER=STRIDE_LENGTH
! /SIGNAL_COMPONENTS=ALL_COMPONENTS
/EVENT_SEQUENCE=
/EXCLUDE_EVENTS=
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
;

Multiply_Signals_By_Constant
/SIGNAL_TYPES=METRIC
/SIGNAL_NAMES=STRIDE_LENGTH_MEAN
/SIGNAL_FOLDER=STRIDE_LENGTH
!/RESULT_NAMES=
!/RESULT_TYPES=
/RESULT_FOLDER=STRIDE_LENGTH
/RESULT_NAME=_IN
/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
! /SIGNAL_COMPONENTS=
/CONSTANT=39.4
;

Evaluate_Expression
/EXPRESSION=METRIC::STRIDE_LENGTH::STRIDE_LENGTH_MEAN / METRIC::PROCESSED::HEIGHT * 100
/RESULT_TYPES=METRIC
/RESULT_FOLDERS=STRIDE_LENGTH
/RESULT_NAME=STRIDE_LENGTH_MEAN_PERCENT
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
;

!================================================================
! Arm Abduction angle at foot strike
! Max Arm External Rotation
!================================================================

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=Trunk_wrt_Pelvis_FE@Footstrike
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Trunk_wrt_Pelvis_Angle
 /SIGNAL_FOLDER=ORIGINAL
 /EVENT_NAME=Footstrike
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=Trunk_wrt_Pelvis_FE@Max_Shoulder_Rot
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Trunk_wrt_Pelvis_Angle
 /SIGNAL_FOLDER=ORIGINAL
 /EVENT_NAME=Max_Shoulder_Rot
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=Trunk_wrt_Pelvis_FE@Release
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Trunk_wrt_Pelvis_Angle
 /SIGNAL_FOLDER=ORIGINAL
 /EVENT_NAME=Release
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=Trunk_wrt_Pelvis_FE@Max_Shoulder_Int_Rot_FollowThru
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Trunk_wrt_Pelvis_Angle
 /SIGNAL_FOLDER=ORIGINAL
 /EVENT_NAME=Max_Shoulder_Int_Rot_FollowThru
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

!================================================================
! Ball Speed
!================================================================
Set_Pipeline_Parameter_To_List_Of_Tagged_Files
/PARAMETER_NAME=files
/TAG_NAME=Pitch
! /GET_CURRENT_SELECTED_FILES=false
! /USE_SHORT_FILENAMES=false
;

	For_Each
	/ITERATION_PARAMETER_NAME=filename
	! /ITERATION_PARAMETER_COUNT_NAME=
	/ITEMS=::files
	;

		Select_Active_File
		/FILE_NAME=::filename
		! /QUERY=
		;

	Conditional_Statement
	/ITERATION_PARAMETER_NAME=cond
	/EXPRESSION=(Data_Exists(TARGET::ORIGINAL::Ball) = 1)
	! /AS_INTEGER=TRUE
	;

		Event_Copy
		/EVENT_NAME=Release
		/NEW_EVENT_NAME=Release2After
		/FRAME_OFFSET=2
		! /TIME_OFFSET=
		! /PERCENT_OFFSET=
		! /EVENT_INSTANCE=0
		! /RANGE_INSTANCE=0
		! /EVENT_SEQUENCE=
		! /EXCLUDE_EVENTS=
		! /START_AT_EVENT=
		! /END_AT_EVENT=
		;

		Event_Copy
		/EVENT_NAME=Release
		/NEW_EVENT_NAME=Release4After
		/FRAME_OFFSET=4
		! /TIME_OFFSET=
		! /PERCENT_OFFSET=
		! /EVENT_INSTANCE=0
		! /RANGE_INSTANCE=0
		! /EVENT_SEQUENCE=
		! /EXCLUDE_EVENTS=
		! /START_AT_EVENT=
		! /END_AT_EVENT=
		;

		Metric_Vector_Between_Events
		/RESULT_METRIC_NAME=BALL_VECTOR
		/RESULT_METRIC_FOLDER=BALLSPEED
		/GENERATE_VECTOR_LENGTH_METRIC=TRUE
		/START_SIGNAL_TYPE=TARGET
		/START_SIGNAL_NAME=BALL
		/START_SIGNAL_FOLDER=ORIGINAL
		/END_SIGNAL_TYPE=TARGET
		/END_SIGNAL_NAME=BALL
		/END_SIGNAL_FOLDER=ORIGINAL
		/EVENT_SEQUENCE=Release2After+Release4After
		/EXCLUDE_EVENTS=
		/GENERATE_MEAN_AND_STDDEV=FALSE
		! /APPEND_TO_EXISTING_VALUES=FALSE
		! /RETAIN_NO_DATA_VALUES=FALSE
		;

		Metric_Time_Between_Events
		/RESULT_METRIC_NAME=DELTA_T
		/RESULT_METRIC_FOLDER=BALLSPEED
		/EVENT_SEQUENCE=Release2After+Release4After
		/EXCLUDE_EVENTS=
		/GENERATE_MEAN_AND_STDDEV=FALSE
		! /APPEND_TO_EXISTING_VALUES=FALSE
		;

		Evaluate_Expression
		/EXPRESSION=(METRIC::BALLSPEED::BALL_VECTOR/METRIC::BALLSPEED::DELTA_T)
		/RESULT_NAME=BALL_RELEASE_SPEED
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=BALLSPEED
		;

		Evaluate_Expression
		/EXPRESSION=(METRIC::BALLSPEED::BALL_VECTOR/METRIC::BALLSPEED::DELTA_T) * 2.23693629
		/RESULT_NAME=BALL_RELEASE_SPEED_mph
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=BALLSPEED
		;

		Signal_Magnitude
		/SIGNAL_TYPES=TARGET
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=Ball
		! /RESULT_FOLDERS=PROCESSED
		/RESULT_NAME=_Mag
		/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
		;

		First_Derivative
		/SIGNAL_TYPES=DERIVED
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=Ball_Mag
		/RESULT_TYPES=DERIVED
		/RESULT_FOLDERS=PROCESSED
		/RESULT_NAME=Ball_Vel
		/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
		;

		Metric_Maximum
		/RESULT_METRIC_FOLDER=BALLSPEED
		/RESULT_METRIC_NAME=Max_Ball_Vel
		! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
		/SIGNAL_TYPES=DERIVED
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=Ball_Vel
		/COMPONENT_SEQUENCE=ALL
		/EVENT_SEQUENCE=
		/EXCLUDE_EVENTS=
		/SEQUENCE_PERCENT_START=
		/SEQUENCE_PERCENT_END=
		/GENERATE_MEAN_AND_STDDEV=FALSE
		! /APPEND_TO_EXISTING_VALUES=FALSE
		! /CREATE_GLOBAL_MAXIMUM=FALSE
		;

		Evaluate_Expression
		/EXPRESSION=METRIC::BALLSPEED::MAX_BALL_VEL * 2.23693629
		/RESULT_NAME=BALL_MAX_SPEED_mph
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=BALLSPEED
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=cond
	;

	Conditional_Statement
	/ITERATION_PARAMETER_NAME=cond
	/EXPRESSION=((Data_Exists(TARGET::ORIGINAL::Ball) <> 1) &::AMP& (METRIC::BALLSPEED::BALL_RELEASE_SPEED = 0))
	! /AS_INTEGER=TRUE
	;

		Remove_Signals
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=BALLSPEED
		/SIGNAL_NAMES=BALL_RELEASE_SPEED
		! /INCLUDE_MODELS=FALSE
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=cond
	;

	Conditional_Statement
	/ITERATION_PARAMETER_NAME=cond
	/EXPRESSION=((Data_Exists(TARGET::ORIGINAL::Ball) <> 1) &::AMP& (METRIC::BALLSPEED::BALL_RELEASE_SPEED <> 0))
	! /AS_INTEGER=TRUE
	;

		Evaluate_Expression
		/EXPRESSION=METRIC::BALLSPEED::BALL_RELEASE_SPEED * 2.23693629
		/RESULT_NAME=BALL_RELEASE_SPEED_mph
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=BALLSPEED
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=cond
	;

End_For_Each
/ITERATION_PARAMETER_NAME=filename
;


!==================================================
!Calculate min/max metrics and their global means
!==================================================

Select_Active_File
/FILE_NAME=Pitch
! /QUERY=
;

!Angular Velocities (Kinematic Sequence)
Metric_Maximum
 /RESULT_METRIC_NAME=Pitching_Humerus_Ang_Vel_max+Pelvis_Ang_Vel_max+Thorax_Ang_Vel_max+Pitching_Hand_Ang_Vel_max+Pitching_Elbow_Ang_Vel_max+Pitching_Shoulder_Ang_Vel_max
 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
 /RESULT_METRIC_FOLDER=KINEMATIC_SEQUENCE
 /SIGNAL_TYPES=DERIVED
 /SIGNAL_NAMES=Pitching_Humerus_Ang_Vel_plot+Pelvis_Ang_Vel_plot+Thorax_Ang_Vel_plot+Pitching_Hand_Ang_Vel_plot+Pitching_Elbow_Ang_Vel_plot_neg+Pitching_Shoulder_Ang_Vel_plot_neg
 /SIGNAL_FOLDER=PROCESSED
 /SIGNAL_COMPONENTS=X
 /EVENT_SEQUENCE=SETUP+Release100msAfter
 /EXCLUDE_EVENTS=
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /CREATE_GLOBAL_MAXIMUM=FALSE
;

Event_Global_Minimum
/SIGNAL_TYPES=DERIVED
/SIGNAL_NAMES=Pitching_Shoulder_AngVel_HzShldAbd
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=MaxShoulder_AngVel_HzShldAbd
/SELECT_X=TRUE
! /SELECT_Y=FALSE
!/SELECT_Z=FALSE
/START_AT_EVENT=SETUP
/END_AT_EVENT=Release100msAfter
;

Evaluate_Expression
/EXPRESSION=EVENT_LABEL::ORIGINAL::MaxShoulder_AngVel_HzShldAbd-EVENT_LABEL::ORIGINAL::MaxKneeHeight
/RESULT_NAME=PeakShoulder_AngVel_HzShldAbdTime
/RESULT_TYPE=METRIC
/RESULT_FOLDER=TIMING
;

Evaluate_Expression
/EXPRESSION=1000*(EVENT_LABEL::ORIGINAL::MaxShoulder_AngVel_HzShldAbd-EVENT_LABEL::ORIGINAL::MaxKneeHeight)
/RESULT_NAME=PeakShoulder_AngVel_HzShldAbdTime_ms
/RESULT_TYPE=METRIC
/RESULT_FOLDER=TIMING
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=Pitching_Shoulder_AngVel_HzShldAbd_Max
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=DERIVED
 /SIGNAL_NAMES=Pitching_Shoulder_AngVel_HzShldAbd
 /SIGNAL_FOLDER=PROCESSED
 /EVENT_NAME=MaxShoulder_AngVel_HzShldAbd
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=Pitching_Shoulder_AngVel_HzShldAbd@Footstrike
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=DERIVED
 /SIGNAL_NAMES=Pitching_Shoulder_AngVel_HzShldAbd
 /SIGNAL_FOLDER=PROCESSED
 /EVENT_NAME=Footstrike
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=Pitching_Shoulder_AngVel_HzShldAbd@Max_Shoulder_Rot
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=DERIVED
 /SIGNAL_NAMES=Pitching_Shoulder_AngVel_HzShldAbd
 /SIGNAL_FOLDER=PROCESSED
 /EVENT_NAME=Max_Shoulder_Rot
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=Pitching_Shoulder_AngVel_HzShldAbd@Release
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=DERIVED
 /SIGNAL_NAMES=Pitching_Shoulder_AngVel_HzShldAbd
 /SIGNAL_FOLDER=PROCESSED
 /EVENT_NAME=Release
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=Pitching_Shoulder_AngVel_HzShldAbd@Release100msAfter
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=DERIVED
 /SIGNAL_NAMES=Pitching_Shoulder_AngVel_HzShldAbd
 /SIGNAL_FOLDER=PROCESSED
 /EVENT_NAME=Release100msAfter
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=@Footstrike
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Humerus_Ang_Vel+Pelvis_Ang_Vel+Thorax_Ang_Vel
 /SIGNAL_FOLDER=PROCESSED
 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
! /SIGNAL_COMPONENTS=Z
 /EVENT_NAME=Footstrike
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=@Footstrike
 ! /RESULT_METRIC_FOLDER=PROCESSED
/SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Hand_Ang_Vel
 /SIGNAL_FOLDER=PROCESSED
! /SIGNAL_COMPONENTS=X
 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
 /EVENT_NAME=Footstrike
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=@Max_Shoulder_Rot
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Humerus_Ang_Vel+Pelvis_Ang_Vel+Thorax_Ang_Vel
 /SIGNAL_FOLDER=PROCESSED
 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
! /SIGNAL_COMPONENTS=Z
 /EVENT_NAME=Max_Shoulder_Rot
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=@Max_Shoulder_Rot
 ! /RESULT_METRIC_FOLDER=PROCESSED
/SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Hand_Ang_Vel
 /SIGNAL_FOLDER=PROCESSED
! /SIGNAL_COMPONENTS=X
 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
 /EVENT_NAME=Max_Shoulder_Rot
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=@MaxKneeHeight
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Humerus_Ang_Vel+Pelvis_Ang_Vel+Thorax_Ang_Vel+Pitching_Humerus_Ang_Acc+Pelvis_Ang_Acc+Thorax_Ang_Acc
 /SIGNAL_FOLDER=PROCESSED
 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
 !/SIGNAL_COMPONENTS=Z
 /EVENT_NAME=MaxKneeHeight
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=@Release
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Humerus_Ang_Vel+Pelvis_Ang_Vel+Thorax_Ang_Vel+Pitching_Humerus_Ang_Acc+Pelvis_Ang_Acc+Thorax_Ang_Acc
 /SIGNAL_FOLDER=PROCESSED
 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
 !/SIGNAL_COMPONENTS=Z
 /EVENT_NAME=Release
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=@Release
 ! /RESULT_METRIC_FOLDER=PROCESSED
/SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Hand_Ang_Vel
 /SIGNAL_FOLDER=PROCESSED
! /SIGNAL_COMPONENTS=X
 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
 /EVENT_NAME=Release
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=@Release100msAfter
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Humerus_Ang_Vel+Pelvis_Ang_Vel+Thorax_Ang_Vel+Pitching_Humerus_Ang_Acc+Pelvis_Ang_Acc+Thorax_Ang_Acc
 /SIGNAL_FOLDER=PROCESSED
 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
! /SIGNAL_COMPONENTS=Z
 /EVENT_NAME=Release100msAfter
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=@Release100msAfter
 ! /RESULT_METRIC_FOLDER=PROCESSED
/SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Hand_Ang_Vel
 /SIGNAL_FOLDER=PROCESSED
! /SIGNAL_COMPONENTS=X
 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
 /EVENT_NAME=Release100msAfter
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Minimum
 /RESULT_METRIC_NAME=Pitching_Shoulder_Angle_Min
 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Shoulder_Angle
 /SIGNAL_FOLDER=PROCESSED
 ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
 /EVENT_SEQUENCE=MaxKneeHeight+Release
 /EXCLUDE_EVENTS=
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /CREATE_GLOBAL_MINIMUM=FALSE
;

Metric_Maximum
 /RESULT_METRIC_NAME=Pitching_Shoulder_Angle_Max
 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Shoulder_Angle
 /SIGNAL_FOLDER=PROCESSED
 ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
 /EVENT_SEQUENCE=MaxKneeHeight+Release
 /EXCLUDE_EVENTS=
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /CREATE_GLOBAL_MAXIMUM=FALSE
;

Metric_Maximum
 /RESULT_METRIC_NAME=Glove_Shoulder_Angle_Max
 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Glove_Shoulder_Angle
 /SIGNAL_FOLDER=PROCESSED
 ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
 /EVENT_SEQUENCE=MaxKneeHeight+Release
 /EXCLUDE_EVENTS=
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /CREATE_GLOBAL_MAXIMUM=FALSE
;

Metric_Maximum
/RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=_max
/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=ORIGINAL
/SIGNAL_NAMES=Pitching_Elbow_Angle
! /COMPONENT_SEQUENCE=
/EVENT_SEQUENCE=Footstrike+Release100msAfter
/EXCLUDE_EVENTS=
! /GENERATE_MEAN_AND_STDDEV=TRUE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /CREATE_GLOBAL_MAXIMUM=FALSE
;

Metric_Minimum
/RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=_min
/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Pitching_Elbow_Ang_Vel
! /COMPONENT_SEQUENCE=
/EVENT_SEQUENCE=Max_Shoulder_Rot+Release
/EXCLUDE_EVENTS=
! /GENERATE_MEAN_AND_STDDEV=TRUE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /CREATE_GLOBAL_MINIMUM=FALSE
;

Metric_Signal_Value_At_Event
 /RESULT_METRIC_NAME=Shoulder_Ang_Vel@Release
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Shoulder_Ang_Vel
 /SIGNAL_FOLDER=PROCESSED
 /EVENT_NAME=Release
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
 ! /RETAIN_NO_DATA_VALUES=FALSE
;

Evaluate_Expression
 /EXPRESSION=abs(METRIC::PROCESSED::Shoulder_Ang_Vel@Release)
 /RESULT_NAME=Shoulder_Ang_Vel@Release_Abs
 /RESULT_TYPE=METRIC
 ! /RESULT_FOLDER=PROCESSED
;

Metric_Minimum
 /RESULT_METRIC_NAME=Shoulder_Vel_Min
 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
 ! /RESULT_METRIC_FOLDER=PROCESSED
 /SIGNAL_TYPES=LINK_MODEL_BASED
 /SIGNAL_NAMES=Pitching_Shoulder_Ang_Vel
 /SIGNAL_FOLDER=PROCESSED
 ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
 /EVENT_SEQUENCE=MaxKneeHeight+Release100msAfter
 /EXCLUDE_EVENTS=
 /GENERATE_MEAN_AND_STDDEV=FALSE
 ! /APPEND_TO_EXISTING_VALUES=FALSE
 ! /CREATE_GLOBAL_MINIMUM=FALSE
;

Evaluate_Expression
 /EXPRESSION=abs(METRIC::PROCESSED::Shoulder_Vel_Min)
 /RESULT_NAME=Shoulder_Vel_Min_Abs
 /RESULT_TYPE=METRIC
 ! /RESULT_FOLDER=PROCESSED
;

! Trunk Rotation Range and Shoulder rotation cumulative range from footplant to ball release

! Trunk Rotation cummulative range Trunk rotation @ Footplant and @ ball release 
Evaluate_Expression
/EXPRESSION=METRIC::PROCESSED::Trunk_Angle@Footstrike::Z-METRIC::PROCESSED::Trunk_Angle@Release::Z
/RESULT_NAME=Trunk_Rotation_Cummulative_Range_FStoRelease
/RESULT_TYPE=METRIC
/RESULT_FOLDER=PROCESSED
;

! Shoulder rotation cumulative range of movement (not max - min). This is range at 3 timeframes for shoulder rotation @ footplant,
! shoulder rotation max, and shoulder rotation @ release. So cummulative range is (Max-FS)+(Max-Release)
Evaluate_Expression
/EXPRESSION=(METRIC::PROCESSED::Pitching_Shoulder_Angle_Max::Z-METRIC::PROCESSED::Pitching_Shoulder_Angle@Footstrike::Z)+(METRIC::PROCESSED::Pitching_Shoulder_Angle_Max::Z-METRIC::PROCESSED::Pitching_Shoulder_Angle@Release::Z)
/RESULT_NAME=Shoulder_Rotation_Cummulative_Range_FStoRelease
/RESULT_TYPE=METRIC
/RESULT_FOLDER=PROCESSED
;

! Trunk Rotation and Hip Shld Sep @ ShoulderExtRot90

Event_Threshold
/RESULT_EVENT_NAME=Shoulder_ExtRot90
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Pitching_Shoulder_Angle
/SIGNAL_COMPONENTS=Z
! /FRAME_OFFSET=0
! /TIME_OFFSET=
! /EVENT_SEQUENCE=
! /EXCLUDE_EVENTS=
! /EVENT_SEQUENCE_INSTANCE=0
! /EVENT_SUBSEQUENCE=
! /SUBSEQUENCE_EXCLUDE_EVENTS=
! /EVENT_SUBSEQUENCE_INSTANCE=0
/EVENT_INSTANCE=1
/THRESHOLD=90
/ON_ASCENT=TRUE
/ON_DESCENT=FALSE
! /FRAME_WINDOW=8
! /ENSURE_FRAMES_BEFORE=FALSE
! /ENSURE_FRAMES_AFTER=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=LINK_MODEL_BASED
! /SIGNAL_FOLDER=ORIGINAL
/SIGNAL_NAMES=Hip Shoulders Sep
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=@Shoulder_ExtRot90
/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
! /SIGNAL_COMPONENTS=
/COMPONENT_SEQUENCE=Z
/EVENT_NAME=Shoulder_ExtRot90
! /EVENT_INSTANCE=0
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=LINK_MODEL_BASED
! /SIGNAL_FOLDER=ORIGINAL
/SIGNAL_NAMES=Trunk_Angle
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=@Shoulder_ExtRot90
/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
! /SIGNAL_COMPONENTS=
/COMPONENT_SEQUENCE=Z
/EVENT_NAME=Shoulder_ExtRot90
! /EVENT_INSTANCE=0
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

! Calculation for variation of hip shoulder sep for Angle-Angle page: Trunk wrt lab rotation minus Pelvis wrt lab rotation  

Evaluate_Expression
 /EXPRESSION=METRIC::PROCESSED::Trunk_Angle@Footstrike::Z-METRIC::PROCESSED::Pelvis_Angle@Footstrike::Z
 /RESULT_NAME=Trunk Rot wrt Pelvis Rot@Footstrike
 /RESULT_TYPE=METRIC
 ! /RESULT_FOLDER=PROCESSED
;

Evaluate_Expression
 /EXPRESSION=METRIC::PROCESSED::Trunk_Angle@Max_Shoulder_Rot::Z-METRIC::PROCESSED::Pelvis_Angle@Max_Shoulder_Rot::Z
 /RESULT_NAME=Trunk Rot wrt Pelvis Rot@Max_Shoulder_Rot
 /RESULT_TYPE=METRIC
 ! /RESULT_FOLDER=PROCESSED
;

Evaluate_Expression
 /EXPRESSION=METRIC::PROCESSED::Trunk_Angle@Release::Z-METRIC::PROCESSED::Pelvis_Angle@Release::Z
 /RESULT_NAME=Trunk Rot wrt Pelvis Rot@Release
 /RESULT_TYPE=METRIC
 ! /RESULT_FOLDER=PROCESSED
;

Evaluate_Expression
 /EXPRESSION=METRIC::PROCESSED::Trunk_Angle@Max_Shoulder_Int_Rot_FollowThru::Z-METRIC::PROCESSED::Pelvis_Angle@Max_Shoulder_Int_Rot_FollowThru::Z
 /RESULT_NAME=Trunk Rot wrt Pelvis Rot@Max_Shoulder_Int_Rot_FollowThru
 /RESULT_TYPE=METRIC
 ! /RESULT_FOLDER=PROCESSED
;

! COM path of pelvis and trunk ----------------

! Detect Lead heel position. Use median of first 10 frames.
Metric_Median
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Lead Heel_position_Footstrike
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_TYPES=TARGET 
/SIGNAL_FOLDER=PROCESSED 
/SIGNAL_NAMES=::LeadHeelBack
/COMPONENT_SEQUENCE=ALL
/EVENT_SEQUENCE=Footstrike_100ms+Footstrike_110ms ! We assume lead foot is flat on the ground already
/EXCLUDE_EVENTS=
/SEQUENCE_PERCENT_START=
/SEQUENCE_PERCENT_END=
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
;

Evaluate_Expression
 
	/EXPRESSION=(LINK_MODEL_BASED::ORIGINAL::PelvisPos - METRIC::PROCESSED::Lead Heel_position_Footstrike) * 39.3701
 
/RESULT_NAME=Pelvis_COG wrt Lead Heel_v3d
/RESULT_TYPE=DERIVED
/RESULT_FOLDER=COM
;

Evaluate_Expression
/EXPRESSION=(LINK_MODEL_BASED::ORIGINAL::PelvisPos - METRIC::PROCESSED::Lead Heel_position_Footstrike)
/RESULT_NAME=Pelvis_COG wrt Lead Heel
/RESULT_TYPE=DERIVED
/RESULT_FOLDER=COM
;

Evaluate_Expression
 
	/EXPRESSION=(LINK_MODEL_BASED::ORIGINAL::ThoraxPos - METRIC::PROCESSED::Lead Heel_position_Footstrike) * 39.3701
 
/RESULT_NAME=Trunk_COG wrt Lead Heel_v3d
/RESULT_TYPE=DERIVED
/RESULT_FOLDER=COM
;

Evaluate_Expression
/EXPRESSION=(LINK_MODEL_BASED::ORIGINAL::ThoraxPos - METRIC::PROCESSED::Lead Heel_position_Footstrike)
/RESULT_NAME=Trunk_COG wrt Lead Heel
/RESULT_TYPE=DERIVED
/RESULT_FOLDER=COM
;

For_Each
/ITERATION_PARAMETER_NAME=sig
! /ITERATION_PARAMETER_COUNT_NAME=
/ITEMS=Pelvis_COG wrt Lead Heel_v3d+Trunk_COG wrt Lead Heel_v3d+Pelvis_COG wrt Lead Heel+Trunk_COG wrt Lead Heel
;

	Multiply_Signals_By_Constant
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=COM
	/SIGNAL_NAMES=::sig
	/RESULT_TYPES=DERIVED
	/RESULT_FOLDER=COM
	/RESULT_NAME=_plot
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
	/SIGNAL_COMPONENTS=X
	/CONSTANT=1 
	;

	Multiply_Signals_By_Constant
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=COM
	/SIGNAL_NAMES=&::sig&_plot
	/RESULT_TYPES=DERIVED
	/RESULT_FOLDER=COM
	! /RESULT_NAME=
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	/SIGNAL_COMPONENTS=Y
	/CONSTANT=1 
	;

End_For_Each
/ITERATION_PARAMETER_NAME=sig
;

 

! ==============================
! Kinetics
! ==============================
Compute_Model_Based_Data
/RESULT_NAME=COM_displacement
/SUBJECT_TAG=
/FUNCTION=MODEL_COG
/SEGMENT=
/REFERENCE_SEGMENT=
! /RESOLUTION_COORDINATE_SYSTEM=LAB
! /USE_CARDAN_SEQUENCE=FALSE
! /NORMALIZATION=FALSE
! /NORMALIZATION_METHOD=
! /NORMALIZATION_METRIC=
! /NEGATEX=FALSE
! /NEGATEY=FALSE
! /NEGATEZ=FALSE
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Compute_Model_Based_Data
/RESULT_NAME=Left_GRF
/FUNCTION=GRF_DATA
/SEGMENT=LFT 
/REFERENCE_SEGMENT=
/RESOLUTION_COORDINATE_SYSTEM=Virtual Lab
! /USE_CARDAN_SEQUENCE=FALSE
/NORMALIZATION=FALSE
! /NORMALIZATION_METHOD=DEFAULT_NORMALIZATION
! /NORMALIZATION_METRIC=
/NEGATEX=::NEGATE_GRF_X
! /NEGATEY=FALSE
! /NEGATEZ=FALSE
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Compute_Model_Based_Data
/RESULT_NAME=Right_GRF
/FUNCTION=GRF_DATA
/SEGMENT=RFT 
/REFERENCE_SEGMENT=
/RESOLUTION_COORDINATE_SYSTEM=Virtual Lab
! /USE_CARDAN_SEQUENCE=FALSE
/NORMALIZATION=FALSE
! /NORMALIZATION_METHOD=DEFAULT_NORMALIZATION
! /NORMALIZATION_METRIC=
/NEGATEX=::NEGATE_GRF_X
! /NEGATEY=FALSE
! /NEGATEZ=FALSE
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Compute_Model_Based_Data
/RESULT_NAME=Back_Leg_GRF
/FUNCTION=GRF_DATA
/SEGMENT=&::THROW_SIDE_LETTER&FT 
/REFERENCE_SEGMENT=
/RESOLUTION_COORDINATE_SYSTEM=Virtual Lab
! /USE_CARDAN_SEQUENCE=FALSE
/NORMALIZATION=FALSE
! /NORMALIZATION_METHOD=DEFAULT_NORMALIZATION
! /NORMALIZATION_METRIC=
! /NEGATEX=FALSE
! /NEGATEY=FALSE
! /NEGATEZ=FALSE
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Compute_Model_Based_Data
/RESULT_NAME=Lead_Leg_GRF
/FUNCTION=GRF_DATA
/SEGMENT=&::OPP_SIDE_LETTER&FT 
/REFERENCE_SEGMENT=
/RESOLUTION_COORDINATE_SYSTEM=Virtual Lab
! /USE_CARDAN_SEQUENCE=FALSE
/NORMALIZATION=FALSE
! /NORMALIZATION_METHOD=DEFAULT_NORMALIZATION
! /NORMALIZATION_METRIC=
! /NEGATEX=FALSE
! /NEGATEY=FALSE
! /NEGATEZ=FALSE
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Evaluate_Expression
/EXPRESSION=LINK_MODEL_BASED::ORIGINAL::Back_Leg_GRF 
/RESULT_NAME=Trail_GRF !compatibility with Hitting
/RESULT_TYPE=DERIVED
/RESULT_FOLDER=PROCESSED
;

Evaluate_Expression
/EXPRESSION=LINK_MODEL_BASED::ORIGINAL::Lead_Leg_GRF
/RESULT_NAME=Lead_GRF
/RESULT_TYPE=DERIVED
/RESULT_FOLDER=PROCESSED
;

Compute_Model_Based_Data
/RESULT_NAME=Right COP
/SUBJECT_TAG=
/FUNCTION=COP_PATH
/SEGMENT=RFT 
/REFERENCE_SEGMENT=
! /RESOLUTION_COORDINATE_SYSTEM=LAB
! /USE_CARDAN_SEQUENCE=FALSE
! /NORMALIZATION=FALSE
! /NORMALIZATION_METHOD=
! /NORMALIZATION_METRIC=
! /NEGATEX=FALSE
! /NEGATEY=FALSE
! /NEGATEZ=FALSE
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Compute_Model_Based_Data
/RESULT_NAME=Left COP
/SUBJECT_TAG=
/FUNCTION=COP_PATH
/SEGMENT=LFT 
/REFERENCE_SEGMENT=
! /RESOLUTION_COORDINATE_SYSTEM=LAB
! /USE_CARDAN_SEQUENCE=FALSE
! /NORMALIZATION=FALSE
! /NORMALIZATION_METHOD=
! /NORMALIZATION_METRIC=
! /NEGATEX=FALSE
! /NEGATEY=FALSE
! /NEGATEZ=FALSE
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Compute_Model_Based_Data
/RESULT_NAME=Shoulder Torque_XYZ
/FUNCTION=JOINT_MOMENT
/SEGMENT=&::THROW_SIDE_LETTER&AR
/REFERENCE_SEGMENT=
/RESOLUTION_COORDINATE_SYSTEM=RTA
! /USE_CARDAN_SEQUENCE=FALSE
/NORMALIZATION=TRUE
/NORMALIZATION_METHOD=NORMALIZE_TO_GLOBAL_METRIC
/NORMALIZATION_METRIC=NORM_COEF
/NEGATEX=&::NEGATE_SHOULDER_X
/NEGATEY=&::NEGATE_SHOULDER_Y
/NEGATEZ=&::NEGATE_SHOULDER_Z
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Compute_Model_Based_Data
/RESULT_NAME=Shoulder Torque
/FUNCTION=JOINT_MOMENT
/SEGMENT=&::THROW_SIDE_LETTER&AR
/REFERENCE_SEGMENT=
/RESOLUTION_COORDINATE_SYSTEM=RTA
/USE_CARDAN_SEQUENCE=TRUE
/NORMALIZATION=TRUE
/NORMALIZATION_METHOD=NORMALIZE_TO_GLOBAL_METRIC
/NORMALIZATION_METRIC=NORM_COEF
/NEGATEX=&::NEGATE_SHOULDER_X
/NEGATEY=&::NEGATE_Y
/NEGATEZ=&::NEGATE_Z
/AXIS1=Z
/AXIS2=Y
/AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Compute_Model_Based_Data
/RESULT_NAME=Elbow Torque
/FUNCTION=JOINT_MOMENT
/SEGMENT=&::THROW_SIDE_LETTER&FA
/REFERENCE_SEGMENT=
/RESOLUTION_COORDINATE_SYSTEM=
/USE_CARDAN_SEQUENCE=TRUE
/NORMALIZATION=TRUE
/NORMALIZATION_METHOD=NORMALIZE_TO_GLOBAL_METRIC
/NORMALIZATION_METRIC=NORM_COEF
/NEGATEX=TRUE
/NEGATEY=&::NEGATE_Y
/NEGATEZ=&::NEGATE_Z
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Compute_Model_Based_Data
/RESULT_NAME=Elbow Torque_Nm
/FUNCTION=JOINT_MOMENT
/SEGMENT=&::THROW_SIDE_LETTER&FA
/REFERENCE_SEGMENT=
/RESOLUTION_COORDINATE_SYSTEM=
/USE_CARDAN_SEQUENCE=TRUE
/NORMALIZATION=FALSE
/NORMALIZATION_METHOD=
/NORMALIZATION_METRIC=
/NEGATEX=TRUE
/NEGATEY=&::NEGATE_Y
/NEGATEZ=&::NEGATE_Z
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Compute_Model_Based_Data
/RESULT_NAME=Shoulder Force
/FUNCTION=JOINT_FORCE
/SEGMENT=&::THROW_SIDE_LETTER&AR
/REFERENCE_SEGMENT=
/RESOLUTION_COORDINATE_SYSTEM=RTA
! /USE_CARDAN_SEQUENCE=FALSE
/NORMALIZATION=TRUE
/NORMALIZATION_METHOD=NORMALIZE_TO_GLOBAL_METRIC
/NORMALIZATION_METRIC=MASS_N
! /NEGATEX=FALSE
! /NEGATEY=FALSE
/NEGATEZ=TRUE
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Compute_Model_Based_Data
/RESULT_NAME=Shoulder Force_N
/FUNCTION=JOINT_FORCE
/SEGMENT=&::THROW_SIDE_LETTER&AR
/REFERENCE_SEGMENT=
/RESOLUTION_COORDINATE_SYSTEM=RTA
! /USE_CARDAN_SEQUENCE=FALSE
/NORMALIZATION=FALSE
/NORMALIZATION_METHOD=
/NORMALIZATION_METRIC=
! /NEGATEX=FALSE
! /NEGATEY=FALSE
/NEGATEZ=TRUE
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

Compute_Model_Based_Data
/RESULT_NAME=Elbow Force
/FUNCTION=JOINT_FORCE
/SEGMENT=&::THROW_SIDE_LETTER&FA
/REFERENCE_SEGMENT=
/RESOLUTION_COORDINATE_SYSTEM=RAR
! /USE_CARDAN_SEQUENCE=FALSE
/NORMALIZATION=TRUE
/NORMALIZATION_METHOD=NORMALIZE_TO_GLOBAL_METRIC
/NORMALIZATION_METRIC=MASS_N
! /NEGATEX=FALSE
! /NEGATEY=FALSE
/NEGATEZ=TRUE
! /AXIS1=X
! /AXIS2=Y
! /AXIS3=Z
! /TREADMILL_DATA=FALSE
! /TREADMILL_DIRECTION=UNIT_VECTOR(0,1,0)
! /TREADMILL_SPEED=0.0
;

! Kinetics related events
Subtract_Signals
/SIGNAL_TYPES=LINK_MODEL_BASED
! /SIGNAL_FOLDER=ORIGINAL
/SIGNAL_NAMES=Lead_Leg_GRF+Back_Leg_GRF
/COMPONENT_SEQUENCE=Z
! /RESULT_FOLDER=PROCESSED
/RESULT_NAME=Lead_Trail_Vert_GRF
;

! Lead foot committment - Vrt GRF 50/50	(which is when both feet have even weight distribution found from force plate). We take first ascending zero crossing between Lead_Foot_Off and Contact
Event_Threshold
/RESULT_EVENT_NAME=Lead_Comm
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Lead_Trail_Vert_GRF
/SIGNAL_COMPONENTS=X
! /FRAME_OFFSET=0
! /TIME_OFFSET=
/EVENT_SEQUENCE=Footstrike+Release
! /EXCLUDE_EVENTS=
! /EVENT_SEQUENCE_INSTANCE=0
! /EVENT_SUBSEQUENCE=
! /SUBSEQUENCE_EXCLUDE_EVENTS=
! /EVENT_SUBSEQUENCE_INSTANCE=0
/EVENT_INSTANCE=1
/THRESHOLD=0
/ON_ASCENT=TRUE
/ON_DESCENT=FALSE
/FRAME_WINDOW=1
! /ENSURE_FRAMES_BEFORE=FALSE
! /ENSURE_FRAMES_AFTER=FALSE
;

! Create event 10 frames after Lead_Comm. Used to define feet position for COM/COP 2d graph
Event_Copy
/EVENT_NAME=Lead_Comm
/NEW_EVENT_NAME=Lead_Comm_10fr
! /EVENT_INSTANCE=0
! /EVENT_INSTANCE_AS_LIST=FALSE
! /RANGE_INSTANCE=0
! /EVENT_SEQUENCE=
! /EXCLUDE_EVENTS=
! /START_AT_EVENT=
! /END_AT_EVENT=
/FRAME_OFFSET=10
! /TIME_OFFSET=
! /PERCENT_OFFSET=
;

!-----------------------------------------------------------
! Shoulder and Elbow Torques, Shoulder Force
! Just from inertial properties - Ball is not included in the model currently
!-----------------------------------------------------------

 
	Lowpass_Filter
	/SIGNAL_TYPES=LINK_MODEL_BASED
	/SIGNAL_FOLDER=ORIGINAL
	/SIGNAL_NAMES=Shoulder Torque_XYZ+Shoulder Torque+Elbow Torque+Elbow Torque_Nm
	! /RESULT_FOLDER=PROCESSED
	! /RESULT_SUFFIX=
	! /FILTER_CLASS=BUTTERWORTH
	/FREQUENCY_CUTOFF=20 
	! /NUM_REFLECTED=6
	! /NUM_EXTRAPOLATED=0
	! /TOTAL_BUFFER_SIZE=6
	! /NUM_BIDIRECTIONAL_PASSES=1
	;
 


 
	Lowpass_Filter
	/SIGNAL_TYPES=LINK_MODEL_BASED
	/SIGNAL_FOLDER=ORIGINAL
	/SIGNAL_NAMES=Shoulder Force+Shoulder Force_N+Elbow Force
	! /RESULT_FOLDER=PROCESSED
	! /RESULT_SUFFIX=
	! /FILTER_CLASS=BUTTERWORTH
	/FREQUENCY_CUTOFF=20 
	! /NUM_REFLECTED=6
	! /NUM_EXTRAPOLATED=0
	! /TOTAL_BUFFER_SIZE=6
	! /NUM_BIDIRECTIONAL_PASSES=1
	;
 

! Shoulder Distraction force is the Magnitude of the shoulder force
! Magnitude of the Elbow force
Signal_Magnitude
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Force+Elbow Force
! /RESULT_FOLDERS=PROCESSED
/RESULT_NAME=_Mag
/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
;

! Max Shoulder Horz Add Torque (usually around max ext rot of shoulder)
Event_Global_Minimum
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_NAMES=Shoulder Torque
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=Max_Shoulder_Hor_Add_Torque
/SELECT_X=TRUE
! /SELECT_Y=FALSE
! /SELECT_Z=FALSE
/START_AT_EVENT=Footstrike
/END_AT_EVENT=Release
;

Event_Global_Minimum
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_NAMES=Shoulder Torque_XYZ
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=Max_Shoulder_Abd_Torque
! /SELECT_X=FALSE
/SELECT_Y=TRUE
! /SELECT_Z=FALSE
/START_AT_EVENT=Footstrike
/END_AT_EVENT=Release
;

Event_Global_Maximum
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_NAMES=Shoulder Torque
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=Max_Shoulder_IntRot_Torque
! /SELECT_X=FALSE
! /SELECT_Y=FALSE
/SELECT_Z=TRUE
/START_AT_EVENT=Footstrike
/END_AT_EVENT=Release
;

Event_Global_Maximum
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_NAMES=Shoulder Force
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=Max_Shoulder_Abd_Force
! /SELECT_X=FALSE
/SELECT_Y=TRUE
! /SELECT_Z=FALSE
/START_AT_EVENT=Footstrike
/END_AT_EVENT=Release
;

Event_Global_Maximum
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_NAMES=Shoulder Force_N
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=Max_Shoulder_Abd_Force_N
! /SELECT_X=FALSE
/SELECT_Y=TRUE
! /SELECT_Z=FALSE
/START_AT_EVENT=Footstrike
/END_AT_EVENT=Release
;

! Max Elbow Flex Torque - usually occurs at ball release
Event_Global_Minimum
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_NAMES=Elbow Torque
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=Max_Elbow_Flex_Torque
/SELECT_X=TRUE
! /SELECT_Y=FALSE
!/SELECT_Z=FALSE
/START_AT_EVENT=Footstrike
/END_AT_EVENT=Release
;

! Max Elbow Varus Torque - usually occurs at max ext rot shoulder
Event_Global_Maximum
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_NAMES=Elbow Torque
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=Max_Elbow_Varus_Torque
!/SELECT_X=FALSE
/SELECT_Y=TRUE
!/SELECT_Z=FALSE
/START_AT_EVENT=Footstrike
/END_AT_EVENT=Release
;

 
	!GRF
	Signal_Magnitude
	 /SIGNAL_TYPES=LINK_MODEL_BASED
	 ! /SIGNAL_FOLDER=ORIGINAL
	 /SIGNAL_NAMES=Lead_Leg_GRF+Back_Leg_GRF
	 ! /RESULT_FOLDERS=PROCESSED
	 /RESULT_NAME=_mag
	 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
	;

	Evaluate_Expression
	 
		/EXPRESSION=DERIVED::PROCESSED::Lead_Leg_GRF_mag / (METRIC::PROCESSED::MASS * 9.81)
	 
	! /RESULT_TYPES=DERIVED
	! /RESULT_FOLDERS=PROCESSED
	/RESULT_NAME=Lead_Leg_GRF_mag
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	Evaluate_Expression
	 
		/EXPRESSION=DERIVED::PROCESSED::Back_Leg_GRF_mag / (METRIC::PROCESSED::MASS * 9.81)
	 
	! /RESULT_TYPES=DERIVED
	! /RESULT_FOLDERS=PROCESSED
	/RESULT_NAME=Back_Leg_GRF_mag
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	Evaluate_Expression
	 
		/EXPRESSION=LINK_MODEL_BASED::ORIGINAL::Lead_Leg_GRF / (METRIC::PROCESSED::MASS * 9.81)
	 
	/RESULT_NAME=Lead_Leg_GRF
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=PROCESSED
	;

	Evaluate_Expression
	 
		/EXPRESSION=LINK_MODEL_BASED::ORIGINAL::Back_Leg_GRF / (METRIC::PROCESSED::MASS * 9.81)
	 
	/RESULT_NAME=Back_Leg_GRF
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=PROCESSED
	;

	Metric_Maximum
	! /RESULT_METRIC_FOLDER=PROCESSED
	/RESULT_METRIC_NAME=_max
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
	/SIGNAL_TYPES=DERIVED+DERIVED+DERIVED+DERIVED
	/SIGNAL_FOLDER=PROCESSED+PROCESSED+PROCESSED+PROCESSED
	/SIGNAL_NAMES=Lead_Leg_GRF_mag+Back_Leg_GRF_mag+Lead_Leg_GRF+Back_Leg_GRF
	! /COMPONENT_SEQUENCE=
	/EVENT_SEQUENCE=SETUP+Release100msAfter
	/EXCLUDE_EVENTS=
	! /GENERATE_MEAN_AND_STDDEV=TRUE
	! /APPEND_TO_EXISTING_VALUES=FALSE
	! /CREATE_GLOBAL_MAXIMUM=FALSE
	;
	
	Metric_Minimum
	! /RESULT_METRIC_FOLDER=PROCESSED
	/RESULT_METRIC_NAME=_min
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=PROCESSED
	/SIGNAL_NAMES=Lead_Leg_GRF+Back_Leg_GRF
	! /COMPONENT_SEQUENCE=
	/EVENT_SEQUENCE=SETUP+Release100msAfter
	/EXCLUDE_EVENTS=
	! /GENERATE_MEAN_AND_STDDEV=TRUE
	! /APPEND_TO_EXISTING_VALUES=FALSE
	! /CREATE_GLOBAL_MAXIMUM=FALSE
	;
	
	! Lead Leg impulse
	Metric_Integrate
	! /RESULT_METRIC_FOLDER=PROCESSED
	/RESULT_METRIC_NAME=_impulse
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=PROCESSED
	/SIGNAL_NAMES=Lead_Leg_GRF_mag
	/COMPONENT_SEQUENCE=ALL
	/EVENT_SEQUENCE=Footstrike+Max_Shoulder_Rot
	/EXCLUDE_EVENTS=
	/SEQUENCE_PERCENT_START=
	/SEQUENCE_PERCENT_END=
	! /GENERATE_MEAN_AND_STDDEV=TRUE
	! /APPEND_TO_EXISTING_VALUES=FALSE
	;
	
	Event_Between
    /NEW_EVENT_NAME=Midpoint_FS_Release
    ! /RANGE_INSTANCE=0
    /EVENT_SEQUENCE=FOOTSTRIKE+RELEASE
    ! /EXCLUDE_EVENTS=
    /FRAME_OFFSET=
    ! /TIME_OFFSET=
    /PERCENT_OFFSET=50
    ;

    Metric_Signal_Value_At_Event
    /SIGNAL_TYPES=DERIVED
    /SIGNAL_FOLDER=PROCESSED
    /SIGNAL_NAMES=Lead_Leg_GRF_mag
    ! /RESULT_METRIC_FOLDER=PROCESSED
    /RESULT_METRIC_NAME=Lead_Leg_GRF_mag_Midpoint_FS_Release
    ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
    ! /SIGNAL_COMPONENTS=
    /COMPONENT_SEQUENCE=ALL
    /EVENT_NAME=Midpoint_FS_Release
    ! /EVENT_INSTANCE=0
    /GENERATE_MEAN_AND_STDDEV=TRUE
    ! /APPEND_TO_EXISTING_VALUES=FALSE
    ! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
    ! /RETAIN_NO_DATA_VALUES=FALSE
    ;
	
	! Lead Leg impulse
	Metric_Integrate
	! /RESULT_METRIC_FOLDER=PROCESSED
	/RESULT_METRIC_NAME=_impulse_Midpoint_FS_Release
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=PROCESSED
	/SIGNAL_NAMES=Lead_Leg_GRF_mag
	/COMPONENT_SEQUENCE=ALL
	/EVENT_SEQUENCE=Footstrike+Midpoint_FS_Release
	/EXCLUDE_EVENTS=
	/SEQUENCE_PERCENT_START=
	/SEQUENCE_PERCENT_END=
	! /GENERATE_MEAN_AND_STDDEV=TRUE
	! /APPEND_TO_EXISTING_VALUES=FALSE
	;

 

!Torque calculations
Metric_Signal_Value_At_Event
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Torque
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Max_Shoulder_Hor_Add_Torque
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=X
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Shoulder_Hor_Add_Torque
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;
	
Metric_Signal_Value_At_Event
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Torque
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Max_Shoulder_Abd_Torque
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Y
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Shoulder_Abd_Torque
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;
	
Metric_Signal_Value_At_Event
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Torque
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Max_Shoulder_IntRot_Torque
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Z
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Shoulder_IntRot_Torque
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;
	
Metric_Signal_Value_At_Event
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Elbow Torque+Elbow Torque_Nm
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Max_Elbow_Flex_Torque+Max_Elbow_Flex_Torque_Nm
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=X
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Elbow_Flex_Torque
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Elbow Torque+Elbow Torque_Nm
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Max_Elbow_Varus_Torque+Max_Elbow_Varus_Torque_Nm
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Y
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Elbow_Varus_Torque
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

! Max Shoulder Distraction Force (usualy near ball release) to make sure we get it end event is Release10msAfter
Event_Global_Maximum
/SIGNAL_TYPES=DERIVED
/SIGNAL_NAMES=Shoulder Force_Mag
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=Max_Shoulder_Dist_Force
/SELECT_X=TRUE
! /SELECT_Y=FALSE
!/SELECT_Z=FALSE
/START_AT_EVENT=Footstrike
/END_AT_EVENT=Release100msAfter
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Force_Mag
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Max_Shoulder_Dist_Force
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=X
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Shoulder_Dist_Force
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Force_Mag
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Shoulder_Dist_Force@Footstrike
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=X
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Footstrike
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Force_Mag
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Shoulder_Dist_Force@Max_Shoulder_Rot
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=X
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Shoulder_Rot
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Force_Mag
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Shoulder_Dist_Force@Release
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=X
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Release
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Force_Mag
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Shoulder_Dist_Force@Max_Shoulder_Int_Rot_FollowThru
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=X
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Shoulder_Int_Rot_FollowThru
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Force
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Shoulder_Force_Abd@Max_Shoulder_Abd_Force
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Y
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Shoulder_Abd_Force
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=LINK_MODEL_BASED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Force_N
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Shoulder_Force_Abd_N@Max_Shoulder_Abd_Force_N
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Y
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Shoulder_Abd_Force_N
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Torque
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Shoulder_Torque@Footstrike
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Z
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Footstrike
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Torque
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Shoulder_Torque@Max_Shoulder_Rot
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Z
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Shoulder_Rot
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Torque
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Shoulder_Torque@Release
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Z
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Release
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Shoulder Torque
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Shoulder_Torque@Max_Shoulder_Int_Rot_FollowThru
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Z
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Shoulder_Int_Rot_FollowThru
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Elbow Torque+Elbow Torque_Nm
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Elbow_Torque@Footstrike+Elbow_Torque_Nm@Footstrike
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Y
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Footstrike
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Elbow Torque+Elbow Torque_Nm
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Elbow_Torque@Max_Shoulder_Rot+Elbow_Torque_Nm@Max_Shoulder_Rot
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Y
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Shoulder_Rot
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Elbow Torque+Elbow Torque_Nm
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Elbow_Torque@Release+Elbow_Torque_Nm@Release
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Y
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Release
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=Link_Model_Based
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Elbow Torque+Elbow Torque_Nm
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Elbow_Torque@Max_Shoulder_Int_Rot_FollowThru+Elbow_Torque_Nm@Max_Shoulder_Int_Rot_FollowThru
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=Y
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Shoulder_Int_Rot_FollowThru
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

! abs value and convert to %
Evaluate_Expression
/EXPRESSION=abs(METRIC::PROCESSED::Max_Shoulder_Dist_Force)*100
/RESULT_NAME=Max_Shoulder_Dist_Force_Per
/RESULT_TYPE=METRIC
! /RESULT_FOLDER=PROCESSED
;

Evaluate_Expression
/EXPRESSION=EVENT_LABEL::ORIGINAL::Max_Shoulder_Dist_Force-EVENT_LABEL::ORIGINAL::MaxKneeHeight
/RESULT_NAME=Max_Shoulder_Dist_ForceTime
/RESULT_TYPE=METRIC
/RESULT_FOLDER=TIMING
;

Evaluate_Expression
/EXPRESSION=1000 * (EVENT_LABEL::ORIGINAL::Max_Shoulder_Dist_Force-EVENT_LABEL::ORIGINAL::MaxKneeHeight)
/RESULT_NAME=Max_Shoulder_Dist_ForceTime_ms
/RESULT_TYPE=METRIC
/RESULT_FOLDER=TIMING
;

! Max Elbow Force (usually near ball release)
Event_Global_Maximum
/SIGNAL_TYPES=DERIVED
/SIGNAL_NAMES=Elbow Force_Mag
/SIGNAL_FOLDER=PROCESSED
/EVENT_NAME=Max_Elbow_Force
/SELECT_X=TRUE
! /SELECT_Y=FALSE
!/SELECT_Z=FALSE
/START_AT_EVENT=Footstrike
/END_AT_EVENT=Release
;

Metric_Signal_Value_At_Event
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Elbow Force_Mag
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Max_Elbow_Force
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=X
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Max_Elbow_Force
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

Evaluate_Expression
/EXPRESSION=EVENT_LABEL::ORIGINAL::Max_Elbow_Force-EVENT_LABEL::ORIGINAL::MaxKneeHeight
/RESULT_NAME=Max_Elbow_ForceTime
/RESULT_TYPE=METRIC
/RESULT_FOLDER=TIMING
;

Evaluate_Expression
/EXPRESSION=1000 * (EVENT_LABEL::ORIGINAL::Max_Elbow_Force-EVENT_LABEL::ORIGINAL::MaxKneeHeight)
/RESULT_NAME=Max_Elbow_ForceTime_ms
/RESULT_TYPE=METRIC
/RESULT_FOLDER=TIMING
;

! Force of the ball - replicated by F=ma. Mass of the ball is 0.145 kg and we will use the acceleration of the hand for acceleration of the ball
Signal_Magnitude
/SIGNAL_TYPES=KINETIC_KINEMATIC
/SIGNAL_FOLDER=::THROW_SIDE_LETTER&HA
/SIGNAL_NAMES=CGAcc
! /RESULT_FOLDERS=PROCESSED
/RESULT_NAME=Ball_Acc_Mag
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=
;

! F=ma normalized to BW in Newtons
Evaluate_Expression
/EXPRESSION=(0.145*DERIVED::Processed::Ball_Acc_Mag)/METRIC::Processed::MASS_N::X
/RESULT_NAME=Force_Ball
/RESULT_TYPE=DERIVED
/RESULT_FOLDER=Processed
;

 
	Lowpass_Filter
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=PROCESSED
	/SIGNAL_NAMES=Force_Ball
	! /RESULT_FOLDER=PROCESSED
	! /RESULT_SUFFIX=
	! /FILTER_CLASS=BUTTERWORTH
	/FREQUENCY_CUTOFF=20 
	! /NUM_REFLECTED=6
	! /NUM_EXTRAPOLATED=0
	! /TOTAL_BUFFER_SIZE=6
	! /NUM_BIDIRECTIONAL_PASSES=1
	;
 


Metric_Signal_Value_At_Event
/SIGNAL_TYPES=DERIVED
/SIGNAL_FOLDER=PROCESSED
/SIGNAL_NAMES=Force_Ball
! /RESULT_METRIC_FOLDER=PROCESSED
/RESULT_METRIC_NAME=Force_Ball@Release
! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
/SIGNAL_COMPONENTS=X
! /COMPONENT_SEQUENCE=
/EVENT_NAME=Release
/GENERATE_MEAN_AND_STDDEV=FALSE
! /APPEND_TO_EXISTING_VALUES=FALSE
! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
! /RETAIN_NO_DATA_VALUES=FALSE
;

!------------------
! Means
!------------------
!Loop through file tags
For_Each
/ITERATION_PARAMETER_NAME=FILE_TAG
/ITEMS=FastBall+Pitch 
;

	Select_Active_File
	 /FILE_NAME=::FILE_TAG
	 ! /QUERY=
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Max_Elbow_ForceTime+GLOBAL::Max_Elbow_ForceTime_ms+GLOBAL::Max_Shoulder_Dist_ForceTime+GLOBAL::Max_Shoulder_Dist_ForceTime_ms
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Max_Elbow_ForceTime+Max_Elbow_ForceTime_ms+Max_Shoulder_Dist_ForceTime+Max_Shoulder_Dist_ForceTime_ms
	 /SIGNAL_FOLDER=TIMING+TIMING+TIMING+TIMING
	 /SIGNAL_COMPONENTS=X+X+X+X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Max_Shoulder_Hor_Add_Torque+GLOBAL::Max_Shoulder_Abd_Torque+GLOBAL::Max_Shoulder_IntRot_Torque+GLOBAL::Shoulder_Torque@Footstrike+GLOBAL::Shoulder_Torque@Max_Shoulder_Rot+GLOBAL::Shoulder_Torque@Release+GLOBAL::Shoulder_Torque@Max_Shoulder_Int_Rot_FollowThru
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Max_Shoulder_Hor_Add_Torque+Max_Shoulder_Abd_Torque+Max_Shoulder_IntRot_Torque+Shoulder_Torque@Footstrike+Shoulder_Torque@Max_Shoulder_Rot+Shoulder_Torque@Release+Shoulder_Torque@Max_Shoulder_Int_Rot_FollowThru
	 /SIGNAL_FOLDER=Processed+Processed+Processed+Processed+Processed+Processed+Processed
	 /SIGNAL_COMPONENTS=X+X+X+X+X+X+X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=TRUE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Max_Elbow_Varus_Torque+GLOBAL::Elbow_Torque@Footstrike+GLOBAL::Elbow_Torque@Max_Shoulder_Rot+GLOBAL::Elbow_Torque@Release+GLOBAL::Elbow_Torque@Max_Shoulder_Int_Rot_FollowThru
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Max_Elbow_Varus_Torque+Elbow_Torque@Footstrike+Elbow_Torque@Max_Shoulder_Rot+Elbow_Torque@Release+Elbow_Torque@Max_Shoulder_Int_Rot_FollowThru
	 /SIGNAL_FOLDER=Processed+Processed+Processed+Processed+Processed
	 /SIGNAL_COMPONENTS=X+X+X+X+X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=TRUE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Force_Ball@Release+GLOBAL::Max_Elbow_Force+GLOBAL::Max_Shoulder_Dist_Force+GLOBAL::Shoulder_Dist_Force@Footstrike+GLOBAL::Shoulder_Dist_Force@Max_Shoulder_Rot+GLOBAL::Shoulder_Dist_Force@Release+GLOBAL::Shoulder_Dist_Force@Max_Shoulder_Int_Rot_FollowThru
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Force_Ball@Release+Max_Elbow_Force+Max_Shoulder_Dist_Force+Shoulder_Dist_Force@Footstrike+Shoulder_Dist_Force@Max_Shoulder_Rot+Shoulder_Dist_Force@Release+Shoulder_Dist_Force@Max_Shoulder_Int_Rot_FollowThru
	 /SIGNAL_FOLDER=Processed+Processed+Processed+Processed+Processed+Processed+Processed
	 /SIGNAL_COMPONENTS=X+X+X+X+X+X+X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=TRUE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
End_For_Each
/ITERATION_PARAMETER_NAME=FILE_TAG
;
! We assume that if FP1 exists, we can calculate COm AND COP path.
Conditional_Statement
/ITERATION_PARAMETER_NAME=force_exists
/EXPRESSION=Data_Exists(FORCE::ORIGINAL::FP1)
! /AS_INTEGER=TRUE
;

	!-------------- compute metric data for COM ----------------
	!calculate COM relative to ball (to get the same coordinates as COP wrt Ball)

	Select_Active_File
	/FILE_NAME=ALL_FILES
	/QUERY=SWING | Pitch
	;

	! Detect Lead heel position.
	 
		Metric_Signal_Value_At_Event
		/SIGNAL_TYPES=TARGET 
		/SIGNAL_FOLDER=PROCESSED 
		/SIGNAL_NAMES=::LeadHeelBack
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=Lead Heel_position
		! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
		! /SIGNAL_COMPONENTS=
		/COMPONENT_SEQUENCE=ALL
		/EVENT_NAME=Release
		! /EVENT_INSTANCE=0
		! /GENERATE_MEAN_AND_STDDEV=TRUE
		! /APPEND_TO_EXISTING_VALUES=FALSE
		! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
		! /RETAIN_NO_DATA_VALUES=FALSE
		;
	 

	Evaluate_Expression
	 
		/EXPRESSION=(LINK_MODEL_BASED::ORIGINAL::COM_displacement-METRIC::PROCESSED::Lead Heel_position) * 39.3701
	 
	/RESULT_NAME=COM wrt Lead Heel_v3d
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COM
	;

	Evaluate_Expression
	/EXPRESSION=(LINK_MODEL_BASED::ORIGINAL::COM_displacement - METRIC::PROCESSED::Lead Heel_position)
	/RESULT_NAME=COM wrt Lead Heel
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COM
	;

	! COM velocity
	First_Derivative
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=COM
	/SIGNAL_NAMES=COM wrt Lead Heel_v3d+COM wrt Lead Heel
	/RESULT_TYPES=DERIVED
	/RESULT_FOLDER=COM
	! /RESULT_NAMES=
	/RESULT_SUFFIX=_vel
	;

	 

	!COM velocity magnitude
	Evaluate_Expression
	/EXPRESSION=length(DERIVED::COM::COM wrt Lead Heel_v3d_vel)
	/RESULT_NAME=COM wrt Lead Heel_v3d_vel_mag
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COM
	;

	For_Each
	/ITERATION_PARAMETER_NAME=sig
	! /ITERATION_PARAMETER_COUNT_NAME=
	/ITEMS=COM wrt Lead Heel_v3d+COM wrt Lead Heel_v3d_vel+COM wrt Lead Heel+COM wrt Lead Heel_vel
	;

		Multiply_Signals_By_Constant
		/SIGNAL_TYPES=DERIVED
		/SIGNAL_FOLDER=COM
		/SIGNAL_NAMES=::sig
		/RESULT_TYPES=DERIVED
		/RESULT_FOLDER=COM
		/RESULT_NAME=_plot
		/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
		/SIGNAL_COMPONENTS=X
		/CONSTANT=1 
		;

		Multiply_Signals_By_Constant
		/SIGNAL_TYPES=DERIVED
		/SIGNAL_FOLDER=COM
		/SIGNAL_NAMES=&::sig&_plot
		/RESULT_TYPES=DERIVED
		/RESULT_FOLDER=COM
		! /RESULT_NAME=
		! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
		/SIGNAL_COMPONENTS=Y
		/CONSTANT=1 
		;

	End_For_Each
	/ITERATION_PARAMETER_NAME=sig
	;

	!Foot position (so that it can be drawn together with COP)
	For_Each
	/ITERATION_PARAMETER_NAME=LEFT_LABEL
	/ITEMS=L&::HeelBack&+L&::Forefoot2&
	;

		Metric_Signal_Value_At_Event
		/RESULT_METRIC_NAME=Left_Foot
		/RESULT_METRIC_FOLDER=COM
		/SIGNAL_TYPES=TARGET 
		/SIGNAL_FOLDER=PROCESSED 
		/SIGNAL_NAMES=::LEFT_LABEL
		/EVENT_NAME=Lead_Comm
		/GENERATE_MEAN_AND_STDDEV=FALSE
		/APPEND_TO_EXISTING_VALUES=TRUE
		! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
		! /RETAIN_NO_DATA_VALUES=FALSE
		;

	End_For_Each
	/ITERATION_PARAMETER_NAME=LEFT_LABEL
	;

	For_Each
	/ITERATION_PARAMETER_NAME=RIGHT_LABEL
	/ITEMS=R&::HeelBack&+R&::Forefoot2&
	;

		Metric_Signal_Value_At_Event
		/RESULT_METRIC_NAME=Right_Foot
		/RESULT_METRIC_FOLDER=COM
		/SIGNAL_TYPES=TARGET 
		/SIGNAL_FOLDER=PROCESSED 
		/SIGNAL_NAMES=::RIGHT_LABEL
		/EVENT_NAME=Lead_Comm
		/GENERATE_MEAN_AND_STDDEV=FALSE
		/APPEND_TO_EXISTING_VALUES=TRUE
		! /GENERATE_VECTOR_LENGTH_METRIC=FALSE
		! /RETAIN_NO_DATA_VALUES=FALSE
		;

	End_For_Each
	/ITERATION_PARAMETER_NAME=RIGHT_LABEL
	;

	!Turn of zero baseline correction based on range of frames (in case it was accidentally turned on in QTM).
	Modify_Force_Platform_Parameters
	/FP_ZEROS= 
	;

	! --------------------------
	! Force Structure
	! --------------------------
	
	! For Hitting we expect 2 FPs to exist
	! For Pitching we expect 3 FPS to exist

	! Get FP count
	Metric_From_C3D_Parameter
	/METRIC_NAME=fp_count
	/PARAMETER_GROUP=FORCE_PLATFORM
	/PARAMETER_NAME=USED
	;

	Metric_From_C3D_Parameter
	/METRIC_NAME=FP_CORNERS
	/PARAMETER_GROUP=FORCE_PLATFORM
	/PARAMETER_NAME=CORNERS
	;

	Set_Pipeline_Parameter_From_For_Loop
	/PARAMETER_NAME=fp_numbers
	/PARAMETER_INDEX_START=1
	/PARAMETER_INDEX_END=METRIC::PROCESSED::fp_count
	/PARAMETER_INDEX_STEP=1
	! /PARAMETER_INDEX_TYPE=INTEGER
	;

	!add FP corners
	Set_Pipeline_Parameter
	/PARAMETER_NAME=corner_no
	/PARAMETER_VALUE=0
	;

	!FP corners coordinates
	For_Each
	/ITERATION_PARAMETER_NAME=fp
	!/ITERATION_PARAMETER_COUNT_NAME=
	/ITEMS=::fp_numbers
	;

		Evaluate_Expression
		/EXPRESSION=vector(METRIC::PROCESSED::FP_CORNERS[&::corner_no& + 1],METRIC::PROCESSED::FP_CORNERS[&::corner_no& + 2],METRIC::PROCESSED::FP_CORNERS[&::corner_no& + 3])
		/RESULT_NAME=FP&::fp&_CORNER1
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=FORCE
		;

		Evaluate_Expression
		/EXPRESSION=vector(METRIC::PROCESSED::FP_CORNERS[&::corner_no& + 4],METRIC::PROCESSED::FP_CORNERS[&::corner_no& + 5],METRIC::PROCESSED::FP_CORNERS[&::corner_no& + 6])
		/RESULT_NAME=FP&::fp&_CORNER2
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=FORCE
		;

		Evaluate_Expression
		/EXPRESSION=vector(METRIC::PROCESSED::FP_CORNERS[&::corner_no& + 7],METRIC::PROCESSED::FP_CORNERS[&::corner_no& + 8],METRIC::PROCESSED::FP_CORNERS[&::corner_no& + 9])
		/RESULT_NAME=FP&::fp&_CORNER3
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=FORCE
		;

		Evaluate_Expression
		/EXPRESSION=vector(METRIC::PROCESSED::FP_CORNERS[&::corner_no& + 10],METRIC::PROCESSED::FP_CORNERS[&::corner_no& + 11],METRIC::PROCESSED::FP_CORNERS[&::corner_no& + 12])
		/RESULT_NAME=FP&::fp&_CORNER4
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=FORCE
		;

		! Transform to Virtual Lab. Wil be transformed back to LAB later
		Transform_Data_Coordinate_System
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=FORCE
		/SIGNAL_NAMES=FP&::fp&_CORNER1+FP&::fp&_CORNER2+FP&::fp&_CORNER3+FP&::fp&_CORNER4
!		! /FROM_SEGMENT_CS=LAB
		/TO_SEGMENT_CS=Virtual Lab
		/RESULT_TYPES=METRIC
		/RESULT_FOLDERS=FORCE
		/RESULT_NAME=_VLab
		! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
		! /ORIENTATION_ONLY=FALSE
		! /USE_DATA_RATE=FALSE
		;

		Set_Pipeline_Parameter_From_Expression
		/PARAMETER_NAME=corner_no
		/EXPRESSION=&::corner_no& + 12
		! /AS_INTEGER=TRUE
		;
		
	End_For_Each
	/ITERATION_PARAMETER_NAME=fp
	;

	! Two FPs ----------------------------
	Conditional_Statement
	/ITERATION_PARAMETER_NAME=2FPs
	/EXPRESSION=METRIC::PROCESSED::fp_count == 2
	! /AS_INTEGER=TRUE
	;

		!Find corners of force structure (it is assumed that only two FPs exist and they are leveled)
		!-------------------------------
		!find max and min X coordinate
		Evaluate_Expression
		/EXPRESSION=transpose(vector(METRIC::FORCE::FP1_CORNER1_VLab::X,METRIC::FORCE::FP1_CORNER2_VLab::X,METRIC::FORCE::FP1_CORNER3_VLab::X,METRIC::FORCE::FP1_CORNER4_VLab::X,METRIC::FORCE::FP2_CORNER1_VLab::X,METRIC::FORCE::FP2_CORNER2_VLab::X,METRIC::FORCE::FP2_CORNER3_VLab::X,METRIC::FORCE::FP2_CORNER4_VLab::X))
		/RESULT_NAME=FP_CORNER_X
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Metric_Maximum
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=_max
		/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=FP_CORNER_X
		/SIGNAL_COMPONENTS=
		/COMPONENT_SEQUENCE=ALL
		/EVENT_SEQUENCE=
		/EXCLUDE_EVENTS=
		! /SEQUENCE_PERCENT_START=0
		! /SEQUENCE_PERCENT_END=100
		/GENERATE_MEAN_AND_STDDEV=FALSE
		! /APPEND_TO_EXISTING_VALUES=FALSE
		/CREATE_GLOBAL_MAXIMUM=TRUE
		;

		Metric_Minimum
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=_min
		/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=FP_CORNER_X
		/SIGNAL_COMPONENTS=
		/COMPONENT_SEQUENCE=ALL
		/EVENT_SEQUENCE=
		/EXCLUDE_EVENTS=
		! /SEQUENCE_PERCENT_START=0
		! /SEQUENCE_PERCENT_END=100
		/GENERATE_MEAN_AND_STDDEV=FALSE
		! /APPEND_TO_EXISTING_VALUES=FALSE
		/CREATE_GLOBAL_MINIMUM=TRUE
		;

		!find max and min Y coordinate
		Evaluate_Expression
		/EXPRESSION=transpose(vector(METRIC::FORCE::FP1_CORNER1_VLab::Y,METRIC::FORCE::FP1_CORNER2_VLab::Y,METRIC::FORCE::FP1_CORNER3_VLab::Y,METRIC::FORCE::FP1_CORNER4_VLab::Y,METRIC::FORCE::FP2_CORNER1_VLab::Y,METRIC::FORCE::FP2_CORNER2_VLab::Y,METRIC::FORCE::FP2_CORNER3_VLab::Y,METRIC::FORCE::FP2_CORNER4_VLab::Y))
		/RESULT_NAME=FP_CORNER_Y
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Metric_Maximum
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=_max
		/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=FP_CORNER_Y
		/SIGNAL_COMPONENTS=
		/COMPONENT_SEQUENCE=ALL
		/EVENT_SEQUENCE=
		/EXCLUDE_EVENTS=
		! /SEQUENCE_PERCENT_START=0
		! /SEQUENCE_PERCENT_END=100
		/GENERATE_MEAN_AND_STDDEV=FALSE
		! /APPEND_TO_EXISTING_VALUES=FALSE
		/CREATE_GLOBAL_MAXIMUM=TRUE
		;

		Metric_Minimum
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=_min
		/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=FP_CORNER_Y
		/SIGNAL_COMPONENTS=
		/COMPONENT_SEQUENCE=ALL
		/EVENT_SEQUENCE=
		/EXCLUDE_EVENTS=
		! /SEQUENCE_PERCENT_START=0
		! /SEQUENCE_PERCENT_END=100
		/GENERATE_MEAN_AND_STDDEV=FALSE
		! /APPEND_TO_EXISTING_VALUES=FALSE
		/CREATE_GLOBAL_MINIMUM=TRUE
		;

		!find mean Z coordinate
		Evaluate_Expression
		/EXPRESSION=transpose(vector(METRIC::FORCE::FP1_CORNER1_VLab::Z,METRIC::FORCE::FP1_CORNER2_VLab::Z,METRIC::FORCE::FP1_CORNER3_VLab::Z,METRIC::FORCE::FP1_CORNER4_VLab::Z,METRIC::FORCE::FP2_CORNER1_VLab::Z,METRIC::FORCE::FP2_CORNER2_VLab::Z,METRIC::FORCE::FP2_CORNER3_VLab::Z,METRIC::FORCE::FP2_CORNER4_VLab::Z))
		/RESULT_NAME=FP_CORNER_Z
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Metric_Mean
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=_mean
		/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=FP_CORNER_Z
		/SIGNAL_COMPONENTS=
		/COMPONENT_SEQUENCE=ALL
		/EVENT_SEQUENCE=
		/EXCLUDE_EVENTS=
		! /SEQUENCE_PERCENT_START=0
		! /SEQUENCE_PERCENT_END=100
		! /GENERATE_MEAN_AND_STDDEV=TRUE
		! /APPEND_TO_EXISTING_VALUES=FALSE
		;

		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=FP_CORNER_X_max
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER_X_max
		;

		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=FP_CORNER_X_min
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER_X_min
		;

		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=FP_CORNER_Y_max
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER_Y_max
		;

		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=FP_CORNER_Y_min
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER_Y_min
		;

		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=FP_CORNER_Z_mean
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER_Z_mean
		;

		Metric_Explicit
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=FS_corner1
		/METRIC_VALUE=(&::FS_CORNER_X_max&+&::FS_CORNER_Y_max&+&::FS_CORNER_Z_mean&)
		;

		Metric_Explicit
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=FS_corner2
		/METRIC_VALUE=(&::FS_CORNER_X_min&+&::FS_CORNER_Y_max&+&::FS_CORNER_Z_mean&)
		;

		Metric_Explicit
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=FS_corner3
		/METRIC_VALUE=(&::FS_CORNER_X_min&+&::FS_CORNER_Y_min&+&::FS_CORNER_Z_mean&)
		;

		Metric_Explicit
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=FS_corner4
		/METRIC_VALUE=(&::FS_CORNER_X_max&+&::FS_CORNER_Y_min&+&::FS_CORNER_Z_mean&)
		;

		Transform_Data_Coordinate_System
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=FS_corner1+FS_corner2+FS_corner3+FS_corner4
		/FROM_SEGMENT_CS=Virtual Lab
		/TO_SEGMENT_CS=LAB
		/RESULT_TYPES=METRIC
		/RESULT_FOLDERS=PROCESSED
		/RESULT_NAME=FS_corner1+FS_corner2+FS_corner3+FS_corner4
		/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
		! /ORIENTATION_ONLY=FALSE
		! /USE_DATA_RATE=FALSE
		;

		! It is assumed that force structure consists of FP1 and FP2
		Modify_Force_Structure_Parameters
		/USED=1
		/TYPE=0
		/NUM_FP_IN=2
		/FP_INDEX=1+2
		/NUM_SURFACES_OUT=1
		/SPEED_VALUES=0
		! /SPEED_CHANNELS=
		! /SPEED_SCALES=
		/CORNER1=METRIC::PROCESSED::FS_corner1::X[1]+METRIC::PROCESSED::FS_corner1::Y[1]+METRIC::PROCESSED::FS_corner1::Z[1]
		/CORNER2=METRIC::PROCESSED::FS_corner2::X[1]+METRIC::PROCESSED::FS_corner2::Y[1]+METRIC::PROCESSED::FS_corner2::Z[1]
		/CORNER3=METRIC::PROCESSED::FS_corner3::X[1]+METRIC::PROCESSED::FS_corner3::Y[1]+METRIC::PROCESSED::FS_corner3::Z[1]
		/CORNER4=METRIC::PROCESSED::FS_corner4::X[1]+METRIC::PROCESSED::FS_corner4::Y[1]+METRIC::PROCESSED::FS_corner4::Z[1]
		/USE_FORCES_FOR_KINETICS=FALSE
		/COMBINE_INPUT_FORCES=TRUE
		! /UPDATE_C3D_FILE=FALSE
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=2FPs
	;

	! Three FPs ------------------------------
	Conditional_Statement
	/ITERATION_PARAMETER_NAME=3FPs
	/EXPRESSION=METRIC::PROCESSED::fp_count == 3
	! /AS_INTEGER=TRUE
	;

		! Find coordinates
		! FP1
		Evaluate_Expression
		/EXPRESSION=mean(transpose(mean(vector(METRIC::FORCE::FP1_CORNER1_VLab::X,METRIC::FORCE::FP1_CORNER2_VLab::X,METRIC::FORCE::FP1_CORNER3_VLab::X,METRIC::FORCE::FP1_CORNER4_VLab::X))))
		/RESULT_NAME=FP1_CORNERS_X_mean
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=maximum(transpose(mean(vector(METRIC::FORCE::FP1_CORNER1_VLab::X,METRIC::FORCE::FP1_CORNER2_VLab::X,METRIC::FORCE::FP1_CORNER3_VLab::X,METRIC::FORCE::FP1_CORNER4_VLab::X))))
		/RESULT_NAME=FP1_CORNERS_X_max
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=minimum(transpose(mean(vector(METRIC::FORCE::FP1_CORNER1_VLab::X,METRIC::FORCE::FP1_CORNER2_VLab::X,METRIC::FORCE::FP1_CORNER3_VLab::X,METRIC::FORCE::FP1_CORNER4_VLab::X))))
		/RESULT_NAME=FP1_CORNERS_X_min
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=mean(transpose(mean(vector(METRIC::FORCE::FP1_CORNER1_VLab::Y,METRIC::FORCE::FP1_CORNER2_VLab::Y,METRIC::FORCE::FP1_CORNER3_VLab::Y,METRIC::FORCE::FP1_CORNER4_VLab::Y))))
		/RESULT_NAME=FP1_CORNERS_Y_mean
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=maximum(transpose(mean(vector(METRIC::FORCE::FP1_CORNER1_VLab::Y,METRIC::FORCE::FP1_CORNER2_VLab::Y,METRIC::FORCE::FP1_CORNER3_VLab::Y,METRIC::FORCE::FP1_CORNER4_VLab::Y))))
		/RESULT_NAME=FP1_CORNERS_Y_max
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=minimum(transpose(mean(vector(METRIC::FORCE::FP1_CORNER1_VLab::Y,METRIC::FORCE::FP1_CORNER2_VLab::Y,METRIC::FORCE::FP1_CORNER3_VLab::Y,METRIC::FORCE::FP1_CORNER4_VLab::Y))))
		/RESULT_NAME=FP1_CORNERS_Y_min
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=maximum(transpose(mean(vector(METRIC::FORCE::FP1_CORNER1_VLab::Z,METRIC::FORCE::FP1_CORNER2_VLab::Z,METRIC::FORCE::FP1_CORNER3_VLab::Z,METRIC::FORCE::FP1_CORNER4_VLab::Z))))
		/RESULT_NAME=FP1_CORNERS_Z_max
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=minimum(transpose(mean(vector(METRIC::FORCE::FP1_CORNER1_VLab::Z,METRIC::FORCE::FP1_CORNER2_VLab::Z,METRIC::FORCE::FP1_CORNER3_VLab::Z,METRIC::FORCE::FP1_CORNER4_VLab::Z))))
		/RESULT_NAME=FP1_CORNERS_Z_min
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		! FP2
		Evaluate_Expression
		/EXPRESSION=mean(transpose(mean(vector(METRIC::FORCE::FP2_CORNER1_VLab::X,METRIC::FORCE::FP2_CORNER2_VLab::X,METRIC::FORCE::FP2_CORNER3_VLab::X,METRIC::FORCE::FP2_CORNER4_VLab::X))))
		/RESULT_NAME=FP2_CORNERS_X_mean
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=maximum(transpose(mean(vector(METRIC::FORCE::FP2_CORNER1_VLab::X,METRIC::FORCE::FP2_CORNER2_VLab::X,METRIC::FORCE::FP2_CORNER3_VLab::X,METRIC::FORCE::FP2_CORNER4_VLab::X))))
		/RESULT_NAME=FP2_CORNERS_X_max
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=minimum(transpose(mean(vector(METRIC::FORCE::FP2_CORNER1_VLab::X,METRIC::FORCE::FP2_CORNER2_VLab::X,METRIC::FORCE::FP2_CORNER3_VLab::X,METRIC::FORCE::FP2_CORNER4_VLab::X))))
		/RESULT_NAME=FP2_CORNERS_X_min
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=mean(transpose(mean(vector(METRIC::FORCE::FP2_CORNER1_VLab::Y,METRIC::FORCE::FP2_CORNER2_VLab::Y,METRIC::FORCE::FP2_CORNER3_VLab::Y,METRIC::FORCE::FP2_CORNER4_VLab::Y))))
		/RESULT_NAME=FP2_CORNERS_Y_mean
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=maximum(transpose(mean(vector(METRIC::FORCE::FP2_CORNER1_VLab::Y,METRIC::FORCE::FP2_CORNER2_VLab::Y,METRIC::FORCE::FP2_CORNER3_VLab::Y,METRIC::FORCE::FP2_CORNER4_VLab::Y))))
		/RESULT_NAME=FP2_CORNERS_Y_max
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=minimum(transpose(mean(vector(METRIC::FORCE::FP2_CORNER1_VLab::Y,METRIC::FORCE::FP2_CORNER2_VLab::Y,METRIC::FORCE::FP2_CORNER3_VLab::Y,METRIC::FORCE::FP2_CORNER4_VLab::Y))))
		/RESULT_NAME=FP2_CORNERS_Y_min
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=maximum(transpose(mean(vector(METRIC::FORCE::FP2_CORNER1_VLab::Z,METRIC::FORCE::FP2_CORNER2_VLab::Z,METRIC::FORCE::FP2_CORNER3_VLab::Z,METRIC::FORCE::FP2_CORNER4_VLab::Z))))
		/RESULT_NAME=FP2_CORNERS_Z_max
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=minimum(transpose(mean(vector(METRIC::FORCE::FP2_CORNER1_VLab::Z,METRIC::FORCE::FP2_CORNER2_VLab::Z,METRIC::FORCE::FP2_CORNER3_VLab::Z,METRIC::FORCE::FP2_CORNER4_VLab::Z))))
		/RESULT_NAME=FP2_CORNERS_Z_min
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		! FP3
		Evaluate_Expression
		/EXPRESSION=mean(transpose(mean(vector(METRIC::FORCE::FP3_CORNER1_VLab::X,METRIC::FORCE::FP3_CORNER2_VLab::X,METRIC::FORCE::FP3_CORNER3_VLab::X,METRIC::FORCE::FP3_CORNER4_VLab::X))))
		/RESULT_NAME=FP3_CORNERS_X_mean
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=maximum(transpose(mean(vector(METRIC::FORCE::FP3_CORNER1_VLab::X,METRIC::FORCE::FP3_CORNER2_VLab::X,METRIC::FORCE::FP3_CORNER3_VLab::X,METRIC::FORCE::FP3_CORNER4_VLab::X))))
		/RESULT_NAME=FP3_CORNERS_X_max
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=minimum(transpose(mean(vector(METRIC::FORCE::FP3_CORNER1_VLab::X,METRIC::FORCE::FP3_CORNER2_VLab::X,METRIC::FORCE::FP3_CORNER3_VLab::X,METRIC::FORCE::FP3_CORNER4_VLab::X))))
		/RESULT_NAME=FP3_CORNERS_X_min
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=mean(transpose(mean(vector(METRIC::FORCE::FP3_CORNER1_VLab::Y,METRIC::FORCE::FP3_CORNER2_VLab::Y,METRIC::FORCE::FP3_CORNER3_VLab::Y,METRIC::FORCE::FP3_CORNER4_VLab::Y))))
		/RESULT_NAME=FP3_CORNERS_Y_mean
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=maximum(transpose(mean(vector(METRIC::FORCE::FP3_CORNER1_VLab::Y,METRIC::FORCE::FP3_CORNER2_VLab::Y,METRIC::FORCE::FP3_CORNER3_VLab::Y,METRIC::FORCE::FP3_CORNER4_VLab::Y))))
		/RESULT_NAME=FP3_CORNERS_Y_max
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=minimum(transpose(mean(vector(METRIC::FORCE::FP3_CORNER1_VLab::Y,METRIC::FORCE::FP3_CORNER2_VLab::Y,METRIC::FORCE::FP3_CORNER3_VLab::Y,METRIC::FORCE::FP3_CORNER4_VLab::Y))))
		/RESULT_NAME=FP3_CORNERS_Y_min
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=maximum(transpose(mean(vector(METRIC::FORCE::FP3_CORNER1_VLab::Z,METRIC::FORCE::FP3_CORNER2_VLab::Z,METRIC::FORCE::FP3_CORNER3_VLab::Z,METRIC::FORCE::FP3_CORNER4_VLab::Z))))
		/RESULT_NAME=FP3_CORNERS_Z_max
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		Evaluate_Expression
		/EXPRESSION=minimum(transpose(mean(vector(METRIC::FORCE::FP3_CORNER1_VLab::Z,METRIC::FORCE::FP3_CORNER2_VLab::Z,METRIC::FORCE::FP3_CORNER3_VLab::Z,METRIC::FORCE::FP3_CORNER4_VLab::Z))))
		/RESULT_NAME=FP3_CORNERS_Z_min
		/RESULT_TYPE=METRIC
		/RESULT_FOLDER=PROCESSED
		;

		! Find rear FP
		Conditional_Statement
		/ITERATION_PARAMETER_NAME=rear_FP
		/EXPRESSION=((METRIC::PROCESSED::FP1_CORNERS_Y_mean < METRIC::PROCESSED::FP2_CORNERS_Y_mean) &::AMP& (METRIC::PROCESSED::FP1_CORNERS_Y_mean < METRIC::PROCESSED::FP3_CORNERS_Y_mean))
		! /AS_INTEGER=TRUE
		;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=rear_FP
			/PARAMETER_VALUE=FP1
			;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=front_FPa
			/PARAMETER_VALUE=FP2
			;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=front_FPb
			/PARAMETER_VALUE=FP3
			;

		Conditional_Statement_End
		/ITERATION_PARAMETER_NAME=rear_FP
		;
	
		Conditional_Statement
		/ITERATION_PARAMETER_NAME=rear_FP
		/EXPRESSION=((METRIC::PROCESSED::FP2_CORNERS_Y_mean < METRIC::PROCESSED::FP1_CORNERS_Y_mean) &::AMP& (METRIC::PROCESSED::FP2_CORNERS_Y_mean < METRIC::PROCESSED::FP3_CORNERS_Y_mean))
		! /AS_INTEGER=TRUE
		;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=rear_FP
			/PARAMETER_VALUE=FP2
			;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=front_FPa
			/PARAMETER_VALUE=FP1
			;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=front_FPb
			/PARAMETER_VALUE=FP3
			;

		Conditional_Statement_End
		/ITERATION_PARAMETER_NAME=rear_FP
		;
	
		Conditional_Statement
		/ITERATION_PARAMETER_NAME=rear_FP
		/EXPRESSION=((METRIC::PROCESSED::FP3_CORNERS_Y_mean < METRIC::PROCESSED::FP1_CORNERS_Y_mean) &::AMP& (METRIC::PROCESSED::FP3_CORNERS_Y_mean < METRIC::PROCESSED::FP2_CORNERS_Y_mean))
		! /AS_INTEGER=TRUE
		;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=rear_FP
			/PARAMETER_VALUE=FP3
			;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=front_FPa
			/PARAMETER_VALUE=FP1
			;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=front_FPb
			/PARAMETER_VALUE=FP2
			;

		Conditional_Statement_End
		/ITERATION_PARAMETER_NAME=rear_FP
		;
	
		! Find front FPs
		Conditional_Statement
		/ITERATION_PARAMETER_NAME=front_FP
		/EXPRESSION=(METRIC::PROCESSED::&::front_FPa&_CORNERS_X_mean > METRIC::PROCESSED::&::front_FPb&_CORNERS_X_mean)
		! /AS_INTEGER=TRUE
		;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=front_right_FP
			/PARAMETER_VALUE=::front_FPa
			;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=front_left_FP
			/PARAMETER_VALUE=::front_FPb
			;

		Conditional_Statement_End
		/ITERATION_PARAMETER_NAME=front_FP
		;
		
		Conditional_Statement
		/ITERATION_PARAMETER_NAME=front_FP
		/EXPRESSION=(METRIC::PROCESSED::&::front_FPb&_CORNERS_X_mean > METRIC::PROCESSED::&::front_FPa&_CORNERS_X_mean)
		! /AS_INTEGER=TRUE
		;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=front_right_FP
			/PARAMETER_VALUE=::front_FPb
			;

			Set_Pipeline_Parameter
			/PARAMETER_NAME=front_left_FP
			/PARAMETER_VALUE=::front_FPa
			;

		Conditional_Statement_End
		/ITERATION_PARAMETER_NAME=front_FP
		;
		
		! Create FS corners
		! rear corner - right
		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=&::rear_FP&_CORNERS_Y_min
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER1_Y
		;

		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=&::rear_FP&_CORNERS_X_max
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER1_X
		;

		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=&::rear_FP&_CORNERS_Z_min
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER1_Z
		;

		! rear corner - left
		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=&::rear_FP&_CORNERS_Y_min
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER2_Y
		;

		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=&::rear_FP&_CORNERS_X_min
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER2_X
		;

		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=&::rear_FP&_CORNERS_Z_min
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER2_Z
		;

		! front corner - left
		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=&::front_left_FP&_CORNERS_Y_max
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER3_Y
		;
		
		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=&::front_left_FP&_CORNERS_X_min
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER3_X
		;
		
		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=&::front_left_FP&_CORNERS_Z_min
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER3_Z
		;
				
		! front corner - right
		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=&::front_right_FP&_CORNERS_Y_max
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER4_Y
		;
		
		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=&::front_right_FP&_CORNERS_X_max
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER4_X
		;
		
		Set_Pipeline_Parameter_To_Data_Value
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=&::front_right_FP&_CORNERS_Z_min
		/SIGNAL_COMPONENTS=ALL
		/PARAMETER_NAME=FS_CORNER4_Z
		;

		Metric_Explicit
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=FS_corner1_VLab
		/METRIC_VALUE=vector(&::FS_CORNER1_X&,&::FS_CORNER1_Y&,&::FS_CORNER1_Z&)
		;

		Metric_Explicit
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=FS_corner2_VLab
		/METRIC_VALUE=vector(&::FS_CORNER2_X&,&::FS_CORNER2_Y&,&::FS_CORNER2_Z&)
		;

		Metric_Explicit
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=FS_corner3_VLab
		/METRIC_VALUE=vector(&::FS_CORNER3_X&,&::FS_CORNER3_Y&,&::FS_CORNER3_Z&)
		;

		Metric_Explicit
		! /RESULT_METRIC_FOLDER=PROCESSED
		/RESULT_METRIC_NAME=FS_corner4_VLab
		/METRIC_VALUE=vector(&::FS_CORNER4_X&,&::FS_CORNER4_Y&,&::FS_CORNER4_Z&)
		;

		Transform_Data_Coordinate_System
		/SIGNAL_TYPES=METRIC
		/SIGNAL_FOLDER=PROCESSED
		/SIGNAL_NAMES=FS_corner1_VLab+FS_corner2_VLab+FS_corner3_VLab+FS_corner4_VLab
		/FROM_SEGMENT_CS=Virtual Lab
		/TO_SEGMENT_CS=LAB
		/RESULT_TYPES=METRIC
		/RESULT_FOLDERS=PROCESSED
		/RESULT_NAME=FS_corner1+FS_corner2+FS_corner3+FS_corner4
		/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
		! /ORIENTATION_ONLY=FALSE
		! /USE_DATA_RATE=FALSE
		;

		! It is assumed that force structure consists of FP1, FP2 and FP3
		Modify_Force_Structure_Parameters
		/USED=1
		/TYPE=0
		/NUM_FP_IN=3
		/FP_INDEX=1+2+3
		/NUM_SURFACES_OUT=1
		/SPEED_VALUES=0
		! /SPEED_CHANNELS=
		! /SPEED_SCALES=
		/CORNER1=METRIC::PROCESSED::FS_corner1::X[1]+METRIC::PROCESSED::FS_corner1::Y[1]+METRIC::PROCESSED::FS_corner1::Z[1]
		/CORNER2=METRIC::PROCESSED::FS_corner2::X[1]+METRIC::PROCESSED::FS_corner2::Y[1]+METRIC::PROCESSED::FS_corner2::Z[1]
		/CORNER3=METRIC::PROCESSED::FS_corner3::X[1]+METRIC::PROCESSED::FS_corner3::Y[1]+METRIC::PROCESSED::FS_corner3::Z[1]
		/CORNER4=METRIC::PROCESSED::FS_corner4::X[1]+METRIC::PROCESSED::FS_corner4::Y[1]+METRIC::PROCESSED::FS_corner4::Z[1]
		/USE_FORCES_FOR_KINETICS=FALSE
		/COMBINE_INPUT_FORCES=TRUE
		! /UPDATE_C3D_FILE=FALSE
		;

	Conditional_Statement_End
	/ITERATION_PARAMETER_NAME=3FPs
	;

	!Force/COP: Use Lead Heel as reference point for foot position and COP signals
	Evaluate_Expression
	 
		/EXPRESSION=(LINK_MODEL_BASED::ORIGINAL::Right COP - METRIC::PROCESSED::Lead Heel_position) * 39.3701
	 
	/RESULT_NAME=Right COP wrt Lead Heel_v3d
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COP
	;

	Evaluate_Expression
	/EXPRESSION=(LINK_MODEL_BASED::ORIGINAL::Right COP - METRIC::PROCESSED::Lead Heel_position)
	/RESULT_NAME=Right COP wrt Lead Heel
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COP
	;

	Evaluate_Expression
	 
		/EXPRESSION=(LINK_MODEL_BASED::ORIGINAL::Left COP - METRIC::PROCESSED::Lead Heel_position) * 39.3701
	 
	/RESULT_NAME=Left COP wrt Lead Heel_v3d
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COP
	;

	Evaluate_Expression
	/EXPRESSION=(LINK_MODEL_BASED::ORIGINAL::Left COP - METRIC::PROCESSED::Lead Heel_position)
	/RESULT_NAME=Left COP wrt Lead Heel
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COP
	;

	Evaluate_Expression
	 
		/EXPRESSION=(COFP::ORIGINAL::FS1_1 - METRIC::PROCESSED::Lead Heel_position) * 39.3701
	 
	/RESULT_NAME=Combined COP wrt Lead Heel_v3d_temp
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COP
	;

	Evaluate_Expression
	/EXPRESSION=(COFP::ORIGINAL::FS1_1 - METRIC::PROCESSED::Lead Heel_position)
	/RESULT_NAME=Combined COP wrt Lead Heel_temp
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COP
	;

	!convert "SUB" to point rate
	Transform_Data_Coordinate_System
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=COP
	/SIGNAL_NAMES=Combined COP wrt Lead Heel_v3d_temp+Combined COP wrt Lead Heel_temp
	! /FROM_SEGMENT_CS=LAB
	/TO_SEGMENT_CS=LAB
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COP
	/RESULT_NAME=Combined COP wrt Lead Heel_v3d+Combined COP wrt Lead Heel
	/APPLY_AS_SUFFIX=FALSE
	! /ORIENTATION_ONLY=FALSE
	! /USE_DATA_RATE=FALSE
	;

	Remove_Signals
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=COP
	/SIGNAL_NAMES=Combined COP wrt Lead Heel_v3d_temp+Combined COP wrt Lead Heel_temp
	! /INCLUDE_MODELS=FALSE
	;

	Evaluate_Expression
	 
		/EXPRESSION=(METRIC::COM::Left_Foot - METRIC::PROCESSED::Lead Heel_position) * 39.3701
	 
	/RESULT_NAME=Left_Foot_wrt_Lead_Heel_v3d
	! /RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COP
	;

	Evaluate_Expression
	/EXPRESSION=(METRIC::COM::Left_Foot - METRIC::PROCESSED::Lead Heel_position)
	/RESULT_NAME=Left_Foot_wrt_Lead_Heel
	! /RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COP
	;

	Evaluate_Expression
	 
		/EXPRESSION=(METRIC::COM::Right_Foot - METRIC::PROCESSED::Lead Heel_position) * 39.3701
	 
	/RESULT_NAME=Right_Foot_wrt_Lead_Heel_v3d
	! /RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COP
	;

	Evaluate_Expression
	/EXPRESSION=(METRIC::COM::Right_Foot - METRIC::PROCESSED::Lead Heel_position)
	/RESULT_NAME=Right_Foot_wrt_Lead_Heel
	! /RESULT_TYPE=DERIVED
	/RESULT_FOLDER=COP
	;

	! invert X and Y component to flip COP path graphs for RH player
	Evaluate_Expression
	/EXPRESSION=CURRENT_SIGNAL * 1 
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=COP
	! /SIGNAL_NAMES=
	! /RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=COP
	/RESULT_NAME=_plot
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
	;

	! --------Combined COM and COP M/L Locations 
	! Peak COP velocity
	First_Derivative
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=COP
	/SIGNAL_NAMES=Combined COP wrt Lead Heel_v3d+Combined COP wrt Lead Heel
	! /RESULT_TYPES=
	/RESULT_FOLDER=COP
	! /RESULT_NAMES=
	/RESULT_SUFFIX=_vel
	;

	 

	!----------	Combined Vertical, Lateral, A/P Force
	!Add Right + Left GRF to compute combined force in xyz components
	Evaluate_Expression
	/EXPRESSION=DERIVED::PROCESSED::Lead_GRF + DERIVED::PROCESSED::Trail_GRF
	/RESULT_NAME=Force_FS1_1
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;

	! calculate relative forces per body weight
	Evaluate_Expression
	 
		/EXPRESSION=DERIVED::FORCE::Force_FS1_1 / (METRIC::PROCESSED::MASS * 9.81)
	 
	/RESULT_NAME=Force_FS1_1_BW
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;

	Evaluate_Expression
	 
		/EXPRESSION=LINK_MODEL_BASED::ORIGINAL::Left_GRF / (METRIC::PROCESSED::MASS * 9.81)
	 
	/RESULT_NAME=Left GRF_BW
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;

	Evaluate_Expression
	 
		/EXPRESSION=LINK_MODEL_BASED::ORIGINAL::Right_GRF / (METRIC::PROCESSED::MASS * 9.81)
	 
	/RESULT_NAME=Right GRF_BW
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;

	Evaluate_Expression
	 
		/EXPRESSION=DERIVED::PROCESSED::Lead_GRF / (METRIC::PROCESSED::MASS * 9.81)
	 
	/RESULT_NAME=Lead GRF_BW
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;

	Evaluate_Expression
	 
		/EXPRESSION=DERIVED::PROCESSED::Trail_GRF / (METRIC::PROCESSED::MASS * 9.81)
	 
	/RESULT_NAME=Trail GRF_BW
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;
	
	
	 

	!----------	Combined Vertical, Lateral, A/P Moment about (COP/COM)
	Subtract_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+COFP
	/SIGNAL_FOLDER=RFT+ORIGINAL
	/SIGNAL_NAMES=COP_1+FS1_1
	/COMPONENT_SEQUENCE=X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Right X COP Dist
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::Right X COP Dist * 39.3701
	! /SIGNAL_TYPES=
	! /SIGNAL_FOLDER=ORIGINAL
	! /SIGNAL_NAMES=
	/RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Right X COP Dist_in
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;


	Subtract_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+COFP
	/SIGNAL_FOLDER=RFT+ORIGINAL
	/SIGNAL_NAMES=COP_1+FS1_1
	/COMPONENT_SEQUENCE=Y
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Right Y COP Dist
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::Right Y COP Dist * 39.3701
	! /SIGNAL_TYPES=
	! /SIGNAL_FOLDER=ORIGINAL
	! /SIGNAL_NAMES=
	/RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Right Y COP Dist_in
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	Subtract_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+COFP
	/SIGNAL_FOLDER=LFT+ORIGINAL
	/SIGNAL_NAMES=COP_1+FS1_1
	/COMPONENT_SEQUENCE=X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Left X COP Dist
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::Left X COP Dist * 39.3701
	! /SIGNAL_TYPES=
	! /SIGNAL_FOLDER=ORIGINAL
	! /SIGNAL_NAMES=
	/RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Left X COP Dist_in
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	Subtract_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+COFP
	/SIGNAL_FOLDER=LFT+ORIGINAL
	/SIGNAL_NAMES=COP_1+FS1_1
	/COMPONENT_SEQUENCE=Y
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Left Y COP Dist
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::Left Y COP Dist * 39.3701
	! /SIGNAL_TYPES=
	! /SIGNAL_FOLDER=ORIGINAL
	! /SIGNAL_NAMES=
	/RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Left Y COP Dist_in
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	Multiply_Signals
	/SIGNAL_TYPES=DERIVED+KINETIC_KINEMATIC
	/SIGNAL_FOLDER=FORCE+RFT 
	/SIGNAL_NAMES=Right Y COP Dist+FORCE_1
	/COMPONENT_SEQUENCE=X, X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Right ML Force Torque
	;

	Multiply_Signals
	/SIGNAL_TYPES=DERIVED+KINETIC_KINEMATIC
	/SIGNAL_FOLDER=FORCE+RFT 
	/SIGNAL_NAMES=Right X COP Dist+FORCE_1
	/COMPONENT_SEQUENCE=X, Y
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Right AP Force Torque
	;

	Multiply_Signals
	/SIGNAL_TYPES=DERIVED+KINETIC_KINEMATIC
	/SIGNAL_FOLDER=FORCE+LFT 
	/SIGNAL_NAMES=Left X COP Dist+FORCE_1
	/COMPONENT_SEQUENCE=X, Y
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Left AP Force Torque
	;

	Multiply_Signals
	/SIGNAL_TYPES=DERIVED+KINETIC_KINEMATIC
	/SIGNAL_FOLDER=FORCE+LFT 
	/SIGNAL_NAMES=Left Y COP Dist+FORCE_1
	/COMPONENT_SEQUENCE=X, X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Left ML Force Torque
	;

	!Combined moment arm
	Add_Signals
	/SIGNAL_TYPES=DERIVED+DERIVED
	/SIGNAL_FOLDER=FORCE+FORCE
	/SIGNAL_NAMES=Right X COP Dist+Left X COP Dist
	/COMPONENT_SEQUENCE=X, X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Combined X COP Dist
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::Combined X COP Dist * 39.3701
	! /SIGNAL_TYPES=
	! /SIGNAL_FOLDER=ORIGINAL
	! /SIGNAL_NAMES=
	/RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Combined X COP Dist_in
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	Add_Signals
	/SIGNAL_TYPES=DERIVED+DERIVED
	/SIGNAL_FOLDER=FORCE+FORCE
	/SIGNAL_NAMES=Right Y COP Dist+Left Y COP Dist
	/COMPONENT_SEQUENCE=X, X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Combined Y COP Dist
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::Combined Y COP Dist * 39.3701
	! /SIGNAL_TYPES=
	! /SIGNAL_FOLDER=ORIGINAL
	! /SIGNAL_NAMES=
	/RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Combined Y COP Dist_in
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	!Total moment as sum
	Add_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+DERIVED+DERIVED
	/SIGNAL_FOLDER=RFT+FORCE+FORCE
	/SIGNAL_NAMES=FREEMOMENT_1+Right AP Force Torque+Right ML Force Torque
	/COMPONENT_SEQUENCE=Z, X, X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Right Foot Total Moment COP
	;

	Add_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+DERIVED+DERIVED
	/SIGNAL_FOLDER=LFT+FORCE+FORCE
	/SIGNAL_NAMES=FREEMOMENT_1+Left AP Force Torque+Left ML Force Torque
	/COMPONENT_SEQUENCE=Z, X, X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Left Foot Total Moment COP
	;

	 

	Subtract_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+LINK_MODEL_BASED
	/SIGNAL_FOLDER=RFT+ORIGINAL
	/SIGNAL_NAMES=COP_1+COM_displacement
	/COMPONENT_SEQUENCE=X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=COM X Dist Right
	;

	Subtract_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+LINK_MODEL_BASED
	/SIGNAL_FOLDER=LFT+ORIGINAL
	/SIGNAL_NAMES=COP_1+COM_displacement
	/COMPONENT_SEQUENCE=X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=COM X Dist Left
	;

	Subtract_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+LINK_MODEL_BASED
	/SIGNAL_FOLDER=RFT+ORIGINAL
	/SIGNAL_NAMES=COP_1+COM_displacement
	/COMPONENT_SEQUENCE=Z
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=COM Height For Moments
	;

	Evaluate_Expression
	/EXPRESSION=KINETIC_KINEMATIC::RFT::FORCE_1::Z * DERIVED::FORCE::COM X Dist Right::X * 100
	/RESULT_NAME=Right V Force Cont
	! /RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;

	Evaluate_Expression
	/EXPRESSION=KINETIC_KINEMATIC::RFT::FORCE_1::X * LINK_MODEL_BASED::ORIGINAL::COM_displacement::Z * 100
	/RESULT_NAME=Right H Force Cont
	! /RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;

	!as sum
	Add_Signals
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=FORCE
	/SIGNAL_NAMES=Right H Force Cont+Right V Force Cont
	/COMPONENT_SEQUENCE=X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Right Frontal Cont Total
	;

	 

	Evaluate_Expression
	/EXPRESSION=KINETIC_KINEMATIC::LFT::FORCE_1::Z * DERIVED::FORCE::COM X Dist Left::X * 100
	/RESULT_NAME=Left V Force Cont
	! /RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;

	Evaluate_Expression
	/EXPRESSION=KINETIC_KINEMATIC::LFT::FORCE_1::X * LINK_MODEL_BASED::ORIGINAL::COM_displacement::Z * 100
	/RESULT_NAME=Left H Force Cont
	! /RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;


	!as sum
	Add_Signals
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=FORCE
	/SIGNAL_NAMES=Left H Force Cont+Left V Force Cont
	/COMPONENT_SEQUENCE=X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Left Frontal Cont Total
	;

	Add_Signals
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=FORCE
	/SIGNAL_NAMES=Right Frontal Cont Total+Left Frontal Cont Total
	/COMPONENT_SEQUENCE=X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Total Frontal Moment
	;

	Add_Signals
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=FORCE
	/SIGNAL_NAMES=Left Foot Total Moment COP+Right Foot Total Moment COP
	/COMPONENT_SEQUENCE=X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Total Horizontal Moment COP
	;
		
	 

	Subtract_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+LINK_MODEL_BASED
	/SIGNAL_FOLDER=RFT+ORIGINAL
	/SIGNAL_NAMES=COP_1+COM_displacement
	/COMPONENT_SEQUENCE=X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Right X COM Dist
	;

	Subtract_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+LINK_MODEL_BASED
	/SIGNAL_FOLDER=RFT+ORIGINAL
	/SIGNAL_NAMES=COP_1+COM_displacement
	/COMPONENT_SEQUENCE=Y
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Right Y COM Dist
	;

	Subtract_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+LINK_MODEL_BASED
	/SIGNAL_FOLDER=LFT+ORIGINAL
	/SIGNAL_NAMES=COP_1+COM_displacement
	/COMPONENT_SEQUENCE=X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Left X COM Dist
	;

	Subtract_Signals
	/SIGNAL_TYPES=KINETIC_KINEMATIC+LINK_MODEL_BASED
	/SIGNAL_FOLDER=LFT+ORIGINAL
	/SIGNAL_NAMES=COP_1+COM_displacement
	/COMPONENT_SEQUENCE=Y
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Left Y COM Dist
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::Right Y COM Dist::X * KINETIC_KINEMATIC::RFT::FORCE_1::X * 100
	! /SIGNAL_TYPES=
	! /SIGNAL_FOLDER=ORIGINAL
	! /SIGNAL_NAMES=
	! /RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Right ML Force Torque COM
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::Left Y COM Dist::X * KINETIC_KINEMATIC::LFT::FORCE_1::X * 100
	! /SIGNAL_TYPES=
	! /SIGNAL_FOLDER=ORIGINAL
	! /SIGNAL_NAMES=
	! /RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Left ML Force Torque COM
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::Right X COM Dist::X * KINETIC_KINEMATIC::RFT::FORCE_1::Y * 100
	! /SIGNAL_TYPES=
	! /SIGNAL_FOLDER=ORIGINAL
	! /SIGNAL_NAMES=
	! /RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Right AP Force Torque COM
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::Left X COM Dist::X * KINETIC_KINEMATIC::LFT::FORCE_1::Y * 100
	! /SIGNAL_TYPES=
	! /SIGNAL_FOLDER=ORIGINAL
	! /SIGNAL_NAMES=
	! /RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Left AP Force Torque COM
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	!copy data from KINETIC_KINEMATIC to DERIVED to make them available for graphs (units are Ncm)
	Evaluate_Expression
	/EXPRESSION=KINETIC_KINEMATIC::RFT::FREEMOMENT_1 * 100
	/RESULT_NAME=Right_Free_Moment
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;

	Evaluate_Expression
	/EXPRESSION=KINETIC_KINEMATIC::LFT::FREEMOMENT_1 * 100
	/RESULT_NAME=Left_Free_Moment
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;

	!as sum
	Add_Signals
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=FORCE
	/SIGNAL_NAMES=Right_Free_Moment+Right AP Force Torque COM+Right ML Force Torque COM
	/COMPONENT_SEQUENCE=Z, X, X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Right Foot Total Moment COM
	;

	Add_Signals
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=FORCE
	/SIGNAL_NAMES=Left_Free_Moment+Left AP Force Torque COM+Left ML Force Torque COM
	/COMPONENT_SEQUENCE=Z, X, X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Left Foot Total Moment COM
	;

	Add_Signals
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=FORCE
	/SIGNAL_NAMES=Left Foot Total Moment COM+Right Foot Total Moment COM
	/COMPONENT_SEQUENCE=X
	/RESULT_FOLDER=FORCE
	/RESULT_NAME=Total Horizontal Moment COM
	;

	!Total moment as sum
	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::Total Horizontal Moment COM + DERIVED::FORCE::Total Frontal Moment
	/RESULT_NAME=Total Moment COM
	/RESULT_TYPE=DERIVED
	/RESULT_FOLDER=FORCE
	;

	 

	!normalized to body weight
	Divide_Signal_By_Constant
	/SIGNAL_TYPES=DERIVED
	/SIGNAL_FOLDER=FORCE
	/SIGNAL_NAMES=Right_Free_Moment+Left_Free_Moment+Left AP Force Torque COM+Left ML Force Torque COM+Right AP Force Torque COM+Right ML Force Torque COM+Right Foot Total Moment COM+Left Foot Total Moment COM+Total Horizontal Moment COM+Total Moment COM+Right AP Force Torque+Right ML Force Torque+Right Foot Total Moment COP+Left AP Force Torque+Left ML Force Torque+Left Foot Total Moment COP+Right H Force Cont+Right V Force Cont+Right Frontal Cont Total+Left H Force Cont+Left V Force Cont+Left Frontal Cont Total+Total Frontal Moment+Total Horizontal Moment COP
	 
	 
	 
	! /RESULT_TYPES=
	/RESULT_FOLDER=FORCE
	/RESULT_NAMES=_BW
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
	! /SIGNAL_COMPONENTS=
	 
		/CONSTANT=METRIC::PROCESSED::MASS * 9.81
	 
	;

	! For web report export left and right moments as lead and trail
	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::&::lead_side& Foot Total Moment COM_BW
	! /RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Lead Foot Total Moment COM_BW
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::&::lead_side& Frontal Cont Total_BW
	! /RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Lead Frontal Cont Total_BW
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::&::trail_side& Foot Total Moment COM_BW
	! /RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Trail Foot Total Moment COM_BW
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	Evaluate_Expression
	/EXPRESSION=DERIVED::FORCE::&::Trail_side& Frontal Cont Total_BW
	! /RESULT_TYPES=DERIVED
	/RESULT_FOLDERS=FORCE
	/RESULT_NAME=Trail Frontal Cont Total_BW
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	;

	! Find out if session type is Pitching or Hitting and load kinetics report accordingly
	 
		Append_Report_Template
		/REPORT_TEMPLATE=H:\Pitching\Templates\Assets\Reports\BaseballReportPitchingKinetics.rgt
		;
	 
	
Conditional_Statement_End
/ITERATION_PARAMETER_NAME=force_exists
; 

!------------------
! Means
!------------------
!Loop through file tags

For_Each
/ITERATION_PARAMETER_NAME=FILE_TAG
/ITEMS=FastBall+Pitch 
;

	Select_Active_File
	 /FILE_NAME=::FILE_TAG
	 ! /QUERY=
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::MaxTrunkLinearVelTime+GLOBAL::MaxTrunkLinearVelTime_ms+GLOBAL::MaxTrunkLinearVel_MPH+GLOBAL::Trunk_COG_Vel@Footstrike_MPH+GLOBAL::Trunk_COG_Vel@Max_Shoulder_Rot_MPH+GLOBAL::Trunk_COG_Vel@Release_MPH
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=MaxTrunkLinearVelTime+MaxTrunkLinearVelTime_ms+MaxTrunkLinearVel_MPH+Trunk_COG_Vel@Footstrike_MPH+Trunk_COG_Vel@Max_Shoulder_Rot_MPH+Trunk_COG_Vel@Release_MPH
	 /SIGNAL_FOLDER=TIMING+TIMING+PROCESSED+PROCESSED+PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=X+X+Y+Y+Y+Y
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::MaxPelvisLinearVelTime+GLOBAL::MaxPelvisLinearVelTime_ms+GLOBAL::MaxPelvisLinearVel_MPH+GLOBAL::Pelvis_COG_Vel@Footstrike_MPH+GLOBAL::Pelvis_COG_Vel@Max_Shoulder_Rot_MPH+GLOBAL::Pelvis_COG_Vel@PelvisRot_Stop_MPH+GLOBAL::Pelvis_COG_Vel@Release_MPH
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=MaxPelvisLinearVelTime+MaxPelvisLinearVelTime_ms+MaxPelvisLinearVel_MPH+Pelvis_COG_Vel@Footstrike_MPH+Pelvis_COG_Vel@Max_Shoulder_Rot_MPH+Pelvis_COG_Vel@PelvisRot_Stop_MPH+Pelvis_COG_Vel@Release_MPH
	 /SIGNAL_FOLDER=TIMING+TIMING+PROCESSED+PROCESSED+PROCESSED+PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=X+X+Y+Y+Y+Y+Y
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::PelvisRise_LinearVel@Footstrike_MPH+GLOBAL::PelvisRise_LinearVel@Max_Shoulder_Rot_MPH+GLOBAL::PelvisRise_LinearVel@PelvisRot_Stop_MPH+GLOBAL::PelvisRise_LinearVel@Release_MPH+GLOBAL::PelvisRise_LinearVel@Release100msAfter_MPH
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pelvis_COG_Vel@Footstrike_MPH+Pelvis_COG_Vel@Max_Shoulder_Rot_MPH+Pelvis_COG_Vel@PelvisRot_Stop_MPH+Pelvis_COG_Vel@Release_MPH+Pelvis_COG_Vel@Release100msAfter_MPH
	 /SIGNAL_FOLDER=PROCESSED+PROCESSED+PROCESSED+PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=Z+Z+Z+Z+Z
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Pelvis_COG@Footstrike_in+GLOBAL::Pelvis_COG@Max_Shoulder_Rot_in+GLOBAL::Pelvis_COG@PelvisRot_Stop_in+GLOBAL::Pelvis_COG@Release_in+GLOBAL::Pelvis_COG@Release100msAfter_in
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pelvis_COG@Footstrike_in+Pelvis_COG@Max_Shoulder_Rot_in+Pelvis_COG@PelvisRot_Stop_in+Pelvis_COG@Release_in+Pelvis_COG@Release100msAfter_in
	 /SIGNAL_FOLDER=PROCESSED+PROCESSED+PROCESSED+PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=Z+Z+Z+Z+Z
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Trunk_wrt_Pelvis_FE@Footstrike+GLOBAL::Trunk_wrt_Pelvis_FE@Max_Shoulder_Rot+GLOBAL::Trunk_wrt_Pelvis_FE@Release+GLOBAL::Trunk_wrt_Pelvis_FE@Max_Shoulder_Int_Rot_FollowThru
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Trunk_wrt_Pelvis_FE@Footstrike+Trunk_wrt_Pelvis_FE@Max_Shoulder_Rot+Trunk_wrt_Pelvis_FE@Release+Trunk_wrt_Pelvis_FE@Max_Shoulder_Int_Rot_FollowThru
	 /SIGNAL_FOLDER=PROCESSED+PROCESSED+PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=TRUE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Lead_Knee_VarVal_@Footstrike+GLOBAL::Lead_Knee_VarVal_@Max_Shoulder_Rot+GLOBAL::Lead_Knee_VarVal_@Release
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Lead_Knee_Angle@Footstrike+Lead_Knee_Angle@Max_Shoulder_Rot+Lead_Knee_Angle@Release
	 /SIGNAL_FOLDER=PROCESSED
	 /SIGNAL_COMPONENTS=Y+Y+Y
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::PeakShoulder_AngVel_HzShldAbdTime+GLOBAL::PeakShoulder_AngVel_HzShldAbdTime_ms
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC+METRIC
	 /SIGNAL_NAMES=PeakShoulder_AngVel_HzShldAbdTime+PeakShoulder_AngVel_HzShldAbdTime_ms
	 /SIGNAL_FOLDER=Timing+Timing
	 /SIGNAL_COMPONENTS=0
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Pitching_Shoulder_AngVel_HzShldAbd_Max+GLOBAL::Pitching_Shoulder_AngVel_HzShldAbd@Footstrike+GLOBAL::Pitching_Shoulder_AngVel_HzShldAbd@Max_Shoulder_Rot+GLOBAL::Pitching_Shoulder_AngVel_HzShldAbd@Release+GLOBAL::Pitching_Shoulder_AngVel_HzShldAbd@Release100msAfter
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pitching_Shoulder_AngVel_HzShldAbd_Max+Pitching_Shoulder_AngVel_HzShldAbd@Footstrike+Pitching_Shoulder_AngVel_HzShldAbd@Max_Shoulder_Rot+Pitching_Shoulder_AngVel_HzShldAbd@Release+Pitching_Shoulder_AngVel_HzShldAbd@Release100msAfter
	 /SIGNAL_FOLDER=PROCESSED+PROCESSED+PROCESSED+PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=X+X+X+X+X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Pitching_Humerus_Ang_Vel@Footstrike+GLOBAL::Pelvis_Ang_Vel@Footstrike+GLOBAL::Thorax_Ang_Vel@Footstrike+GLOBAL::Pitching_Hand_Ang_Vel@Footstrike
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pitching_Humerus_Ang_Vel@Footstrike+Pelvis_Ang_Vel@Footstrike+Thorax_Ang_Vel@Footstrike+Pitching_Hand_Ang_Vel@Footstrike
	 /SIGNAL_FOLDER=PROCESSED+PROCESSED+PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=X+X+X+X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Pitching_Humerus_Ang_Vel@Max_Shoulder_Rot+GLOBAL::Pelvis_Ang_Vel@Max_Shoulder_Rot+GLOBAL::Thorax_Ang_Vel@Max_Shoulder_Rot+GLOBAL::Pitching_Hand_Ang_Vel@Max_Shoulder_Rot
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pitching_Humerus_Ang_Vel@Max_Shoulder_Rot+Pelvis_Ang_Vel@Max_Shoulder_Rot+Thorax_Ang_Vel@Max_Shoulder_Rot+Pitching_Hand_Ang_Vel@Max_Shoulder_Rot
	 /SIGNAL_FOLDER=PROCESSED+PROCESSED+PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=X+X+X+X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Pitching_Humerus_Ang_Vel@Release+GLOBAL::Pelvis_Ang_Vel@Release+GLOBAL::Thorax_Ang_Vel@Release+GLOBAL::Pitching_Hand_Ang_Vel@Release
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pitching_Humerus_Ang_Vel@Release+Pelvis_Ang_Vel@Release+Thorax_Ang_Vel@Release+Pitching_Hand_Ang_Vel@Release
	 /SIGNAL_FOLDER=PROCESSED+PROCESSED+PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=X+X+X+X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Pitching_Humerus_Ang_Vel@Release100msAfter+GLOBAL::Pelvis_Ang_Vel@Release100msAfter+GLOBAL::Thorax_Ang_Vel@Release100msAfter+GLOBAL::Pitching_Hand_Ang_Vel@Release100msAfter
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pitching_Humerus_Ang_Vel@Release100msAfter+Pelvis_Ang_Vel@Release100msAfter+Thorax_Ang_Vel@Release100msAfter+Pitching_Hand_Ang_Vel@Release100msAfter
	 /SIGNAL_FOLDER=PROCESSED+PROCESSED+PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=X+X+X+X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::PelvisRot_StopTime+GLOBAL::PelvisRot_StopTime_ms
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC+METRIC
	 /SIGNAL_NAMES=PelvisRot_StopTime+PelvisRot_StopTime_ms
	 /SIGNAL_FOLDER=Timing+Timing
	 /SIGNAL_COMPONENTS=0
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Trunk Rot wrt Pelvis Rot@Footstrike+GLOBAL::Trunk Rot wrt Pelvis Rot@Max_Shoulder_Rot+GLOBAL::Trunk Rot wrt Pelvis Rot@Release+GLOBAL::Trunk Rot wrt Pelvis Rot@Max_Shoulder_Int_Rot_FollowThru
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Trunk Rot wrt Pelvis Rot@Footstrike+Trunk Rot wrt Pelvis Rot@Max_Shoulder_Rot+Trunk Rot wrt Pelvis Rot@Release+Trunk Rot wrt Pelvis Rot@Max_Shoulder_Int_Rot_FollowThru
	 /SIGNAL_FOLDER=PROCESSED+PROCESSED+PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=X+X+X+X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=TRUE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Trunk_Rotation_Cummulative_Range_FStoRelease+GLOBAL::Shoulder_Rotation_Cummulative_Range_FStoRelease
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Trunk_Rotation_Cummulative_Range_FStoRelease+Shoulder_Rotation_Cummulative_Range_FStoRelease
	 /SIGNAL_FOLDER=PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=X+X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=TRUE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;
	
	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Hip Shoulders Sep@Shoulder_ExtRot90+GLOBAL::Trunk_Angle@Shoulder_ExtRot90
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Hip Shoulders Sep@Shoulder_ExtRot90+Trunk_Angle@Shoulder_ExtRot90
	 /SIGNAL_FOLDER=PROCESSED+PROCESSED
	 /SIGNAL_COMPONENTS=X+X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=TRUE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Max_Pelvis_Ang_Vel
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pelvis_Ang_Vel_max
	 /SIGNAL_FOLDER=KINEMATIC_SEQUENCE
	 /SIGNAL_COMPONENTS=0
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Max_Thorax_Ang_Vel
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Thorax_Ang_Vel_max
	 /SIGNAL_FOLDER=KINEMATIC_SEQUENCE
	 /SIGNAL_COMPONENTS=0
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Max_Pitching_Humerus_Ang_Vel
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pitching_Humerus_Ang_Vel_max
	 /SIGNAL_FOLDER=KINEMATIC_SEQUENCE
	 /SIGNAL_COMPONENTS=0
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Max_Pitching_Hand_Ang_Vel
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pitching_Hand_Ang_Vel_max
	 /SIGNAL_FOLDER=KINEMATIC_SEQUENCE
	 /SIGNAL_COMPONENTS=0
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Max_Pitching_Elbow_Ang_Vel
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pitching_Elbow_Ang_Vel_max
	 /SIGNAL_FOLDER=KINEMATIC_SEQUENCE
	 /SIGNAL_COMPONENTS=0
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Max_Pitching_Shoulder_Ang_Vel
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pitching_Shoulder_Ang_Vel_max
	 /SIGNAL_FOLDER=KINEMATIC_SEQUENCE
	 /SIGNAL_COMPONENTS=0
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Pitching_SHOULDER_ABD_MIN
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pitching_Shoulder_Angle_MIN
	 /SIGNAL_FOLDER=PROCESSED
	 /SIGNAL_COMPONENTS=X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Pitching_SHOULDER_ROT_MAX
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Pitching_Shoulder_Angle_MAX
	 /SIGNAL_FOLDER=PROCESSED
	 /SIGNAL_COMPONENTS=Z
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=TRUE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Glove_SHOULDER_ROT_MAX
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=Glove_Shoulder_Angle_MAX
	 /SIGNAL_FOLDER=PROCESSED
	 /SIGNAL_COMPONENTS=Z
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=TRUE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Shoulder_Ang_Vel@Release
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=SHOULDER_ANG_VEL@Release_Abs
	 /SIGNAL_FOLDER=PROCESSED
	 /SIGNAL_COMPONENTS=Z
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::Pitching_Shoulder_Vel_Min
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=SHOULDER_VEL_MIN_ABS
	 /SIGNAL_FOLDER=PROCESSED
	 /SIGNAL_COMPONENTS=Z
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=TRUE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::BALL_RELEASE_SPEED_mph
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=BALL_RELEASE_SPEED_mph
	 /SIGNAL_FOLDER=BALLSPEED
	 /SIGNAL_COMPONENTS=X
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=GLOBAL::STRIDE
	 ! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=FALSE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 /SIGNAL_NAMES=STRIDE_LENGTH
	 /SIGNAL_FOLDER=STRIDE_LENGTH
	 ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 /APPEND_TO_EXISTING_VALUES=TRUE
	;

	Select_Active_File
	 /FILE_NAME=GLOBAL
	 ! /QUERY=
	;

	! Stride length in percent
	Divide_Signal_By_Constant
	/SIGNAL_TYPES=METRIC
	/SIGNAL_FOLDER=::FILE_TAG
	/SIGNAL_NAMES=STRIDE
	! /SIGNAL_COMPONENTS=
	! /RESULT_TYPES=
	/RESULT_FOLDERS=::FILE_TAG
	! /RESULT_NAME=
	/RESULT_SUFFIX=_PERCENT
	! /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=
	/CONSTANT=GLOBAL::METRIC::PROCESSED::SUBJECTHEIGHT*1/100
	;

	Metric_Mean
	 /RESULT_METRIC_NAME=_MEAN
	 /APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
	 /RESULT_METRIC_FOLDER=::FILE_TAG
	 /SIGNAL_TYPES=METRIC
	 !/SIGNAL_NAMES=::FILE_TAG&_STRIDE
	 /SIGNAL_NAMES=STRIDE
	 /SIGNAL_FOLDER=::FILE_TAG
	 ! /SIGNAL_COMPONENTS=ALL_COMPONENTS
	 /EVENT_SEQUENCE=
	 /EXCLUDE_EVENTS=
	 /GENERATE_MEAN_AND_STDDEV=FALSE
	 ! /APPEND_TO_EXISTING_VALUES=FALSE
	;

	Multiply_Signals_By_Constant
	 /SIGNAL_TYPES=METRIC
	 !/SIGNAL_NAMES=::FILE_TAG&_STRIDE_MEAN
	 /SIGNAL_NAMES=STRIDE_MEAN
	 /SIGNAL_FOLDER=::FILE_TAG
	 !/RESULT_NAMES=
	 !/RESULT_TYPES=
	 /RESULT_FOLDER=::FILE_TAG
	 /RESULT_SUFFIX=_IN
	 ! /SIGNAL_COMPONENTS=
	 /CONSTANT=39.4
	;

	Divide_Signal_By_Constant
	 /SIGNAL_TYPES=METRIC
	 !/SIGNAL_NAMES=:FILE_TAG&_STRIDE_MEAN
	 /SIGNAL_NAMES=STRIDE_MEAN
	 /SIGNAL_FOLDER=::FILE_TAG
	 !/RESULT_NAMES=
	 !/RESULT_TYPES=
	 /RESULT_FOLDER=::FILE_TAG
	 /RESULT_SUFFIX=_PERCENT
	 ! /SIGNAL_COMPONENTS=
	 /CONSTANT=METRIC::PROCESSED::SUBJECTHEIGHT*1/100
	;

	Metric_Mean
	/RESULT_METRIC_NAME=_MEAN
	/APPLY_AS_SUFFIX_TO_SIGNAL_NAME=TRUE
	/RESULT_METRIC_FOLDER=::FILE_TAG
	/SIGNAL_TYPES=METRIC
	! /SIGNAL_NAMES=
	/SIGNAL_FOLDER=::FILE_TAG
	! /SIGNAL_COMPONENTS=ALL_COMPONENTS
	/EVENT_SEQUENCE=
	/EXCLUDE_EVENTS=
	/GENERATE_MEAN_AND_STDDEV=FALSE
	! /APPEND_TO_EXISTING_VALUES=FALSE
	;

End_For_Each
/ITERATION_PARAMETER_NAME=FILE_TAG
;

Set_View_Options
! /VIEW_GRAPH_ANIMATION_FRAME_LINE=
/VIEW_FORCE_PLATFORMS=TRUE
! /VIEW_GRF_BUTTERFLY=
/VIEW_GRF=TRUE
/VIEW_GRF_COFP=TRUE
/VIEW_CUSTOM_FORCES=TRUE
! /VIEW_JOINTS=
/VIEW_LAB=FALSE
/VIEW_LAB_AXES=FALSE
/VIEW_LANDMARKS=FALSE
/VIEW_MODEL_COM=FALSE
! /VIEW_MUSCLES=
! /VIEW_MUSCLES_AS_LINES=
! /VIEW_MUSCLES_AS_CYLINDERS=
/VIEW_SCS_AXES=FALSE
! /VIEW_SCS_AXES_COM=
/VIEW_SEGMENTS=TRUE
/VIEW_KINEMATIC_ONLY_SEGMENTS=TRUE
! /VIEW_SEGMENT_COLORIZATION=
/VIEW_SEGMENT_GEOMETRY=FALSE
/VIEW_SEGMENT_LINES=FALSE
/VIEW_TARGETS=TRUE
! /VIEW_TARGETS_WITH_RESIDUAL_COLORMAP=
/VIEW_COM_TRAIL=FALSE
! /VIEW_LANDMARK_TRAIL=
! /VIEW_SEGMENT_TRAIL=
! /VIEW_TARGET_TRAIL=
/VIEW_WHITE_BACKGROUND=FALSE
;

Switch_to_Report_Mode
/SHOW_ANIMATION=FALSE
! /PAGE_NUMBER=
;

Recalc
;

 

File_Save_As
/FILE_NAME=H:\Pitching\Data\Doe, John\Baseball Right-handed\Report_JD.cmz;

